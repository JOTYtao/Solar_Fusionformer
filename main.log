[2023-10-26 20:12:40,686][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-26 20:12:40,686][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-26 20:12:40,692][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-26 20:12:40,692][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-26 20:12:40,749][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-26 20:12:41,411][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-26 20:12:41,917][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src' has no attribute 'models'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 984, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.models'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.FEDformer.Model':
ModuleNotFoundError("No module named 'src.models'")
Are you sure that 'models' is importable from module 'src'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 46, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.FEDformer.Model', see chained exception above.
full_key: pl_module.model
[2023-10-26 20:12:41,934][utiles.utils][INFO] - Closing loggers...
[2023-10-26 20:20:53,391][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-26 20:20:53,391][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-26 20:20:53,396][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-26 20:20:53,396][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-26 20:20:53,455][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-26 20:20:53,703][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-26 20:20:54,099][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src' has no attribute 'models'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 984, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.models'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.FEDformer.Model':
ModuleNotFoundError("No module named 'src.models'")
Are you sure that 'models' is importable from module 'src'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.FEDformer.Model', see chained exception above.
full_key: pl_module.model
[2023-10-26 20:20:54,101][utiles.utils][INFO] - Closing loggers...
[2023-10-26 20:24:47,693][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-26 20:24:47,693][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-26 20:24:47,698][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-26 20:24:47,698][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-26 20:24:47,764][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-26 20:24:48,007][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-26 20:24:49,292][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torchmetrics\regression\mape.py", line 77, in __init__
    super().__init__(**kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torchmetrics\metric.py", line 146, in __init__
    raise ValueError(f"Unexpected keyword arguments: {', '.join(kwargs_)}")
ValueError: Unexpected keyword arguments: `epsilon`

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 357, in instantiate_node
    cfg[key] = instantiate_node(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 357, in instantiate_node
    cfg[key] = instantiate_node(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'torchmetrics.regression.mape.MeanAbsolutePercentageError':
ValueError('Unexpected keyword arguments: `epsilon`')
full_key: pl_module.metrics.train.mape
[2023-10-26 20:24:49,313][utiles.utils][INFO] - Closing loggers...
[2023-10-26 20:28:27,104][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-26 20:28:27,105][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-26 20:28:27,110][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-26 20:28:27,110][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-26 20:28:27,170][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-26 20:28:27,404][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-26 20:28:28,356][__main__][INFO] - Instantiating callbacks...
[2023-10-26 20:28:28,356][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-26 20:28:28,359][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-26 20:28:28,360][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-26 20:28:28,361][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-26 20:28:28,361][__main__][INFO] - Instantiating loggers...
[2023-10-26 20:28:28,361][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-26 20:28:28,398][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-26 20:28:28,561][__main__][INFO] - Logging hyperparameters!
[2023-10-26 20:28:29,456][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 71, in train
    utiles.log_hyperparameters(object_dict)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 175, in log_hyperparameters
    trainer.logger.log_hyperparams(hparams)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 417, in log_hyperparams
    self.experiment.config.update(params, allow_val_change=True)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_fabric\loggers\logger.py", line 118, in experiment
    return fn(self)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 399, in experiment
    self._experiment = wandb.init(**self._wandb_init)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\wandb\sdk\wandb_init.py", line 1189, in init
    raise e
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\wandb\sdk\wandb_init.py", line 1166, in init
    wi.setup(kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\wandb\sdk\wandb_init.py", line 308, in setup
    wandb_login._login(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\wandb\sdk\wandb_login.py", line 298, in _login
    wlogin.prompt_api_key()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\wandb\sdk\wandb_login.py", line 228, in prompt_api_key
    raise UsageError("api_key not configured (no-tty). call " + directive)
wandb.errors.UsageError: api_key not configured (no-tty). call wandb.login(key=[your_api_key])
[2023-10-26 20:28:29,505][utiles.utils][INFO] - Closing loggers...
[2023-10-26 20:31:52,999][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-26 20:31:52,999][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-26 20:31:53,006][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-26 20:31:53,006][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-26 20:31:53,066][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-26 20:31:53,298][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-26 20:31:54,259][__main__][INFO] - Instantiating callbacks...
[2023-10-26 20:31:54,259][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-26 20:31:54,262][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-26 20:31:54,262][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-26 20:31:54,262][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-26 20:31:54,264][__main__][INFO] - Instantiating loggers...
[2023-10-26 20:31:54,264][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-26 20:31:54,300][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-26 20:31:54,459][__main__][INFO] - Logging hyperparameters!
[2023-10-26 20:31:55,360][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 71, in train
    utiles.log_hyperparameters(object_dict)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 175, in log_hyperparameters
    trainer.logger.log_hyperparams(hparams)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 417, in log_hyperparams
    self.experiment.config.update(params, allow_val_change=True)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_fabric\loggers\logger.py", line 118, in experiment
    return fn(self)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 399, in experiment
    self._experiment = wandb.init(**self._wandb_init)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\wandb\sdk\wandb_init.py", line 1189, in init
    raise e
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\wandb\sdk\wandb_init.py", line 1166, in init
    wi.setup(kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\wandb\sdk\wandb_init.py", line 308, in setup
    wandb_login._login(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\wandb\sdk\wandb_login.py", line 298, in _login
    wlogin.prompt_api_key()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\wandb\sdk\wandb_login.py", line 228, in prompt_api_key
    raise UsageError("api_key not configured (no-tty). call " + directive)
wandb.errors.UsageError: api_key not configured (no-tty). call wandb.login(key=[your_api_key])
[2023-10-26 20:31:55,362][utiles.utils][INFO] - Closing loggers...
[2023-10-26 20:42:34,252][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-26 20:42:34,252][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-26 20:42:34,257][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-26 20:42:34,258][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-26 20:42:34,311][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-26 20:42:34,517][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-26 20:42:35,378][__main__][INFO] - Instantiating callbacks...
[2023-10-26 20:42:35,378][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-26 20:42:35,380][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-26 20:42:35,381][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-26 20:42:35,381][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-26 20:42:35,382][__main__][INFO] - Instantiating loggers...
[2023-10-26 20:42:35,382][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-26 20:42:35,417][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-26 20:42:35,579][__main__][INFO] - Logging hyperparameters!
[2023-10-26 20:42:35,580][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 71, in train
    utiles.log_hyperparameters(object_dict)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 175, in log_hyperparameters
    trainer.logger.log_hyperparams(hparams)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 417, in log_hyperparams
    self.experiment.config.update(params, allow_val_change=True)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_fabric\loggers\logger.py", line 118, in experiment
    return fn(self)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 399, in experiment
    self._experiment = wandb.init(**self._wandb_init)
TypeError: init() got an unexpected keyword argument 'api_key'
[2023-10-26 20:42:35,582][utiles.utils][INFO] - Closing loggers...
[2023-10-26 20:42:50,036][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-26 20:42:50,036][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-26 20:42:50,041][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-26 20:42:50,042][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-26 20:42:50,093][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-26 20:42:50,301][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-26 20:42:51,178][__main__][INFO] - Instantiating callbacks...
[2023-10-26 20:42:51,178][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-26 20:42:51,180][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-26 20:42:51,181][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-26 20:42:51,181][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-26 20:42:51,182][__main__][INFO] - Instantiating loggers...
[2023-10-26 20:42:51,182][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-26 20:42:51,217][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-26 20:42:51,371][__main__][INFO] - Logging hyperparameters!
[2023-10-26 20:42:51,372][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 71, in train
    utiles.log_hyperparameters(object_dict)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 175, in log_hyperparameters
    trainer.logger.log_hyperparams(hparams)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 417, in log_hyperparams
    self.experiment.config.update(params, allow_val_change=True)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_fabric\loggers\logger.py", line 118, in experiment
    return fn(self)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 399, in experiment
    self._experiment = wandb.init(**self._wandb_init)
TypeError: init() got an unexpected keyword argument 'api_key'
[2023-10-26 20:42:51,374][utiles.utils][INFO] - Closing loggers...
[2023-10-26 20:47:44,314][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-26 20:47:44,314][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-26 20:47:44,319][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-26 20:47:44,319][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-26 20:47:44,375][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-26 20:47:44,575][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-26 20:47:45,470][__main__][INFO] - Instantiating callbacks...
[2023-10-26 20:47:45,471][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-26 20:47:45,473][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-26 20:47:45,474][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-26 20:47:45,474][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-26 20:47:45,475][__main__][INFO] - Instantiating loggers...
[2023-10-26 20:47:45,475][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-26 20:47:45,510][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-26 20:47:45,668][__main__][INFO] - Logging hyperparameters!
[2023-10-26 20:47:45,669][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 71, in train
    utiles.log_hyperparameters(object_dict)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 175, in log_hyperparameters
    trainer.logger.log_hyperparams(hparams)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 417, in log_hyperparams
    self.experiment.config.update(params, allow_val_change=True)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_fabric\loggers\logger.py", line 118, in experiment
    return fn(self)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 399, in experiment
    self._experiment = wandb.init(**self._wandb_init)
TypeError: init() got an unexpected keyword argument 'api_key'
[2023-10-26 20:47:45,671][utiles.utils][INFO] - Closing loggers...
[2023-10-26 20:48:38,025][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-26 20:48:38,025][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-26 20:48:38,030][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-26 20:48:38,031][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-26 20:48:38,084][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-26 20:48:38,286][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-26 20:48:39,134][__main__][INFO] - Instantiating callbacks...
[2023-10-26 20:48:39,134][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-26 20:48:39,136][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-26 20:48:39,137][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-26 20:48:39,137][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-26 20:48:39,138][__main__][INFO] - Instantiating loggers...
[2023-10-26 20:48:39,138][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-26 20:48:39,173][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-26 20:48:39,329][__main__][INFO] - Logging hyperparameters!
[2023-10-26 20:48:39,330][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 71, in train
    utiles.log_hyperparameters(object_dict)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 175, in log_hyperparameters
    trainer.logger.log_hyperparams(hparams)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 417, in log_hyperparams
    self.experiment.config.update(params, allow_val_change=True)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_fabric\loggers\logger.py", line 118, in experiment
    return fn(self)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 399, in experiment
    self._experiment = wandb.init(**self._wandb_init)
TypeError: init() got an unexpected keyword argument 'api_key'
[2023-10-26 20:48:39,332][utiles.utils][INFO] - Closing loggers...
[2023-10-26 20:49:12,114][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-26 20:49:12,114][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-26 20:49:12,120][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-26 20:49:12,120][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-26 20:49:12,174][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-26 20:49:12,380][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-26 20:49:13,259][__main__][INFO] - Instantiating callbacks...
[2023-10-26 20:49:13,260][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-26 20:49:13,262][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-26 20:49:13,263][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-26 20:49:13,263][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-26 20:49:13,264][__main__][INFO] - Instantiating loggers...
[2023-10-26 20:49:13,264][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-26 20:49:13,300][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-26 20:49:13,462][__main__][INFO] - Logging hyperparameters!
[2023-10-26 20:49:16,312][__main__][INFO] - Starting training!
[2023-10-26 20:49:16,425][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 545, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 581, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 951, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 92, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 179, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 36, in setup
    self.data_train = TSDataset(**self.hparams.dataset, mode="train")
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 55, in __init__
    with open(self.stats_path, 'r') as fp:
PermissionError: [Errno 13] Permission denied: 'E:/research/my_code/solar_forecasting/EMD/'
[2023-10-26 20:49:16,439][utiles.utils][INFO] - Closing loggers...
[2023-10-26 20:49:16,440][utiles.utils][INFO] - Closing wandb!
[2023-10-27 09:40:43,801][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 09:40:43,801][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 09:40:43,806][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 09:40:43,807][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 09:40:43,855][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 09:40:44,266][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 09:40:45,309][__main__][INFO] - Instantiating callbacks...
[2023-10-27 09:40:45,309][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 09:40:45,311][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 09:40:45,312][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 09:40:45,312][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 09:40:45,313][__main__][INFO] - Instantiating loggers...
[2023-10-27 09:40:45,313][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 09:40:45,459][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 09:40:45,601][__main__][INFO] - Logging hyperparameters!
[2023-10-27 09:40:48,096][__main__][INFO] - Starting training!
[2023-10-27 09:40:48,204][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 545, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 581, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 951, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 92, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 179, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 36, in setup
    self.data_train = TSDataset(**self.hparams.dataset, mode="train")
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 55, in __init__
    with open(self.stats_path, 'r') as fp:
PermissionError: [Errno 13] Permission denied: 'E:/research/my_code/solar_forecasting/EMD'
[2023-10-27 09:40:48,229][utiles.utils][INFO] - Closing loggers...
[2023-10-27 09:40:48,229][utiles.utils][INFO] - Closing wandb!
[2023-10-27 12:31:01,989][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 12:31:01,989][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 12:31:01,995][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 12:31:01,995][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 12:31:02,055][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 12:31:02,274][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 12:31:03,162][__main__][INFO] - Instantiating callbacks...
[2023-10-27 12:31:03,163][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 12:31:03,165][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 12:31:03,166][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 12:31:03,166][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 12:31:03,166][__main__][INFO] - Instantiating loggers...
[2023-10-27 12:31:03,167][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 12:31:03,203][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 12:31:03,368][__main__][INFO] - Logging hyperparameters!
[2023-10-27 12:31:06,127][__main__][INFO] - Starting training!
[2023-10-27 12:31:06,240][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 545, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 581, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 951, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 92, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 179, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 36, in setup
    self.data_train = TSDataset(**self.hparams.dataset, mode="train")
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 55, in __init__
    with open(self.stats_path, 'r') as fp:
PermissionError: [Errno 13] Permission denied: 'E:/research/my_code/solar_forecasting/EMD/data'
[2023-10-27 12:31:06,242][utiles.utils][INFO] - Closing loggers...
[2023-10-27 12:31:06,242][utiles.utils][INFO] - Closing wandb!
[2023-10-27 12:33:13,274][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 12:33:13,274][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 12:33:13,280][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 12:33:13,280][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 12:33:13,332][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 12:33:13,531][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 12:33:14,394][__main__][INFO] - Instantiating callbacks...
[2023-10-27 12:33:14,394][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 12:33:14,396][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 12:33:14,397][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 12:33:14,397][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 12:33:14,398][__main__][INFO] - Instantiating loggers...
[2023-10-27 12:33:14,398][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 12:33:14,433][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 12:33:14,584][__main__][INFO] - Logging hyperparameters!
[2023-10-27 12:33:17,413][__main__][INFO] - Starting training!
[2023-10-27 12:33:18,068][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 545, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 581, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 951, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 92, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 179, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 36, in setup
    self.data_train = TSDataset(**self.hparams.dataset, mode="train")
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 65, in __init__
    possible_starts = calculate_possible_starts(first_element, frames_total=self.seq_len + self.pred_len)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\utiles.py", line 24, in calculate_possible_starts
    difference_range = np.diff(date_intersection)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\numpy\lib\function_base.py", line 1418, in diff
    raise ValueError("diff requires input that is at least one dimensional")
ValueError: diff requires input that is at least one dimensional
[2023-10-27 12:33:18,107][utiles.utils][INFO] - Closing loggers...
[2023-10-27 12:33:18,107][utiles.utils][INFO] - Closing wandb!
[2023-10-27 12:37:36,083][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 12:37:36,083][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 12:37:36,088][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 12:37:36,089][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 12:37:36,142][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 12:37:36,345][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 12:37:37,201][__main__][INFO] - Instantiating callbacks...
[2023-10-27 12:37:37,202][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 12:37:37,204][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 12:37:37,205][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 12:37:37,205][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 12:37:37,206][__main__][INFO] - Instantiating loggers...
[2023-10-27 12:37:37,206][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 12:37:37,241][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 12:37:37,391][__main__][INFO] - Logging hyperparameters!
[2023-10-27 12:37:40,099][__main__][INFO] - Starting training!
[2023-10-27 12:38:07,988][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 545, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 581, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 990, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1034, in _run_stage
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1063, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loops\utilities.py", line 181, in _decorator
    return loop_run(self, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loops\evaluation_loop.py", line 109, in run
    self.setup_data()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loops\evaluation_loop.py", line 191, in setup_data
    length = len(dl) if has_len_all_ranks(dl, trainer.strategy, allow_zero_length) else float("inf")
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\utilities\data.py", line 97, in has_len_all_ranks
    local_length = sized_len(dataloader)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\lightning_fabric\utilities\data.py", line 51, in sized_len
    length = len(dataloader)  # type: ignore [arg-type]
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torch\utils\data\dataloader.py", line 480, in __len__
    return len(self._index_sampler)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torch\utils\data\sampler.py", line 272, in __len__
    return (len(self.sampler) + self.batch_size - 1) // self.batch_size  # type: ignore[arg-type]
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torch\utils\data\sampler.py", line 79, in __len__
    return len(self.data_source)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 155, in __len__
    return len(self.df)
AttributeError: 'TSDataset' object has no attribute 'df'
[2023-10-27 12:38:08,040][utiles.utils][INFO] - Closing loggers...
[2023-10-27 12:38:08,040][utiles.utils][INFO] - Closing wandb!
[2023-10-27 12:39:06,850][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 12:39:06,850][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 12:39:06,856][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 12:39:06,856][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 12:39:06,908][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 12:39:07,121][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 12:39:07,932][__main__][INFO] - Instantiating callbacks...
[2023-10-27 12:39:07,932][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 12:39:07,934][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 12:39:07,935][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 12:39:07,935][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 12:39:07,936][__main__][INFO] - Instantiating loggers...
[2023-10-27 12:39:07,936][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 12:39:07,972][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 12:39:08,122][__main__][INFO] - Logging hyperparameters!
[2023-10-27 12:39:10,855][__main__][INFO] - Starting training!
[2023-10-27 12:39:38,181][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 545, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 581, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 990, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1034, in _run_stage
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1063, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loops\utilities.py", line 181, in _decorator
    return loop_run(self, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loops\evaluation_loop.py", line 112, in run
    self.reset()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loops\evaluation_loop.py", line 230, in reset
    iter(data_fetcher)  # creates the iterator inside the fetcher
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loops\fetchers.py", line 99, in __iter__
    super().__iter__()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\loops\fetchers.py", line 48, in __iter__
    self.iterator = iter(self.combined_loader)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\utilities\combined_loader.py", line 335, in __iter__
    iter(iterator)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\utilities\combined_loader.py", line 144, in __iter__
    self._load_current_iterator()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\utilities\combined_loader.py", line 160, in _load_current_iterator
    self.iterators = [iter(self.iterables[self._iterator_idx])]
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torch\utils\data\dataloader.py", line 435, in __iter__
    return self._get_iterator()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torch\utils\data\dataloader.py", line 381, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torch\utils\data\dataloader.py", line 1072, in __init__
    self._reset(loader, first_iter=True)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torch\utils\data\dataloader.py", line 1105, in _reset
    self._try_put_index()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torch\utils\data\dataloader.py", line 1339, in _try_put_index
    index = self._next_index()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torch\utils\data\dataloader.py", line 618, in _next_index
    return next(self._sampler_iter)  # may raise StopIteration
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torch\utils\data\sampler.py", line 254, in __iter__
    for idx in self.sampler:
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\torch\utils\data\sampler.py", line 76, in __iter__
    return iter(range(len(self.data_source)))
TypeError: object of type 'TSDataset' has no len()
[2023-10-27 12:39:38,199][utiles.utils][INFO] - Closing loggers...
[2023-10-27 12:39:38,199][utiles.utils][INFO] - Closing wandb!
[2023-10-27 13:04:58,873][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 13:04:58,874][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 13:04:58,879][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 13:04:58,879][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 13:04:58,932][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 13:04:59,408][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 13:05:00,594][__main__][INFO] - Instantiating callbacks...
[2023-10-27 13:05:00,595][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 13:05:00,597][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 13:05:00,598][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 13:05:00,599][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 13:05:00,599][__main__][INFO] - Instantiating loggers...
[2023-10-27 13:05:00,599][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 13:05:00,822][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 13:05:00,963][__main__][INFO] - Logging hyperparameters!
[2023-10-27 13:05:03,800][__main__][INFO] - Starting training!
[2023-10-27 13:05:31,120][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 38, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 545, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 581, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 990, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1034, in _run_stage
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1065, in _run_sanity_check
    call._call_callback_hooks(self, "on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\trainer\call.py", line 208, in _call_callback_hooks
    fn(trainer, trainer.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 380, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 13:05:31,143][utiles.utils][INFO] - Closing loggers...
[2023-10-27 13:05:31,143][utiles.utils][INFO] - Closing wandb!
[2023-10-27 13:43:22,641][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 13:43:22,641][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 13:43:22,646][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 13:43:22,646][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 13:43:22,699][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 13:43:22,859][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 13:43:22,866][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.baseline_models' has no attribute 'FEDformer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 5, in <module>
    from models.layers.AutoCorrelation import AutoCorrelationLayer
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\AutoCorrelation.py", line 4, in <module>
    import matplotlib.pyplot as plt
ModuleNotFoundError: No module named 'matplotlib'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'models.baseline_models.FEDformer.Model':
ModuleNotFoundError("No module named 'matplotlib'")
Are you sure that 'FEDformer' is importable from module 'models.baseline_models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.baseline_models.FEDformer.Model', see chained exception above.
full_key: pl_module.model
[2023-10-27 13:43:22,880][utiles.utils][INFO] - Closing loggers...
[2023-10-27 13:44:27,765][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 13:44:27,765][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 13:44:27,770][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 13:44:27,770][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 13:44:27,829][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 13:44:27,999][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 13:44:28,444][__main__][INFO] - Instantiating callbacks...
[2023-10-27 13:44:28,444][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 13:44:28,446][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 13:44:28,447][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 13:44:28,447][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 13:44:28,448][__main__][INFO] - Instantiating loggers...
[2023-10-27 13:44:28,448][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 13:44:30,978][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 13:44:31,015][__main__][INFO] - Logging hyperparameters!
[2023-10-27 13:44:31,021][__main__][INFO] - Starting training!
[2023-10-27 13:45:02,378][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 13:45:02,381][utiles.utils][INFO] - Closing loggers...
[2023-10-27 13:45:02,381][utiles.utils][INFO] - Closing wandb!
[2023-10-27 13:50:50,310][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 13:50:50,310][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 13:50:50,315][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 13:50:50,315][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 13:50:50,372][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 13:50:50,530][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 13:50:50,896][__main__][INFO] - Instantiating callbacks...
[2023-10-27 13:50:50,896][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 13:50:50,898][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 13:50:50,899][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 13:50:50,899][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 13:50:50,900][__main__][INFO] - Instantiating loggers...
[2023-10-27 13:50:50,900][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 13:50:53,543][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 13:50:53,595][__main__][INFO] - Logging hyperparameters!
[2023-10-27 13:50:53,601][__main__][INFO] - Starting training!
[2023-10-27 13:51:21,012][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 13:51:21,014][utiles.utils][INFO] - Closing loggers...
[2023-10-27 13:51:21,015][utiles.utils][INFO] - Closing wandb!
[2023-10-27 13:54:12,109][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 13:54:12,109][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 13:54:12,114][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 13:54:12,114][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 13:54:12,165][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 13:54:12,317][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 13:54:12,685][__main__][INFO] - Instantiating callbacks...
[2023-10-27 13:54:12,685][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 13:54:12,687][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 13:54:12,688][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 13:54:12,689][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 13:54:12,689][__main__][INFO] - Instantiating loggers...
[2023-10-27 13:54:12,689][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 13:54:15,273][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 13:54:15,308][__main__][INFO] - Logging hyperparameters!
[2023-10-27 13:54:15,314][__main__][INFO] - Starting training!
[2023-10-27 13:54:41,954][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 13:54:41,956][utiles.utils][INFO] - Closing loggers...
[2023-10-27 13:54:41,956][utiles.utils][INFO] - Closing wandb!
[2023-10-27 13:58:49,636][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 13:58:49,636][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 13:58:49,641][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 13:58:49,641][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 13:58:49,695][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 13:58:49,839][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 13:58:50,234][__main__][INFO] - Instantiating callbacks...
[2023-10-27 13:58:50,234][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 13:58:50,236][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 13:58:50,237][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 13:58:50,238][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 13:58:50,238][__main__][INFO] - Instantiating loggers...
[2023-10-27 13:58:50,238][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 13:58:52,812][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 13:58:52,855][__main__][INFO] - Logging hyperparameters!
[2023-10-27 13:58:52,861][__main__][INFO] - Starting training!
[2023-10-27 13:59:20,492][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 13:59:20,494][utiles.utils][INFO] - Closing loggers...
[2023-10-27 13:59:20,494][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:00:56,471][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:00:56,471][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:00:56,475][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:00:56,476][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:00:56,529][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:00:56,671][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:00:57,036][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:00:57,037][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:00:57,039][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:00:57,040][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:00:57,040][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:00:57,041][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:00:57,041][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:00:59,645][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:00:59,688][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:00:59,694][__main__][INFO] - Starting training!
[2023-10-27 14:01:28,508][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:01:28,510][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:01:28,510][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:05:12,350][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:05:12,350][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:05:12,354][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:05:12,355][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:05:12,408][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:05:12,552][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:05:12,917][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:05:12,918][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:05:12,920][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:05:12,920][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:05:12,921][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:05:12,921][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:05:12,922][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:05:15,487][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:05:15,529][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:05:15,534][__main__][INFO] - Starting training!
[2023-10-27 14:05:42,192][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:05:42,194][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:05:42,195][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:06:37,754][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:06:37,754][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:06:37,759][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:06:37,759][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:06:37,820][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:06:37,830][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:06:38,139][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:06:38,139][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:06:38,141][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:06:38,142][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:06:38,142][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:06:38,142][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:06:38,142][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:06:42,556][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:06:42,592][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:06:42,598][__main__][INFO] - Starting training!
[2023-10-27 14:07:09,126][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:07:09,128][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:07:09,129][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:13:08,688][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:13:08,689][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:13:08,693][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:13:08,693][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:13:08,743][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:13:08,752][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:13:09,066][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:13:09,066][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:13:09,068][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:13:09,069][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:13:09,069][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:13:09,070][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:13:09,070][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:13:12,402][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:13:12,438][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:13:12,443][__main__][INFO] - Starting training!
[2023-10-27 14:13:38,864][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:13:38,866][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:13:38,866][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:18:36,115][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:18:36,115][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:18:36,120][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:18:36,120][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:18:36,174][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:18:36,183][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:18:36,514][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:18:36,514][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:18:36,516][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:18:36,518][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:18:36,518][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:18:36,519][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:18:36,519][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:18:39,067][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:18:39,111][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:18:39,117][__main__][INFO] - Starting training!
[2023-10-27 14:19:05,843][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:19:05,845][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:19:05,845][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:23:50,467][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:23:50,467][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:23:50,471][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:23:50,472][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:23:50,524][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:23:50,534][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:23:50,846][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:23:50,846][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:23:50,849][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:23:50,849][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:23:50,850][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:23:50,850][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:23:50,850][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:23:53,339][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:23:53,374][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:23:53,380][__main__][INFO] - Starting training!
[2023-10-27 14:24:20,041][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:24:20,043][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:24:20,044][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:25:54,662][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:25:54,662][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:25:54,667][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:25:54,667][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:25:54,719][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:25:54,728][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:25:55,031][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:25:55,031][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:25:55,033][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:25:55,034][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:25:55,034][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:25:55,035][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:25:55,035][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:25:57,573][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:25:57,575][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\argparse.py", line 340, in insert_env_defaults
    return fn(self, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'progress_bar_refresh_rate'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 56, in train
    trainer: Trainer = hydra.utils.instantiate(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'pytorch_lightning.trainer.trainer.Trainer':
TypeError("__init__() got an unexpected keyword argument 'progress_bar_refresh_rate'")
full_key: trainer
[2023-10-27 14:25:57,577][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:25:57,577][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:27:34,884][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:27:34,885][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:27:34,889][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:27:34,889][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:27:34,942][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:27:34,951][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:27:35,257][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:27:35,258][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:27:35,260][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:27:35,260][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:27:35,261][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:27:35,261][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:27:35,261][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:27:37,868][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:27:37,872][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\argparse.py", line 340, in insert_env_defaults
    return fn(self, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'progress_bar_refresh_rate'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 56, in train
    trainer: Trainer = hydra.utils.instantiate(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'pytorch_lightning.trainer.trainer.Trainer':
TypeError("__init__() got an unexpected keyword argument 'progress_bar_refresh_rate'")
full_key: trainer
[2023-10-27 14:27:37,874][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:27:37,874][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:30:27,673][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:30:27,673][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:30:27,677][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:30:27,677][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:30:27,727][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:30:27,738][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:30:28,049][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:30:28,049][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:30:28,051][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:30:28,053][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:30:28,053][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:30:28,054][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:30:28,054][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:30:30,609][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:30:30,646][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:30:30,652][__main__][INFO] - Starting training!
[2023-10-27 14:30:57,202][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:30:57,204][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:30:57,204][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:33:31,186][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:33:31,186][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:33:31,191][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:33:31,191][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:33:31,245][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:33:31,256][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:33:31,567][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:33:31,567][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:33:31,570][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:33:31,571][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:33:31,571][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:33:31,572][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:33:31,572][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:33:34,127][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:33:34,163][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:33:34,168][__main__][INFO] - Starting training!
[2023-10-27 14:34:00,337][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:34:00,340][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:34:00,340][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:35:40,312][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:35:40,312][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:35:40,317][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:35:40,317][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:35:40,367][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:35:40,377][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:35:40,658][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torchmetrics\regression\mape.py", line 77, in __init__
    super().__init__(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torchmetrics\metric.py", line 146, in __init__
    raise ValueError(f"Unexpected keyword arguments: {', '.join(kwargs_)}")
ValueError: Unexpected keyword arguments: `epsilon`

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 357, in instantiate_node
    cfg[key] = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 357, in instantiate_node
    cfg[key] = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'torchmetrics.regression.mape.MeanAbsolutePercentageError':
ValueError('Unexpected keyword arguments: `epsilon`')
full_key: pl_module.metrics.train.mape
[2023-10-27 14:35:40,660][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:37:30,367][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:37:30,367][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:37:30,372][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:37:30,372][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:37:30,427][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:37:30,437][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:37:30,991][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:37:30,991][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:37:30,993][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:37:30,994][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:37:30,995][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:37:30,995][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:37:30,995][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:37:33,432][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:37:33,472][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:37:33,477][__main__][INFO] - Starting training!
[2023-10-27 14:38:01,107][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:38:01,111][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:38:01,111][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:40:15,810][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:40:15,811][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:40:15,817][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:40:15,817][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:40:15,872][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:40:15,884][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:40:16,458][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:40:16,458][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:40:16,460][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:40:16,461][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:40:16,461][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:40:16,461][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:40:16,462][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:40:19,197][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:40:19,236][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:40:19,242][__main__][INFO] - Starting training!
[2023-10-27 14:40:45,833][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:40:45,835][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:40:45,836][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:41:51,664][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:41:51,664][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:41:51,677][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:41:51,678][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:41:51,865][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:41:51,897][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:41:52,792][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:41:52,793][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:41:52,798][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:41:52,800][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:41:52,801][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:41:52,803][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:41:52,803][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:41:56,293][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:41:56,356][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:41:56,373][__main__][INFO] - Starting training!
[2023-10-27 14:43:41,042][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:43:41,042][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:43:41,047][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:43:41,047][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:43:41,097][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:43:41,106][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:43:41,254][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:43:44,282][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:43:44,282][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:43:44,287][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:43:44,287][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:43:44,345][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:43:44,355][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:43:44,913][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:43:44,914][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:43:44,916][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:43:44,917][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:43:44,917][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:43:44,917][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:43:44,917][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:43:47,398][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:43:47,438][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:43:47,443][__main__][INFO] - Starting training!
[2023-10-27 14:44:12,207][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:44:12,209][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:44:12,209][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:45:18,548][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:45:18,549][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:45:18,562][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:45:18,563][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:45:18,760][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:45:18,793][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:45:19,733][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:45:19,734][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:45:19,740][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:45:19,742][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:45:19,743][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:45:19,745][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:45:19,745][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:45:23,213][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:45:23,274][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:45:23,292][__main__][INFO] - Starting training!
[2023-10-27 14:49:34,424][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:49:34,425][utiles.utils][INFO] - Closing wandb!
[2023-10-27 14:53:44,132][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 14:53:44,132][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 14:53:44,137][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 14:53:44,137][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 14:53:44,189][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 14:53:44,198][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 14:53:44,740][__main__][INFO] - Instantiating callbacks...
[2023-10-27 14:53:44,740][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 14:53:44,742][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 14:53:44,743][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 14:53:44,743][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 14:53:44,744][__main__][INFO] - Instantiating loggers...
[2023-10-27 14:53:44,744][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 14:53:47,256][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 14:53:47,294][__main__][INFO] - Logging hyperparameters!
[2023-10-27 14:53:47,300][__main__][INFO] - Starting training!
[2023-10-27 14:54:12,959][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 14:54:12,961][utiles.utils][INFO] - Closing loggers...
[2023-10-27 14:54:12,961][utiles.utils][INFO] - Closing wandb!
[2023-10-27 15:40:39,275][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 15:40:39,275][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 15:40:39,284][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 15:40:39,284][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 15:40:39,365][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 15:40:39,380][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 15:40:40,113][__main__][INFO] - Instantiating callbacks...
[2023-10-27 15:40:40,113][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 15:40:40,115][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 15:40:40,116][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 15:40:40,116][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 15:40:40,117][__main__][INFO] - Instantiating loggers...
[2023-10-27 15:40:40,117][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 15:40:43,021][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 15:40:43,064][__main__][INFO] - Logging hyperparameters!
[2023-10-27 15:40:43,070][__main__][INFO] - Starting training!
[2023-10-27 15:41:08,024][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 15:41:08,026][utiles.utils][INFO] - Closing loggers...
[2023-10-27 15:41:08,026][utiles.utils][INFO] - Closing wandb!
[2023-10-27 15:42:43,918][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 15:42:43,918][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 15:42:43,924][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 15:42:43,924][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 15:42:43,979][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 15:42:43,988][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 15:42:43,999][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 981, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'pl_models.pl_baselines.TSForecastTask'; 'pl_models.pl_baselines' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'pl_models.pl_baselines.TSForecastTask':
ModuleNotFoundError("No module named 'pl_models.pl_baselines.TSForecastTask'; 'pl_models.pl_baselines' is not a package")
Are you sure that 'TSForecastTask' is importable from module 'pl_models.pl_baselines'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'pl_models.pl_baselines.TSForecastTask', see chained exception above.
full_key: pl_module
[2023-10-27 15:42:44,002][utiles.utils][INFO] - Closing loggers...
[2023-10-27 15:50:58,769][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 15:50:58,769][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 15:50:58,775][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 15:50:58,775][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 15:50:58,834][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 15:50:58,845][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 15:50:59,593][__main__][INFO] - Instantiating callbacks...
[2023-10-27 15:50:59,593][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 15:50:59,595][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 15:50:59,596][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 15:50:59,597][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 15:50:59,597][__main__][INFO] - Instantiating loggers...
[2023-10-27 15:50:59,597][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 15:51:02,497][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 15:51:02,555][__main__][INFO] - Logging hyperparameters!
[2023-10-27 15:51:02,561][__main__][INFO] - Starting training!
[2023-10-27 15:51:29,723][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 15:51:29,726][utiles.utils][INFO] - Closing loggers...
[2023-10-27 15:51:29,726][utiles.utils][INFO] - Closing wandb!
[2023-10-27 16:38:26,372][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 16:38:26,373][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 16:38:26,378][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 16:38:26,378][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 16:38:26,431][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 16:38:26,455][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 16:38:27,027][__main__][INFO] - Instantiating callbacks...
[2023-10-27 16:38:27,027][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 16:38:27,029][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 16:38:27,030][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 16:38:27,030][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 16:38:27,031][__main__][INFO] - Instantiating loggers...
[2023-10-27 16:38:27,031][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 16:38:29,689][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 16:38:29,736][__main__][INFO] - Logging hyperparameters!
[2023-10-27 16:38:29,741][__main__][INFO] - Starting training!
[2023-10-27 16:38:29,854][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1037, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1284, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1361, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 36, in setup
    self.data_train = TSDataset(**self.hparams.dataset, mode="train")
TypeError: __init__() got an unexpected keyword argument 'ts_target_channels'
[2023-10-27 16:38:29,862][utiles.utils][INFO] - Closing loggers...
[2023-10-27 16:38:29,862][utiles.utils][INFO] - Closing wandb!
[2023-10-27 16:46:56,739][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 16:46:56,740][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 16:46:56,745][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 16:46:56,745][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 16:46:56,799][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 16:46:56,808][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 16:46:57,371][__main__][INFO] - Instantiating callbacks...
[2023-10-27 16:46:57,371][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 16:46:57,373][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 16:46:57,374][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 16:46:57,374][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 16:46:57,375][__main__][INFO] - Instantiating loggers...
[2023-10-27 16:46:57,375][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 16:47:00,145][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 16:47:00,190][__main__][INFO] - Logging hyperparameters!
[2023-10-27 16:47:00,196][__main__][INFO] - Starting training!
[2023-10-27 16:47:00,309][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1037, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1284, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1361, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 36, in setup
    self.data_train = TSDataset(**self.hparams.dataset, mode="train")
TypeError: __init__() got an unexpected keyword argument 'use_target'
[2023-10-27 16:47:00,311][utiles.utils][INFO] - Closing loggers...
[2023-10-27 16:47:00,311][utiles.utils][INFO] - Closing wandb!
[2023-10-27 16:50:15,668][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 16:50:15,669][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 16:50:15,674][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 16:50:15,674][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 16:50:15,726][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 16:50:15,735][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 16:50:16,306][__main__][INFO] - Instantiating callbacks...
[2023-10-27 16:50:16,306][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 16:50:16,308][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 16:50:16,309][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 16:50:16,309][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 16:50:16,310][__main__][INFO] - Instantiating loggers...
[2023-10-27 16:50:16,310][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 16:50:18,860][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 16:50:18,904][__main__][INFO] - Logging hyperparameters!
[2023-10-27 16:50:18,910][__main__][INFO] - Starting training!
[2023-10-27 16:50:45,419][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 16:50:45,423][utiles.utils][INFO] - Closing loggers...
[2023-10-27 16:50:45,423][utiles.utils][INFO] - Closing wandb!
[2023-10-27 16:58:46,865][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 16:58:46,865][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 16:58:46,870][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 16:58:46,871][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 16:58:46,932][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 16:58:46,944][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 16:58:47,597][__main__][INFO] - Instantiating callbacks...
[2023-10-27 16:58:47,597][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 16:58:47,599][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 16:58:47,600][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 16:58:47,601][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-27 16:58:47,601][__main__][INFO] - Instantiating loggers...
[2023-10-27 16:58:47,602][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 16:58:50,499][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 16:58:50,545][__main__][INFO] - Logging hyperparameters!
[2023-10-27 16:58:50,553][__main__][INFO] - Starting training!
[2023-10-27 16:59:28,879][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1264, in _run_sanity_check
    self._call_callback_hooks("on_sanity_check_end")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1380, in _call_callback_hooks
    fn(self, self.lightning_module, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\callbacks\progress\rich_progress.py", line 358, in on_sanity_check_end
    assert self.val_sanity_progress_bar_id is not None
AssertionError
[2023-10-27 16:59:28,883][utiles.utils][INFO] - Closing loggers...
[2023-10-27 16:59:28,883][utiles.utils][INFO] - Closing wandb!
[2023-10-27 17:12:16,980][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 17:12:16,981][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 17:12:16,984][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 17:12:16,984][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 17:12:17,038][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 17:12:17,047][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 17:12:17,614][__main__][INFO] - Instantiating callbacks...
[2023-10-27 17:12:17,614][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 17:12:17,616][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 17:12:17,617][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 17:12:17,618][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-27 17:12:17,618][__main__][INFO] - Instantiating loggers...
[2023-10-27 17:12:17,618][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 17:12:20,318][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 17:12:20,362][__main__][INFO] - Logging hyperparameters!
[2023-10-27 17:12:20,368][__main__][INFO] - Starting training!
[2023-10-27 17:12:45,173][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1200, in _run_train
    self.fit_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 194, in run
    self.on_run_start(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\fit_loop.py", line 206, in on_run_start
    self.trainer.reset_train_dataloader(self.trainer.lightning_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1515, in reset_train_dataloader
    self.train_dataloader = self._data_connector._request_dataloader(RunningStage.TRAINING)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\connectors\data_connector.py", line 446, in _request_dataloader
    dataloader = source.dataloader()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\connectors\data_connector.py", line 524, in dataloader
    return method()
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 41, in train_dataloader
    return DataLoader(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\lightning_lite\utilities\data.py", line 323, in wrapper
    init(obj, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
[2023-10-27 17:12:45,176][utiles.utils][INFO] - Closing loggers...
[2023-10-27 17:12:45,176][utiles.utils][INFO] - Closing wandb!
[2023-10-27 17:18:12,072][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 17:18:12,073][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 17:18:12,076][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 17:18:12,076][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 17:18:12,127][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 17:18:12,137][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 17:18:12,685][__main__][INFO] - Instantiating callbacks...
[2023-10-27 17:18:12,686][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 17:18:12,688][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 17:18:12,689][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 17:18:12,689][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-27 17:18:12,689][__main__][INFO] - Instantiating loggers...
[2023-10-27 17:18:12,689][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 17:18:15,231][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 17:18:15,270][__main__][INFO] - Logging hyperparameters!
[2023-10-27 17:18:15,276][__main__][INFO] - Starting training!
[2023-10-27 17:18:39,282][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1200, in _run_train
    self.fit_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 194, in run
    self.on_run_start(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\fit_loop.py", line 206, in on_run_start
    self.trainer.reset_train_dataloader(self.trainer.lightning_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1515, in reset_train_dataloader
    self.train_dataloader = self._data_connector._request_dataloader(RunningStage.TRAINING)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\connectors\data_connector.py", line 446, in _request_dataloader
    dataloader = source.dataloader()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\connectors\data_connector.py", line 524, in dataloader
    return method()
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 41, in train_dataloader
    return DataLoader(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\lightning_lite\utilities\data.py", line 323, in wrapper
    init(obj, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
[2023-10-27 17:18:39,284][utiles.utils][INFO] - Closing loggers...
[2023-10-27 17:18:39,284][utiles.utils][INFO] - Closing wandb!
[2023-10-27 17:20:54,242][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 17:20:54,243][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 17:20:54,246][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 17:20:54,246][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 17:20:54,298][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 17:20:54,309][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 17:20:54,857][__main__][INFO] - Instantiating callbacks...
[2023-10-27 17:20:54,857][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 17:20:54,859][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 17:20:54,860][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 17:20:54,860][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-27 17:20:54,860][__main__][INFO] - Instantiating loggers...
[2023-10-27 17:20:54,861][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 17:20:57,372][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 17:20:57,412][__main__][INFO] - Logging hyperparameters!
[2023-10-27 17:20:57,418][__main__][INFO] - Starting training!
[2023-10-27 17:21:05,972][__main__][INFO] - Best model ckpt at 
[2023-10-27 17:21:05,972][__main__][INFO] - Starting testing!
[2023-10-27 17:21:05,972][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-27 17:21:06,091][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-10-27 17:21:06,094][utiles.utils][INFO] - Closing loggers...
[2023-10-27 17:21:06,094][utiles.utils][INFO] - Closing wandb!
[2023-10-27 17:23:06,845][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 17:23:06,845][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 17:23:06,848][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 17:23:06,848][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 17:23:06,901][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 17:23:06,913][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 17:23:07,458][__main__][INFO] - Instantiating callbacks...
[2023-10-27 17:23:07,458][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 17:23:07,460][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 17:23:07,461][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 17:23:07,461][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-27 17:23:07,462][__main__][INFO] - Instantiating loggers...
[2023-10-27 17:23:07,462][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 17:23:09,997][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 17:23:10,038][__main__][INFO] - Logging hyperparameters!
[2023-10-27 17:23:10,044][__main__][INFO] - Starting training!
[2023-10-27 17:23:10,695][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1037, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1284, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1361, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 36, in setup
    self.data_train = TSDataset(**self.hparams.dataset, mode="train")
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 71, in __init__
    self.check_continuity(data['Time'].values)
TypeError: check_continuity() takes 1 positional argument but 2 were given
[2023-10-27 17:23:10,697][utiles.utils][INFO] - Closing loggers...
[2023-10-27 17:23:10,698][utiles.utils][INFO] - Closing wandb!
[2023-10-27 17:24:30,749][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 17:24:30,750][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 17:24:30,753][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 17:24:30,753][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 17:24:30,803][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 17:24:30,814][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 17:24:31,357][__main__][INFO] - Instantiating callbacks...
[2023-10-27 17:24:31,357][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 17:24:31,359][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 17:24:31,360][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 17:24:31,360][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-27 17:24:31,361][__main__][INFO] - Instantiating loggers...
[2023-10-27 17:24:31,361][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 17:24:33,970][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 17:24:34,011][__main__][INFO] - Logging hyperparameters!
[2023-10-27 17:24:34,017][__main__][INFO] - Starting training!
[2023-10-27 17:24:42,893][__main__][INFO] - Best model ckpt at 
[2023-10-27 17:24:42,893][__main__][INFO] - Starting testing!
[2023-10-27 17:24:42,893][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-27 17:24:43,005][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-10-27 17:24:43,007][utiles.utils][INFO] - Closing loggers...
[2023-10-27 17:24:43,007][utiles.utils][INFO] - Closing wandb!
[2023-10-27 17:25:20,353][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 17:25:20,353][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 17:25:20,357][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 17:25:20,357][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 17:25:20,408][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 17:25:20,418][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 17:25:20,984][__main__][INFO] - Instantiating callbacks...
[2023-10-27 17:25:20,985][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 17:25:20,987][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 17:25:20,988][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 17:25:20,988][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-27 17:25:20,988][__main__][INFO] - Instantiating loggers...
[2023-10-27 17:25:20,988][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 17:25:23,555][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 17:25:23,593][__main__][INFO] - Logging hyperparameters!
[2023-10-27 17:25:23,599][__main__][INFO] - Starting training!
[2023-10-27 17:25:27,415][__main__][INFO] - Best model ckpt at 
[2023-10-27 17:25:27,415][__main__][INFO] - Starting testing!
[2023-10-27 17:25:27,415][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-27 17:25:27,523][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-10-27 17:25:27,525][utiles.utils][INFO] - Closing loggers...
[2023-10-27 17:25:27,525][utiles.utils][INFO] - Closing wandb!
[2023-10-27 17:29:17,612][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 17:29:17,612][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 17:29:17,615][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 17:29:17,616][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 17:29:17,668][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 17:29:17,679][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 17:29:18,241][__main__][INFO] - Instantiating callbacks...
[2023-10-27 17:29:18,241][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 17:29:18,244][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 17:29:18,244][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 17:29:18,245][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-27 17:29:18,245][__main__][INFO] - Instantiating loggers...
[2023-10-27 17:29:18,245][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 17:29:20,797][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 17:29:20,836][__main__][INFO] - Logging hyperparameters!
[2023-10-27 17:29:20,842][__main__][INFO] - Starting training!
[2023-10-27 17:29:26,986][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1037, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1284, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1361, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 36, in setup
    self.data_train = TSDataset(**self.hparams.dataset, mode="train")
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 69, in __init__
    data = pd.read_csv(data_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pandas\io\parsers\readers.py", line 948, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pandas\io\parsers\readers.py", line 617, in _read
    return parser.read(nrows)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pandas\io\parsers\readers.py", line 1748, in read
    ) = self._engine.read(  # type: ignore[attr-defined]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 234, in read
    chunks = self._reader.read_low_memory(nrows)
  File "parsers.pyx", line 843, in pandas._libs.parsers.TextReader.read_low_memory
  File "parsers.pyx", line 904, in pandas._libs.parsers.TextReader._read_rows
  File "parsers.pyx", line 879, in pandas._libs.parsers.TextReader._tokenize_rows
  File "parsers.pyx", line 890, in pandas._libs.parsers.TextReader._check_tokenize_status
  File "parsers.pyx", line 2058, in pandas._libs.parsers.raise_parser_error
pandas.errors.ParserError: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
[2023-10-27 17:29:26,988][utiles.utils][INFO] - Closing loggers...
[2023-10-27 17:29:26,988][utiles.utils][INFO] - Closing wandb!
[2023-10-27 17:29:50,814][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 17:29:50,814][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 17:29:50,817][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 17:29:50,818][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 17:29:50,868][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 17:29:50,879][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 17:29:51,425][__main__][INFO] - Instantiating callbacks...
[2023-10-27 17:29:51,425][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 17:29:51,427][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 17:29:51,428][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 17:29:51,429][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-27 17:29:51,429][__main__][INFO] - Instantiating loggers...
[2023-10-27 17:29:51,429][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 17:29:54,048][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 17:29:54,087][__main__][INFO] - Logging hyperparameters!
[2023-10-27 17:29:54,092][__main__][INFO] - Starting training!
[2023-10-27 17:30:02,545][__main__][INFO] - Best model ckpt at 
[2023-10-27 17:30:02,546][__main__][INFO] - Starting testing!
[2023-10-27 17:30:02,546][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-27 17:30:02,659][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-10-27 17:30:02,661][utiles.utils][INFO] - Closing loggers...
[2023-10-27 17:30:02,662][utiles.utils][INFO] - Closing wandb!
[2023-10-27 17:30:20,873][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 17:30:20,873][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 17:30:20,877][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 17:30:20,877][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 17:30:20,930][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 17:30:20,941][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 17:30:21,499][__main__][INFO] - Instantiating callbacks...
[2023-10-27 17:30:21,500][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 17:30:21,503][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 17:30:21,503][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 17:30:21,504][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-27 17:30:21,504][__main__][INFO] - Instantiating loggers...
[2023-10-27 17:30:21,504][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 17:30:24,053][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 17:30:24,093][__main__][INFO] - Logging hyperparameters!
[2023-10-27 17:30:24,099][__main__][INFO] - Starting training!
[2023-10-27 17:30:52,487][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 157, in __getitem__
    x_begin_index = int(step_idx[0])
IndexError: index 0 is out of bounds for axis 0 with size 0

[2023-10-27 17:30:52,492][utiles.utils][INFO] - Closing loggers...
[2023-10-27 17:30:52,493][utiles.utils][INFO] - Closing wandb!
[2023-10-27 17:31:47,947][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 17:31:47,947][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 17:31:47,951][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 17:31:47,951][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 17:31:48,003][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 17:31:48,014][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 17:31:48,124][utiles.utils][INFO] - Closing loggers...
[2023-10-27 17:33:36,905][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-27 17:33:36,905][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-27 17:33:36,908][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-27 17:33:36,908][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-27 17:33:36,961][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-27 17:33:36,975][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-27 17:33:37,553][__main__][INFO] - Instantiating callbacks...
[2023-10-27 17:33:37,554][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-27 17:33:37,556][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-27 17:33:37,557][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-27 17:33:37,557][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-27 17:33:37,557][__main__][INFO] - Instantiating loggers...
[2023-10-27 17:33:37,558][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-27 17:33:40,033][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-27 17:33:40,071][__main__][INFO] - Logging hyperparameters!
[2023-10-27 17:33:40,076][__main__][INFO] - Starting training!
[2023-10-27 17:33:48,494][__main__][INFO] - Best model ckpt at 
[2023-10-27 17:33:48,494][__main__][INFO] - Starting testing!
[2023-10-27 17:33:48,494][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-27 17:33:48,603][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-10-27 17:33:48,606][utiles.utils][INFO] - Closing loggers...
[2023-10-27 17:33:48,606][utiles.utils][INFO] - Closing wandb!
[2023-10-28 15:47:28,693][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 15:47:28,693][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 15:47:28,696][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 15:47:28,696][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 15:47:28,750][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 15:47:28,761][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 15:47:29,569][__main__][INFO] - Instantiating callbacks...
[2023-10-28 15:47:29,569][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 15:47:29,571][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 15:47:29,572][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 15:47:29,572][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 15:47:29,572][__main__][INFO] - Instantiating loggers...
[2023-10-28 15:47:29,573][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 15:47:32,451][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 15:47:32,512][__main__][INFO] - Logging hyperparameters!
[2023-10-28 15:47:32,517][__main__][INFO] - Starting training!
[2023-10-28 15:48:02,074][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 159, in __getitem__
    x_begin_index = int(step_idx[0])
IndexError: index 0 is out of bounds for axis 0 with size 0

[2023-10-28 15:48:02,254][utiles.utils][INFO] - Closing loggers...
[2023-10-28 15:48:02,254][utiles.utils][INFO] - Closing wandb!
[2023-10-28 15:49:40,357][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 15:49:40,357][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 15:49:40,360][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 15:49:40,360][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 15:49:40,415][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 15:49:40,426][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 15:49:41,012][__main__][INFO] - Instantiating callbacks...
[2023-10-28 15:49:41,012][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 15:49:41,014][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 15:49:41,015][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 15:49:41,016][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 15:49:41,016][__main__][INFO] - Instantiating loggers...
[2023-10-28 15:49:41,016][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 15:49:43,754][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 15:49:43,795][__main__][INFO] - Logging hyperparameters!
[2023-10-28 15:49:43,800][__main__][INFO] - Starting training!
[2023-10-28 15:50:11,702][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 160, in __getitem__
    x_begin_index = int(step_idx[0])
IndexError: index 0 is out of bounds for axis 0 with size 0

[2023-10-28 15:50:11,710][utiles.utils][INFO] - Closing loggers...
[2023-10-28 15:50:11,710][utiles.utils][INFO] - Closing wandb!
[2023-10-28 15:52:38,924][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 15:52:38,924][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 15:52:38,927][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 15:52:38,927][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 15:52:38,977][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 15:52:38,988][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 15:52:39,590][__main__][INFO] - Instantiating callbacks...
[2023-10-28 15:52:39,590][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 15:52:39,592][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 15:52:39,593][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 15:52:39,593][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 15:52:39,594][__main__][INFO] - Instantiating loggers...
[2023-10-28 15:52:39,594][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 15:52:42,329][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 15:52:42,368][__main__][INFO] - Logging hyperparameters!
[2023-10-28 15:52:42,373][__main__][INFO] - Starting training!
[2023-10-28 15:53:11,601][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 162, in __getitem__
    x_begin_index = int(step_idx[0])
IndexError: index 0 is out of bounds for axis 0 with size 0

[2023-10-28 15:53:11,609][utiles.utils][INFO] - Closing loggers...
[2023-10-28 15:53:11,609][utiles.utils][INFO] - Closing wandb!
[2023-10-28 15:58:39,138][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 15:58:39,138][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 15:58:39,141][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 15:58:39,141][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 15:58:39,193][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 15:58:39,203][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 15:58:39,793][__main__][INFO] - Instantiating callbacks...
[2023-10-28 15:58:39,793][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 15:58:39,795][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 15:58:39,796][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 15:58:39,796][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 15:58:39,797][__main__][INFO] - Instantiating loggers...
[2023-10-28 15:58:39,797][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 15:58:42,628][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 15:58:42,669][__main__][INFO] - Logging hyperparameters!
[2023-10-28 15:58:42,674][__main__][INFO] - Starting training!
[2023-10-28 15:58:52,808][__main__][INFO] - Best model ckpt at 
[2023-10-28 15:58:52,808][__main__][INFO] - Starting testing!
[2023-10-28 15:58:52,808][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-28 15:58:52,920][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-10-28 15:58:52,939][utiles.utils][INFO] - Closing loggers...
[2023-10-28 15:58:52,939][utiles.utils][INFO] - Closing wandb!
[2023-10-28 16:02:50,305][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 16:02:50,305][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 16:02:50,309][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 16:02:50,309][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 16:02:50,358][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 16:02:50,367][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 16:02:50,966][__main__][INFO] - Instantiating callbacks...
[2023-10-28 16:02:50,966][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 16:02:50,968][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 16:02:50,969][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 16:02:50,969][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 16:02:50,970][__main__][INFO] - Instantiating loggers...
[2023-10-28 16:02:50,970][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 16:02:53,717][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 16:02:53,754][__main__][INFO] - Logging hyperparameters!
[2023-10-28 16:02:53,759][__main__][INFO] - Starting training!
[2023-10-28 16:03:00,123][__main__][INFO] - Best model ckpt at 
[2023-10-28 16:03:00,123][__main__][INFO] - Starting testing!
[2023-10-28 16:03:00,123][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-28 16:03:00,240][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-10-28 16:03:00,242][utiles.utils][INFO] - Closing loggers...
[2023-10-28 16:03:00,242][utiles.utils][INFO] - Closing wandb!
[2023-10-28 16:03:28,657][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 16:03:28,657][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 16:03:28,661][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 16:03:28,661][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 16:03:28,715][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 16:03:28,725][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 16:03:29,338][__main__][INFO] - Instantiating callbacks...
[2023-10-28 16:03:29,339][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 16:03:29,341][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 16:03:29,341][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 16:03:29,342][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 16:03:29,342][__main__][INFO] - Instantiating loggers...
[2023-10-28 16:03:29,342][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 16:03:32,123][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 16:03:32,162][__main__][INFO] - Logging hyperparameters!
[2023-10-28 16:03:32,166][__main__][INFO] - Starting training!
[2023-10-28 16:03:37,554][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1037, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1284, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1361, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 36, in setup
    self.data_train = TSDataset(**self.hparams.dataset, mode="train")
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 61, in __init__
    data = pd.read_csv(data_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pandas\io\parsers\readers.py", line 948, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pandas\io\parsers\readers.py", line 617, in _read
    return parser.read(nrows)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pandas\io\parsers\readers.py", line 1748, in read
    ) = self._engine.read(  # type: ignore[attr-defined]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 234, in read
    chunks = self._reader.read_low_memory(nrows)
  File "parsers.pyx", line 843, in pandas._libs.parsers.TextReader.read_low_memory
  File "parsers.pyx", line 904, in pandas._libs.parsers.TextReader._read_rows
  File "parsers.pyx", line 879, in pandas._libs.parsers.TextReader._tokenize_rows
  File "parsers.pyx", line 890, in pandas._libs.parsers.TextReader._check_tokenize_status
  File "parsers.pyx", line 2058, in pandas._libs.parsers.raise_parser_error
pandas.errors.ParserError: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
[2023-10-28 16:03:37,577][utiles.utils][INFO] - Closing loggers...
[2023-10-28 16:03:37,577][utiles.utils][INFO] - Closing wandb!
[2023-10-28 16:04:21,943][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 16:04:21,943][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 16:04:21,946][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 16:04:21,946][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 16:04:21,997][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 16:04:22,007][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 16:04:22,600][__main__][INFO] - Instantiating callbacks...
[2023-10-28 16:04:22,600][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 16:04:22,603][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 16:04:22,603][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 16:04:22,604][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 16:04:22,604][__main__][INFO] - Instantiating loggers...
[2023-10-28 16:04:22,604][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 16:04:26,391][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 16:04:26,429][__main__][INFO] - Logging hyperparameters!
[2023-10-28 16:04:26,434][__main__][INFO] - Starting training!
[2023-10-28 16:04:31,883][__main__][INFO] - Best model ckpt at 
[2023-10-28 16:04:31,884][__main__][INFO] - Starting testing!
[2023-10-28 16:04:31,884][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-28 16:04:31,992][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-10-28 16:04:31,994][utiles.utils][INFO] - Closing loggers...
[2023-10-28 16:04:31,994][utiles.utils][INFO] - Closing wandb!
[2023-10-28 17:08:58,267][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 17:08:58,267][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 17:08:58,272][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 17:08:58,272][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 17:08:58,327][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 17:08:58,343][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 17:08:59,252][__main__][INFO] - Instantiating callbacks...
[2023-10-28 17:08:59,252][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 17:08:59,254][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 17:08:59,255][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 17:08:59,255][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 17:08:59,255][__main__][INFO] - Instantiating loggers...
[2023-10-28 17:08:59,255][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 17:09:02,238][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 17:09:02,283][__main__][INFO] - Logging hyperparameters!
[2023-10-28 17:09:02,288][__main__][INFO] - Starting training!
[2023-10-28 17:09:13,393][__main__][INFO] - Best model ckpt at 
[2023-10-28 17:09:13,394][__main__][INFO] - Starting testing!
[2023-10-28 17:09:13,394][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-28 17:09:13,507][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-10-28 17:09:13,533][utiles.utils][INFO] - Closing loggers...
[2023-10-28 17:09:13,533][utiles.utils][INFO] - Closing wandb!
[2023-10-28 17:10:14,988][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 17:10:14,988][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 17:10:14,992][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 17:10:14,992][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 17:10:15,055][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 17:10:15,072][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 17:10:15,824][__main__][INFO] - Instantiating callbacks...
[2023-10-28 17:10:15,824][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 17:10:15,827][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 17:10:15,828][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 17:10:15,828][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 17:10:15,828][__main__][INFO] - Instantiating loggers...
[2023-10-28 17:10:15,828][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 17:10:18,831][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 17:10:18,870][__main__][INFO] - Logging hyperparameters!
[2023-10-28 17:10:18,876][__main__][INFO] - Starting training!
[2023-10-28 17:11:18,542][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 182, in __getitem__
    ts_tensor[
IndexError: index 9 is out of bounds for dimension 0 with size 9

[2023-10-28 17:11:18,600][utiles.utils][INFO] - Closing loggers...
[2023-10-28 17:11:18,601][utiles.utils][INFO] - Closing wandb!
[2023-10-28 17:15:47,584][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 17:15:47,584][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 17:15:47,588][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 17:15:47,588][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 17:15:47,648][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 17:15:47,668][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 17:15:48,386][__main__][INFO] - Instantiating callbacks...
[2023-10-28 17:15:48,386][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 17:15:48,388][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 17:15:48,389][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 17:15:48,390][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 17:15:48,390][__main__][INFO] - Instantiating loggers...
[2023-10-28 17:15:48,390][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 17:15:50,122][utiles.utils][INFO] - Closing loggers...
[2023-10-28 17:17:26,751][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 17:17:26,751][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 17:17:26,754][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 17:17:26,755][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 17:17:26,810][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 17:17:26,828][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 17:17:27,527][__main__][INFO] - Instantiating callbacks...
[2023-10-28 17:17:27,527][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 17:17:27,530][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 17:17:27,531][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 17:17:27,531][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 17:17:27,531][__main__][INFO] - Instantiating loggers...
[2023-10-28 17:17:27,531][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 17:17:30,493][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 17:17:30,530][__main__][INFO] - Logging hyperparameters!
[2023-10-28 17:17:30,537][__main__][INFO] - Starting training!
[2023-10-28 17:18:31,290][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 185, in __getitem__
    ts_tensor[
IndexError: index 9 is out of bounds for dimension 0 with size 9

[2023-10-28 17:18:31,294][utiles.utils][INFO] - Closing loggers...
[2023-10-28 17:18:31,294][utiles.utils][INFO] - Closing wandb!
[2023-10-28 17:42:32,738][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 17:42:32,738][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 17:42:32,742][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 17:42:32,742][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 17:42:32,795][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 17:42:32,812][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 17:42:33,467][__main__][INFO] - Instantiating callbacks...
[2023-10-28 17:42:33,467][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 17:42:33,469][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 17:42:33,470][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 17:42:33,471][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 17:42:33,471][__main__][INFO] - Instantiating loggers...
[2023-10-28 17:42:33,471][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 17:42:36,344][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 17:42:36,386][__main__][INFO] - Logging hyperparameters!
[2023-10-28 17:42:36,391][__main__][INFO] - Starting training!
[2023-10-28 17:43:30,971][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 186, in __getitem__
    ts_tensor[
IndexError: index 9 is out of bounds for dimension 0 with size 9

[2023-10-28 17:43:30,978][utiles.utils][INFO] - Closing loggers...
[2023-10-28 17:43:30,978][utiles.utils][INFO] - Closing wandb!
[2023-10-28 17:45:51,668][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 17:45:51,668][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 17:45:51,671][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 17:45:51,671][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 17:45:51,734][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 17:45:51,745][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 17:45:52,432][__main__][INFO] - Instantiating callbacks...
[2023-10-28 17:45:52,433][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 17:45:52,435][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 17:45:52,435][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 17:45:52,436][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 17:45:52,436][__main__][INFO] - Instantiating loggers...
[2023-10-28 17:45:52,436][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 17:45:55,165][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 17:45:55,200][__main__][INFO] - Logging hyperparameters!
[2023-10-28 17:45:55,205][__main__][INFO] - Starting training!
[2023-10-28 17:46:48,714][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 188, in __getitem__
    ts_tensor[
IndexError: index 9 is out of bounds for dimension 0 with size 9

[2023-10-28 17:46:48,721][utiles.utils][INFO] - Closing loggers...
[2023-10-28 17:46:48,721][utiles.utils][INFO] - Closing wandb!
[2023-10-28 17:49:33,427][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 17:49:33,427][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 17:49:33,430][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 17:49:33,431][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 17:49:33,483][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 17:49:33,493][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 17:49:34,113][__main__][INFO] - Instantiating callbacks...
[2023-10-28 17:49:34,113][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 17:49:34,115][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 17:49:34,117][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 17:49:34,117][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 17:49:34,117][__main__][INFO] - Instantiating loggers...
[2023-10-28 17:49:34,117][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 17:49:36,888][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 17:49:36,927][__main__][INFO] - Logging hyperparameters!
[2023-10-28 17:49:36,933][__main__][INFO] - Starting training!
[2023-10-28 17:50:27,208][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 188, in __getitem__
    ts_tensor[
IndexError: index 9 is out of bounds for dimension 0 with size 9

[2023-10-28 17:50:27,215][utiles.utils][INFO] - Closing loggers...
[2023-10-28 17:50:27,215][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:13:47,354][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:13:47,354][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:13:47,357][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:13:47,357][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:13:47,407][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:13:47,418][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:13:48,229][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:13:48,230][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:13:48,232][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:13:48,233][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:13:48,233][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:13:48,233][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:13:48,233][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:13:51,332][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:13:51,391][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:13:51,396][__main__][INFO] - Starting training!
[2023-10-28 18:14:46,877][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 184, in __getitem__
    ts_tensor = torch.from_numpy(data.values)
TypeError: can't convert np.ndarray of type numpy.object_. The only supported types are: float64, float32, float16, complex64, complex128, int64, int32, int16, int8, uint8, and bool.

[2023-10-28 18:14:46,882][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:14:46,882][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:18:15,322][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:18:15,322][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:18:15,326][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:18:15,326][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:18:15,382][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:18:15,393][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:18:16,016][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:18:16,016][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:18:16,017][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:18:16,018][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:18:16,019][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:18:16,019][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:18:16,019][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:18:18,837][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:18:18,875][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:18:18,881][__main__][INFO] - Starting training!
[2023-10-28 18:19:11,161][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 135, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 78, in prepare_batch
    ghi_id = batch["dw_solar"].long()[0].item()
KeyError: 'dw_solar'
[2023-10-28 18:19:11,179][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:19:11,179][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:21:29,402][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:21:29,402][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:21:29,406][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:21:29,406][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:21:29,459][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:21:29,470][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:21:30,120][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:21:30,120][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:21:30,122][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:21:30,123][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:21:30,123][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:21:30,124][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:21:30,124][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:21:32,968][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:21:33,006][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:21:33,011][__main__][INFO] - Starting training!
[2023-10-28 18:22:25,646][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 135, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 78, in prepare_batch
    ghi_id = batch["ghi"].long()[0].item()
AttributeError: 'list' object has no attribute 'long'
[2023-10-28 18:22:25,648][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:22:25,648][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:24:43,809][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:24:43,809][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:24:43,812][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:24:43,813][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:24:43,869][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:24:43,878][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:24:44,506][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:24:44,506][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:24:44,508][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:24:44,509][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:24:44,509][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:24:44,509][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:24:44,510][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:24:47,216][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:24:47,255][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:24:47,261][__main__][INFO] - Starting training!
[2023-10-28 18:25:42,973][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 135, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 78, in prepare_batch
    ghi_id = batch["ghi"].long()[0].item()
AttributeError: 'list' object has no attribute 'long'
[2023-10-28 18:25:42,975][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:25:42,976][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:31:46,443][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:31:46,444][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:31:46,447][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:31:46,447][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:31:46,505][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:31:46,515][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:31:47,224][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:31:47,224][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:31:47,227][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:31:47,228][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:31:47,228][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:31:47,228][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:31:47,228][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:31:49,937][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:31:49,978][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:31:49,984][__main__][INFO] - Starting training!
[2023-10-28 18:32:15,349][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 135, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 78, in prepare_batch
    ghi_id = batch["ghi"].long()[0].item()
AttributeError: 'list' object has no attribute 'long'
[2023-10-28 18:32:15,352][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:32:15,353][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:33:41,725][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:33:41,725][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:33:41,729][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:33:41,729][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:33:41,785][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:33:41,796][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:33:42,473][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:33:42,474][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:33:42,476][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:33:42,477][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:33:42,477][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:33:42,477][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:33:42,477][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:33:45,260][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:33:45,302][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:33:45,308][__main__][INFO] - Starting training!
[2023-10-28 18:34:11,087][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 135, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 78, in prepare_batch
    ghi_id = batch["ghi"].long()[0].item()
AttributeError: 'list' object has no attribute 'long'
[2023-10-28 18:34:11,089][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:34:11,089][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:35:04,803][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:35:04,804][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:35:04,807][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:35:04,807][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:35:04,864][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:35:04,874][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:35:05,531][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:35:05,531][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:35:05,533][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:35:05,534][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:35:05,534][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:35:05,534][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:35:05,534][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:35:08,551][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:35:08,594][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:35:08,600][__main__][INFO] - Starting training!
[2023-10-28 18:35:20,311][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 135, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 78, in prepare_batch
    ghi_id = batch["ghi"].long()[0].item()
AttributeError: 'list' object has no attribute 'long'
[2023-10-28 18:35:20,314][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:35:20,314][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:38:33,701][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:38:33,701][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:38:33,704][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:38:33,704][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:38:33,761][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:38:33,772][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:38:34,431][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:38:34,431][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:38:34,434][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:38:34,435][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:38:34,435][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:38:34,436][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:38:34,436][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:38:37,238][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:38:37,280][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:38:37,287][__main__][INFO] - Starting training!
[2023-10-28 18:38:48,925][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 139, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 82, in prepare_batch
    ghi_id = batch["ghi"].long()[0].item()
AttributeError: 'list' object has no attribute 'long'
[2023-10-28 18:38:48,928][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:38:48,928][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:41:43,645][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:41:43,645][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:41:43,648][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:41:43,648][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:41:43,705][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:41:43,715][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:41:44,377][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:41:44,378][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:41:44,380][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:41:44,381][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:41:44,381][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:41:44,381][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:41:44,381][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:41:47,224][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:41:47,267][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:41:47,273][__main__][INFO] - Starting training!
[2023-10-28 18:41:58,918][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 138, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 74, in prepare_batch
    print(batch["ghi"].type)
AttributeError: 'list' object has no attribute 'type'
[2023-10-28 18:41:58,921][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:41:58,921][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:47:18,713][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:47:18,713][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:47:18,716][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:47:18,716][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:47:18,778][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:47:18,790][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:47:19,451][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:47:19,451][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:47:19,453][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:47:19,454][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:47:19,454][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:47:19,455][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:47:19,455][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:47:22,206][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:47:22,252][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:47:22,258][__main__][INFO] - Starting training!
[2023-10-28 18:47:33,737][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 138, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 74, in prepare_batch
    print(batch["ghi"].type)
AttributeError: 'list' object has no attribute 'type'
[2023-10-28 18:47:33,740][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:47:33,740][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:52:16,919][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:52:16,919][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:52:16,924][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:52:16,924][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:52:16,979][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:52:16,990][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:52:17,657][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:52:17,658][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:52:17,660][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:52:17,660][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:52:17,661][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:52:17,661][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:52:17,661][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:52:20,809][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:52:20,853][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:52:20,859][__main__][INFO] - Starting training!
[2023-10-28 18:52:33,176][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 137, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 50, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 158, in forward
    dec_out = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 142, in forecast
    seasonal_init, trend_init = self.decomp(x_enc)  # x - moving_avg, moving_avg
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Autoformer_EncDec.py", line 52, in forward
    res = x - moving_mean
RuntimeError: The size of tensor a (48) must match the size of tensor b (47) at non-singleton dimension 1
[2023-10-28 18:52:33,208][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:52:33,208][utiles.utils][INFO] - Closing wandb!
[2023-10-28 18:54:19,966][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 18:54:19,966][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 18:54:19,970][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 18:54:19,970][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 18:54:20,025][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 18:54:20,035][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 18:54:20,688][__main__][INFO] - Instantiating callbacks...
[2023-10-28 18:54:20,688][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 18:54:20,691][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 18:54:20,691][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 18:54:20,691][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 18:54:20,691][__main__][INFO] - Instantiating loggers...
[2023-10-28 18:54:20,692][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 18:54:23,491][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 18:54:23,534][__main__][INFO] - Logging hyperparameters!
[2023-10-28 18:54:23,539][__main__][INFO] - Starting training!
[2023-10-28 18:54:38,140][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 137, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 50, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 158, in forward
    dec_out = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 147, in forecast
    enc_out = self.enc_embedding(x_enc, x_mark_enc)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Embed.py", line 124, in forward
    x = self.value_embedding(
RuntimeError: The size of tensor a (48) must match the size of tensor b (49) at non-singleton dimension 1
[2023-10-28 18:54:38,156][utiles.utils][INFO] - Closing loggers...
[2023-10-28 18:54:38,156][utiles.utils][INFO] - Closing wandb!
[2023-10-28 19:07:37,817][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 19:07:37,817][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 19:07:37,821][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 19:07:37,821][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 19:07:37,877][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 19:07:37,887][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 19:07:38,572][__main__][INFO] - Instantiating callbacks...
[2023-10-28 19:07:38,572][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 19:07:38,574][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 19:07:38,575][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 19:07:38,576][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 19:07:38,576][__main__][INFO] - Instantiating loggers...
[2023-10-28 19:07:38,576][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 19:07:41,365][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 19:07:41,387][__main__][INFO] - Logging hyperparameters!
[2023-10-28 19:07:41,394][__main__][INFO] - Starting training!
[2023-10-28 19:07:55,579][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 137, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 50, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 165, in forward
    dec_out, attns = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 154, in forecast
    enc_out = self.enc_embedding(x_enc, x_mark_enc)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Embed.py", line 124, in forward
    x = self.value_embedding(
RuntimeError: The size of tensor a (48) must match the size of tensor b (49) at non-singleton dimension 1
[2023-10-28 19:07:55,586][utiles.utils][INFO] - Closing loggers...
[2023-10-28 19:07:55,586][utiles.utils][INFO] - Closing wandb!
[2023-10-28 19:12:00,685][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 19:12:00,685][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 19:12:00,689][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 19:12:00,690][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 19:12:00,745][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 19:12:00,755][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 19:12:01,429][__main__][INFO] - Instantiating callbacks...
[2023-10-28 19:12:01,430][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 19:12:01,432][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 19:12:01,432][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 19:12:01,433][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 19:12:01,433][__main__][INFO] - Instantiating loggers...
[2023-10-28 19:12:01,433][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 19:12:04,164][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 19:12:04,186][__main__][INFO] - Logging hyperparameters!
[2023-10-28 19:12:04,193][__main__][INFO] - Starting training!
[2023-10-28 19:12:17,854][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 142, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 55, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 165, in forward
    dec_out, attns = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 154, in forecast
    enc_out = self.enc_embedding(x_enc, x_mark_enc)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Embed.py", line 124, in forward
    x = self.value_embedding(
RuntimeError: The size of tensor a (48) must match the size of tensor b (49) at non-singleton dimension 1
[2023-10-28 19:12:17,861][utiles.utils][INFO] - Closing loggers...
[2023-10-28 19:12:17,861][utiles.utils][INFO] - Closing wandb!
[2023-10-28 19:19:07,468][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 19:19:07,468][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 19:19:07,472][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 19:19:07,472][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 19:19:07,526][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 19:19:07,536][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 19:19:08,228][__main__][INFO] - Instantiating callbacks...
[2023-10-28 19:19:08,228][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 19:19:08,232][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 19:19:08,233][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 19:19:08,233][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 19:19:08,234][__main__][INFO] - Instantiating loggers...
[2023-10-28 19:19:08,234][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 19:19:11,021][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 19:19:11,046][__main__][INFO] - Logging hyperparameters!
[2023-10-28 19:19:11,051][__main__][INFO] - Starting training!
[2023-10-28 19:19:23,167][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 145, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 111, in prepare_batch
    print("ghi_id", ghi_id.shape)
AttributeError: 'int' object has no attribute 'shape'
[2023-10-28 19:19:23,170][utiles.utils][INFO] - Closing loggers...
[2023-10-28 19:19:23,170][utiles.utils][INFO] - Closing wandb!
[2023-10-28 19:21:45,403][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 19:21:45,403][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 19:21:45,407][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 19:21:45,407][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 19:21:45,464][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 19:21:45,475][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 19:21:46,162][__main__][INFO] - Instantiating callbacks...
[2023-10-28 19:21:46,162][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 19:21:46,164][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 19:21:46,165][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 19:21:46,166][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 19:21:46,166][__main__][INFO] - Instantiating loggers...
[2023-10-28 19:21:46,166][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 19:21:48,875][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 19:21:48,899][__main__][INFO] - Logging hyperparameters!
[2023-10-28 19:21:48,905][__main__][INFO] - Starting training!
[2023-10-28 19:22:00,862][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 145, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 111, in prepare_batch
    print("ghi_id", ghi_id.shape)
AttributeError: 'int' object has no attribute 'shape'
[2023-10-28 19:22:00,864][utiles.utils][INFO] - Closing loggers...
[2023-10-28 19:22:00,864][utiles.utils][INFO] - Closing wandb!
[2023-10-28 19:25:01,105][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 19:25:01,105][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 19:25:01,108][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 19:25:01,109][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 19:25:01,161][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 19:25:01,173][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 19:25:01,805][__main__][INFO] - Instantiating callbacks...
[2023-10-28 19:25:01,805][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 19:25:01,808][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 19:25:01,808][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 19:25:01,809][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 19:25:01,809][__main__][INFO] - Instantiating loggers...
[2023-10-28 19:25:01,809][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 19:25:04,545][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 19:25:04,567][__main__][INFO] - Logging hyperparameters!
[2023-10-28 19:25:04,572][__main__][INFO] - Starting training!
[2023-10-28 19:25:15,484][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 145, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 111, in prepare_batch
    print("ghi_id", ghi_id.shape)
AttributeError: 'int' object has no attribute 'shape'
[2023-10-28 19:25:15,486][utiles.utils][INFO] - Closing loggers...
[2023-10-28 19:25:15,487][utiles.utils][INFO] - Closing wandb!
[2023-10-28 19:27:30,134][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 19:27:30,134][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 19:27:30,138][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 19:27:30,138][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 19:27:30,195][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 19:27:30,204][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 19:27:30,827][__main__][INFO] - Instantiating callbacks...
[2023-10-28 19:27:30,828][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 19:27:30,830][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 19:27:30,831][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 19:27:30,831][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 19:27:30,831][__main__][INFO] - Instantiating loggers...
[2023-10-28 19:27:30,831][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 19:27:33,549][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 19:27:33,573][__main__][INFO] - Logging hyperparameters!
[2023-10-28 19:27:33,578][__main__][INFO] - Starting training!
[2023-10-28 19:27:44,456][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 145, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 111, in prepare_batch
    print("ghi_id", ghi_id.shape)
AttributeError: 'int' object has no attribute 'shape'
[2023-10-28 19:27:44,458][utiles.utils][INFO] - Closing loggers...
[2023-10-28 19:27:44,459][utiles.utils][INFO] - Closing wandb!
[2023-10-28 19:30:27,562][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 19:30:27,563][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 19:30:27,566][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 19:30:27,566][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 19:30:27,623][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 19:30:27,635][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 19:30:28,266][__main__][INFO] - Instantiating callbacks...
[2023-10-28 19:30:28,267][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 19:30:28,269][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 19:30:28,269][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 19:30:28,270][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 19:30:28,270][__main__][INFO] - Instantiating loggers...
[2023-10-28 19:30:28,270][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 19:30:31,091][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 19:30:31,114][__main__][INFO] - Logging hyperparameters!
[2023-10-28 19:30:31,120][__main__][INFO] - Starting training!
[2023-10-28 19:30:41,756][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 145, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 111, in prepare_batch
    print("ghi_id", ghi_id.shape)
AttributeError: 'int' object has no attribute 'shape'
[2023-10-28 19:30:41,758][utiles.utils][INFO] - Closing loggers...
[2023-10-28 19:30:41,759][utiles.utils][INFO] - Closing wandb!
[2023-10-28 19:31:25,305][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 19:31:25,305][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 19:31:25,308][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 19:31:25,308][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 19:31:25,360][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 19:31:25,371][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 19:31:25,992][__main__][INFO] - Instantiating callbacks...
[2023-10-28 19:31:25,993][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 19:31:25,995][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 19:31:25,995][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 19:31:25,996][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 19:31:25,996][__main__][INFO] - Instantiating loggers...
[2023-10-28 19:31:25,996][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 19:31:28,797][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 19:31:28,819][__main__][INFO] - Logging hyperparameters!
[2023-10-28 19:31:28,826][__main__][INFO] - Starting training!
[2023-10-28 19:31:41,543][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 144, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 55, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 165, in forward
    dec_out, attns = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 157, in forecast
    dec_out = self.dec_embedding(seasonal_init, x_mark_dec)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Embed.py", line 124, in forward
    x = self.value_embedding(
RuntimeError: The size of tensor a (72) must match the size of tensor b (96) at non-singleton dimension 1
[2023-10-28 19:31:41,550][utiles.utils][INFO] - Closing loggers...
[2023-10-28 19:31:41,550][utiles.utils][INFO] - Closing wandb!
[2023-10-28 23:16:12,639][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 23:16:12,639][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 23:16:12,642][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 23:16:12,642][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 23:16:12,694][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 23:16:12,703][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 23:16:13,561][__main__][INFO] - Instantiating callbacks...
[2023-10-28 23:16:13,562][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 23:16:13,564][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 23:16:13,565][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 23:16:13,565][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 23:16:13,565][__main__][INFO] - Instantiating loggers...
[2023-10-28 23:16:13,565][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 23:16:16,388][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 23:16:16,411][__main__][INFO] - Logging hyperparameters!
[2023-10-28 23:16:16,417][__main__][INFO] - Starting training!
[2023-10-28 23:16:29,562][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 148, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 55, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 165, in forward
    dec_out, attns = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 157, in forecast
    dec_out = self.dec_embedding(seasonal_init, x_mark_dec)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Embed.py", line 124, in forward
    x = self.value_embedding(
RuntimeError: The size of tensor a (72) must match the size of tensor b (96) at non-singleton dimension 1
[2023-10-28 23:16:29,640][utiles.utils][INFO] - Closing loggers...
[2023-10-28 23:16:29,640][utiles.utils][INFO] - Closing wandb!
[2023-10-28 23:20:05,344][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 23:20:05,344][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 23:20:05,348][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 23:20:05,348][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 23:20:05,405][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 23:20:05,415][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 23:20:06,063][__main__][INFO] - Instantiating callbacks...
[2023-10-28 23:20:06,063][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 23:20:06,065][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 23:20:06,066][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 23:20:06,066][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 23:20:06,067][__main__][INFO] - Instantiating loggers...
[2023-10-28 23:20:06,067][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 23:20:08,890][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 23:20:08,915][__main__][INFO] - Logging hyperparameters!
[2023-10-28 23:20:08,928][__main__][INFO] - Starting training!
[2023-10-28 23:20:21,974][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 148, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 55, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 165, in forward
    dec_out, attns = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 157, in forecast
    dec_out = self.dec_embedding(seasonal_init, x_mark_dec)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Embed.py", line 124, in forward
    x = self.value_embedding(
RuntimeError: The size of tensor a (72) must match the size of tensor b (96) at non-singleton dimension 1
[2023-10-28 23:20:21,980][utiles.utils][INFO] - Closing loggers...
[2023-10-28 23:20:21,980][utiles.utils][INFO] - Closing wandb!
[2023-10-28 23:26:01,227][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 23:26:01,227][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 23:26:01,231][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 23:26:01,231][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 23:26:01,290][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 23:26:01,300][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 23:26:01,946][__main__][INFO] - Instantiating callbacks...
[2023-10-28 23:26:01,946][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 23:26:01,948][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 23:26:01,949][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 23:26:01,949][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 23:26:01,949][__main__][INFO] - Instantiating loggers...
[2023-10-28 23:26:01,949][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 23:26:04,797][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 23:26:04,819][__main__][INFO] - Logging hyperparameters!
[2023-10-28 23:26:04,825][__main__][INFO] - Starting training!
[2023-10-28 23:26:53,506][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-28 23:26:53,506][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-28 23:26:53,510][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-28 23:26:53,510][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-28 23:26:53,565][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-28 23:26:53,574][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-28 23:26:54,232][__main__][INFO] - Instantiating callbacks...
[2023-10-28 23:26:54,233][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-28 23:26:54,235][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-28 23:26:54,236][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-28 23:26:54,236][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-28 23:26:54,236][__main__][INFO] - Instantiating loggers...
[2023-10-28 23:26:54,236][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-28 23:26:57,052][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-28 23:26:57,078][__main__][INFO] - Logging hyperparameters!
[2023-10-28 23:26:57,085][__main__][INFO] - Starting training!
[2023-10-28 23:28:34,977][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=000.ckpt
[2023-10-28 23:28:34,978][__main__][INFO] - Starting testing!
[2023-10-28 23:28:35,095][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-10-28 23:28:35,105][utiles.utils][INFO] - Closing loggers...
[2023-10-28 23:28:35,105][utiles.utils][INFO] - Closing wandb!
[2023-10-29 10:57:30,985][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 10:57:30,985][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 10:57:30,988][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 10:57:30,989][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 10:57:31,088][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 10:57:31,097][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 10:57:31,999][__main__][INFO] - Instantiating callbacks...
[2023-10-29 10:57:31,999][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 10:57:32,001][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 10:57:32,002][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 10:57:32,003][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 10:57:32,003][__main__][INFO] - Instantiating loggers...
[2023-10-29 10:57:32,003][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 10:57:34,914][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 10:57:34,938][__main__][INFO] - Logging hyperparameters!
[2023-10-29 10:57:34,944][__main__][INFO] - Starting training!
[2023-10-29 10:57:35,120][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 36, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\launchers\subprocess_script.py", line 90, in launch
    return function(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1034, in _run
    self.strategy.setup_environment()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\ddp.py", line 153, in setup_environment
    self.setup_distributed()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\ddp.py", line 204, in setup_distributed
    _init_dist_connection(self.cluster_environment, self._process_group_backend, timeout=self._timeout)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\lightning_lite\utilities\distributed.py", line 237, in _init_dist_connection
    torch.distributed.init_process_group(torch_distributed_backend, rank=global_rank, world_size=world_size, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\distributed\distributed_c10d.py", line 761, in init_process_group
    default_pg = _new_process_group_helper(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\distributed\distributed_c10d.py", line 886, in _new_process_group_helper
    raise RuntimeError("Distributed package doesn't have NCCL " "built in")
RuntimeError: Distributed package doesn't have NCCL built in
[2023-10-29 10:57:35,139][utiles.utils][INFO] - Closing loggers...
[2023-10-29 10:57:35,139][utiles.utils][INFO] - Closing wandb!
[2023-10-29 11:04:16,122][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 11:04:16,122][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 11:04:16,125][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 11:04:16,125][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 11:04:16,183][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 11:04:16,191][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 11:04:16,855][__main__][INFO] - Instantiating callbacks...
[2023-10-29 11:04:16,855][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 11:04:16,857][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 11:04:16,858][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 11:04:16,859][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 11:04:16,859][__main__][INFO] - Instantiating loggers...
[2023-10-29 11:04:16,859][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 11:04:19,643][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 11:04:19,668][__main__][INFO] - Logging hyperparameters!
[2023-10-29 11:04:19,674][__main__][INFO] - Starting training!
[2023-10-29 11:04:19,815][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 36, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\launchers\subprocess_script.py", line 90, in launch
    return function(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1034, in _run
    self.strategy.setup_environment()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\ddp.py", line 153, in setup_environment
    self.setup_distributed()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\ddp.py", line 204, in setup_distributed
    _init_dist_connection(self.cluster_environment, self._process_group_backend, timeout=self._timeout)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\lightning_lite\utilities\distributed.py", line 237, in _init_dist_connection
    torch.distributed.init_process_group(torch_distributed_backend, rank=global_rank, world_size=world_size, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\distributed\distributed_c10d.py", line 761, in init_process_group
    default_pg = _new_process_group_helper(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\distributed\distributed_c10d.py", line 886, in _new_process_group_helper
    raise RuntimeError("Distributed package doesn't have NCCL " "built in")
RuntimeError: Distributed package doesn't have NCCL built in
[2023-10-29 11:04:19,817][utiles.utils][INFO] - Closing loggers...
[2023-10-29 11:04:19,817][utiles.utils][INFO] - Closing wandb!
[2023-10-29 11:05:03,131][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 11:05:03,131][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 11:05:03,135][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 11:05:03,136][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 11:05:03,193][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 11:05:03,202][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 11:05:03,904][__main__][INFO] - Instantiating callbacks...
[2023-10-29 11:05:03,904][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 11:05:03,906][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 11:05:03,907][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 11:05:03,907][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 11:05:03,907][__main__][INFO] - Instantiating loggers...
[2023-10-29 11:05:03,907][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 11:05:06,665][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 11:05:06,689][__main__][INFO] - Logging hyperparameters!
[2023-10-29 11:05:06,695][__main__][INFO] - Starting training!
[2023-10-29 11:05:20,151][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 147, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 58, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 165, in forward
    dec_out, attns = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 149, in forecast
    seasonal_init, trend_init = self.decomp(x_enc)  # x - moving_avg, moving_avg
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Autoformer_EncDec.py", line 52, in forward
    res = x - moving_mean
RuntimeError: The size of tensor a (48) must match the size of tensor b (47) at non-singleton dimension 1
[2023-10-29 11:05:20,246][utiles.utils][INFO] - Closing loggers...
[2023-10-29 11:05:20,246][utiles.utils][INFO] - Closing wandb!
[2023-10-29 11:06:20,495][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 11:06:20,495][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 11:06:20,499][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 11:06:20,499][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 11:06:20,555][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 11:06:20,565][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 11:06:21,227][__main__][INFO] - Instantiating callbacks...
[2023-10-29 11:06:21,228][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 11:06:21,230][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 11:06:21,230][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 11:06:21,231][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 11:06:21,231][__main__][INFO] - Instantiating loggers...
[2023-10-29 11:06:21,231][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 11:06:24,062][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 11:06:24,087][__main__][INFO] - Logging hyperparameters!
[2023-10-29 11:06:24,094][__main__][INFO] - Starting training!
[2023-10-29 11:10:05,365][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000.ckpt
[2023-10-29 11:10:05,366][__main__][INFO] - Starting testing!
[2023-10-29 11:10:15,211][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 177, in test_step
    self.test_loss(loss)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1269, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'TSForecastTask' object has no attribute 'test_loss'
[2023-10-29 11:10:15,215][utiles.utils][INFO] - Closing loggers...
[2023-10-29 11:10:15,215][utiles.utils][INFO] - Closing wandb!
[2023-10-29 11:11:49,057][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 11:11:49,057][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 11:11:49,060][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 11:11:49,060][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 11:11:49,109][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 11:11:49,118][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 11:11:49,741][__main__][INFO] - Instantiating callbacks...
[2023-10-29 11:11:49,742][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 11:11:49,744][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 11:11:49,744][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 11:11:49,745][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 11:11:49,745][__main__][INFO] - Instantiating loggers...
[2023-10-29 11:11:49,745][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 11:11:52,455][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 11:11:52,479][__main__][INFO] - Logging hyperparameters!
[2023-10-29 11:11:52,484][__main__][INFO] - Starting training!
[2023-10-29 11:15:26,870][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v1.ckpt
[2023-10-29 11:15:26,871][__main__][INFO] - Starting testing!
[2023-10-29 11:15:36,083][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 180, in test_step
    for key in self.hparams.metrics.test:
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\dictconfig.py", line 355, in __getattr__
    self._format_and_raise(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\base.py", line 231, in _format_and_raise
    format_and_raise(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\_utils.py", line 899, in format_and_raise
    _raise(ex, cause)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\_utils.py", line 797, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set env var OC_CAUSE=1 for full trace
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\dictconfig.py", line 351, in __getattr__
    return self._get_impl(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\dictconfig.py", line 442, in _get_impl
    node = self._get_child(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\basecontainer.py", line 73, in _get_child
    child = self._get_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\dictconfig.py", line 480, in _get_node
    raise ConfigKeyError(f"Missing key {key!s}")
omegaconf.errors.ConfigAttributeError: Missing key test
    full_key: test
    object_type=dict
[2023-10-29 11:15:36,119][utiles.utils][INFO] - Closing loggers...
[2023-10-29 11:15:36,119][utiles.utils][INFO] - Closing wandb!
[2023-10-29 11:26:20,745][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 11:26:20,745][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 11:26:20,749][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 11:26:20,749][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 11:26:20,800][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 11:26:20,810][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 11:26:21,460][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 40, in __init__
    self._set_metrics()
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 47, in _set_metrics
    for k in self.hparams.metrics.test:
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\dictconfig.py", line 355, in __getattr__
    self._format_and_raise(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\base.py", line 231, in _format_and_raise
    format_and_raise(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\_utils.py", line 899, in format_and_raise
    _raise(ex, cause)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\_utils.py", line 797, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set env var OC_CAUSE=1 for full trace
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\dictconfig.py", line 351, in __getattr__
    return self._get_impl(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\dictconfig.py", line 442, in _get_impl
    node = self._get_child(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\basecontainer.py", line 73, in _get_child
    child = self._get_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\omegaconf\dictconfig.py", line 480, in _get_node
    raise ConfigKeyError(f"Missing key {key!s}")
omegaconf.errors.ConfigAttributeError: Missing key test
    full_key: test
    object_type=dict

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'pl_models.pl_baselines.TSForecastTask':
ConfigAttributeError('Missing key test\n    full_key: test\n    object_type=dict')
full_key: pl_module
[2023-10-29 11:26:21,471][utiles.utils][INFO] - Closing loggers...
[2023-10-29 11:31:44,817][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 11:31:44,817][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 11:31:44,820][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 11:31:44,821][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 11:31:44,876][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 11:31:44,886][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 11:31:45,507][__main__][INFO] - Instantiating callbacks...
[2023-10-29 11:31:45,507][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 11:31:45,509][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 11:31:45,509][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 11:31:45,510][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-10-29 11:31:45,510][__main__][INFO] - Instantiating loggers...
[2023-10-29 11:31:45,511][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 11:31:48,240][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 11:31:48,262][__main__][INFO] - Logging hyperparameters!
[2023-10-29 11:31:48,267][__main__][INFO] - Starting training!
[2023-10-29 11:33:24,422][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v2.ckpt
[2023-10-29 11:33:24,424][utiles.utils][INFO] - Closing loggers...
[2023-10-29 11:33:24,424][utiles.utils][INFO] - Closing wandb!
[2023-10-29 11:33:31,208][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty
[2023-10-29 11:33:31,208][utiles.utils][INFO] - Retrieved metric value! <val/mae=485.7510070800781>
[2023-10-29 11:40:23,521][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 11:40:23,521][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 11:40:23,525][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 11:40:23,525][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 11:40:23,581][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 11:40:23,590][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 11:40:24,274][__main__][INFO] - Instantiating callbacks...
[2023-10-29 11:40:24,274][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 11:40:24,275][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 11:40:24,276][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 11:40:24,276][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 11:40:24,277][__main__][INFO] - Instantiating loggers...
[2023-10-29 11:40:24,277][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 11:40:27,095][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 11:40:27,118][__main__][INFO] - Logging hyperparameters!
[2023-10-29 11:40:27,124][__main__][INFO] - Starting training!
[2023-10-29 11:42:45,680][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v3.ckpt
[2023-10-29 11:42:45,680][__main__][INFO] - Starting testing!
[2023-10-29 11:42:55,380][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v3.ckpt
[2023-10-29 11:42:55,381][utiles.utils][INFO] - Closing loggers...
[2023-10-29 11:42:55,382][utiles.utils][INFO] - Closing wandb!
[2023-10-29 11:43:04,012][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty
[2023-10-29 11:43:04,012][utiles.utils][INFO] - Retrieved metric value! <val/mae=966.2935180664062>
[2023-10-29 12:50:08,765][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 12:50:08,765][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 12:50:08,768][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 12:50:08,768][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 12:50:08,829][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 12:50:08,839][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 12:50:09,494][__main__][INFO] - Instantiating callbacks...
[2023-10-29 12:50:09,494][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 12:50:09,496][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 12:50:09,497][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 12:50:09,497][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 12:50:09,498][__main__][INFO] - Instantiating loggers...
[2023-10-29 12:50:09,498][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 12:50:12,244][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 12:50:12,269][__main__][INFO] - Logging hyperparameters!
[2023-10-29 12:50:12,273][__main__][INFO] - Starting training!
[2023-10-29 12:52:25,330][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v4.ckpt
[2023-10-29 12:52:25,331][__main__][INFO] - Starting testing!
[2023-10-29 12:52:34,623][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v4.ckpt
[2023-10-29 12:52:34,624][utiles.utils][INFO] - Closing loggers...
[2023-10-29 12:52:34,624][utiles.utils][INFO] - Closing wandb!
[2023-10-29 12:52:41,361][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty
[2023-10-29 12:52:41,362][utiles.utils][INFO] - Retrieved metric value! <val/mae=643.923583984375>
[2023-10-29 12:57:17,452][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 12:57:17,453][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 12:57:17,455][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 12:57:17,455][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 12:57:17,515][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 12:57:17,524][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 12:57:18,211][__main__][INFO] - Instantiating callbacks...
[2023-10-29 12:57:18,211][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 12:57:18,213][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 12:57:18,214][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 12:57:18,215][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 12:57:18,215][__main__][INFO] - Instantiating loggers...
[2023-10-29 12:57:18,215][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 12:57:20,989][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 12:57:21,013][__main__][INFO] - Logging hyperparameters!
[2023-10-29 12:57:21,019][__main__][INFO] - Starting training!
[2023-10-29 12:59:38,426][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v5.ckpt
[2023-10-29 12:59:38,427][__main__][INFO] - Starting testing!
[2023-10-29 12:59:48,332][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 197, in test_step
    print(" batch_y", batch_y.sahpe)
AttributeError: 'numpy.ndarray' object has no attribute 'sahpe'
[2023-10-29 12:59:48,336][utiles.utils][INFO] - Closing loggers...
[2023-10-29 12:59:48,336][utiles.utils][INFO] - Closing wandb!
[2023-10-29 13:05:50,930][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 13:05:50,930][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 13:05:50,940][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 13:05:50,940][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 13:05:51,138][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 13:05:51,169][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 13:05:52,238][__main__][INFO] - Instantiating callbacks...
[2023-10-29 13:05:52,238][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 13:05:52,243][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 13:05:52,246][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 13:05:52,247][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 13:05:52,248][__main__][INFO] - Instantiating loggers...
[2023-10-29 13:05:52,248][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 13:05:55,802][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 13:05:55,852][__main__][INFO] - Logging hyperparameters!
[2023-10-29 13:05:55,870][__main__][INFO] - Starting training!
[2023-10-29 13:07:26,252][__main__][INFO] - Best model ckpt at 
[2023-10-29 13:07:26,253][__main__][INFO] - Starting testing!
[2023-10-29 13:07:26,253][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-29 13:07:43,078][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 194, in run
    self.on_run_start(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 197, in test_step
    print(" batch_y", batch_y.sahpe)
AttributeError: 'numpy.ndarray' object has no attribute 'sahpe'
[2023-10-29 13:07:43,081][utiles.utils][INFO] - Closing loggers...
[2023-10-29 13:07:43,081][utiles.utils][INFO] - Closing wandb!
[2023-10-29 13:08:07,316][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 13:08:07,316][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 13:08:07,327][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 13:08:07,327][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 13:08:07,520][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 13:08:07,551][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 13:08:08,622][__main__][INFO] - Instantiating callbacks...
[2023-10-29 13:08:08,622][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 13:08:08,629][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 13:08:08,631][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 13:08:08,632][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 13:08:08,633][__main__][INFO] - Instantiating loggers...
[2023-10-29 13:08:08,633][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 13:08:12,275][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 13:08:12,323][__main__][INFO] - Logging hyperparameters!
[2023-10-29 13:08:12,342][__main__][INFO] - Starting training!
[2023-10-29 13:08:29,555][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 150, in validation_step
    batch_x, batch_y, batch_x_mark, batch_y_mark, ghi_id = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 92, in prepare_batch
    print(ghi_id.shape)
AttributeError: 'int' object has no attribute 'shape'
[2023-10-29 13:08:29,559][utiles.utils][INFO] - Closing loggers...
[2023-10-29 13:08:29,559][utiles.utils][INFO] - Closing wandb!
[2023-10-29 13:09:05,836][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 13:09:05,836][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 13:09:05,847][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 13:09:05,847][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 13:09:06,040][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 13:09:06,069][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 13:09:07,128][__main__][INFO] - Instantiating callbacks...
[2023-10-29 13:09:07,129][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 13:09:07,134][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 13:09:07,137][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 13:09:07,138][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 13:09:07,139][__main__][INFO] - Instantiating loggers...
[2023-10-29 13:09:07,139][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 13:09:10,497][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 13:09:10,546][__main__][INFO] - Logging hyperparameters!
[2023-10-29 13:09:10,563][__main__][INFO] - Starting training!
[2023-10-29 13:14:10,339][__main__][INFO] - Best model ckpt at 
[2023-10-29 13:14:10,339][__main__][INFO] - Starting testing!
[2023-10-29 13:14:10,339][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-29 13:14:25,799][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 194, in run
    self.on_run_start(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 197, in test_step
    print(" batch_y", batch_y.sahpe)
AttributeError: 'numpy.ndarray' object has no attribute 'sahpe'
[2023-10-29 13:14:25,802][utiles.utils][INFO] - Closing loggers...
[2023-10-29 13:14:25,802][utiles.utils][INFO] - Closing wandb!
[2023-10-29 13:15:24,664][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 13:15:24,664][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 13:15:24,674][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 13:15:24,674][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 13:15:24,868][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 13:15:24,897][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 13:15:25,949][__main__][INFO] - Instantiating callbacks...
[2023-10-29 13:15:25,949][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 13:15:25,955][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 13:15:25,957][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 13:15:25,958][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 13:15:25,959][__main__][INFO] - Instantiating loggers...
[2023-10-29 13:15:25,959][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 13:15:29,554][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 13:15:29,604][__main__][INFO] - Logging hyperparameters!
[2023-10-29 13:15:29,624][__main__][INFO] - Starting training!
[2023-10-29 13:17:08,687][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 13:17:08,687][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 13:17:08,698][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 13:17:08,699][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 13:17:08,894][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 13:17:08,927][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 13:17:09,971][__main__][INFO] - Instantiating callbacks...
[2023-10-29 13:17:09,972][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 13:17:09,978][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 13:17:09,980][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 13:17:09,981][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 13:17:09,982][__main__][INFO] - Instantiating loggers...
[2023-10-29 13:17:09,982][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 13:17:13,339][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 13:17:13,387][__main__][INFO] - Logging hyperparameters!
[2023-10-29 13:17:13,407][__main__][INFO] - Starting training!
[2023-10-29 13:23:31,312][__main__][INFO] - Best model ckpt at 
[2023-10-29 13:23:31,312][__main__][INFO] - Starting testing!
[2023-10-29 13:23:31,312][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-29 13:23:44,614][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 13:23:44,614][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 13:23:44,624][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 13:23:44,624][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 13:23:44,828][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 13:23:44,858][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 13:23:45,966][__main__][INFO] - Instantiating callbacks...
[2023-10-29 13:23:45,967][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 13:23:45,972][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 13:23:45,974][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 13:23:45,975][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 13:23:45,976][__main__][INFO] - Instantiating loggers...
[2023-10-29 13:23:45,976][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 13:23:49,631][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 13:23:49,679][__main__][INFO] - Logging hyperparameters!
[2023-10-29 13:23:49,698][__main__][INFO] - Starting training!
[2023-10-29 13:26:00,358][__main__][INFO] - Best model ckpt at 
[2023-10-29 13:26:00,358][__main__][INFO] - Starting testing!
[2023-10-29 13:26:00,358][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-29 13:28:35,957][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 13:28:35,958][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 13:28:35,969][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 13:28:35,969][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 13:28:36,164][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 13:28:36,193][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 13:28:37,252][__main__][INFO] - Instantiating callbacks...
[2023-10-29 13:28:37,252][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 13:28:37,258][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 13:28:37,260][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 13:28:37,261][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 13:28:37,262][__main__][INFO] - Instantiating loggers...
[2023-10-29 13:28:37,262][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 13:28:40,816][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 13:28:40,866][__main__][INFO] - Logging hyperparameters!
[2023-10-29 13:28:40,885][__main__][INFO] - Starting training!
[2023-10-29 13:37:32,728][__main__][INFO] - Best model ckpt at 
[2023-10-29 13:37:32,729][__main__][INFO] - Starting testing!
[2023-10-29 13:37:32,729][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-29 13:37:40,731][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 13:37:40,731][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 13:37:40,735][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 13:37:40,735][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 13:37:40,788][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 13:37:40,799][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 13:37:41,431][__main__][INFO] - Instantiating callbacks...
[2023-10-29 13:37:41,431][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 13:37:41,434][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 13:37:41,434][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 13:37:41,434][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 13:37:41,434][__main__][INFO] - Instantiating loggers...
[2023-10-29 13:37:41,434][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 13:37:44,227][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 13:37:44,250][__main__][INFO] - Logging hyperparameters!
[2023-10-29 13:37:44,255][__main__][INFO] - Starting training!
[2023-10-29 13:37:57,704][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 157, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 63, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 165, in forward
    dec_out, attns = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 155, in forecast
    enc_out, attns = self.encoder(enc_out, attn_mask=None)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Autoformer_EncDec.py", line 131, in forward
    x, attn = attn_layer(x, attn_mask=attn_mask)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Autoformer_EncDec.py", line 96, in forward
    new_x, attn = self.attention(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\AutoCorrelation.py", line 155, in forward
    out, attn = self.inner_correlation(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FourierCorrelation.py", line 69, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d("bhi,hio->bho", x_ft[:, :, :, i],
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FourierCorrelation.py", line 53, in compl_mul1d
    return torch.complex(torch.einsum(order, x.real, weights.real) - torch.einsum(order, x.imag, weights.imag),
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
RuntimeError: einsum(): subscript h has size 8 for operand 1 which does not broadcast with previously seen size 4
[2023-10-29 13:37:57,725][utiles.utils][INFO] - Closing loggers...
[2023-10-29 13:37:57,725][utiles.utils][INFO] - Closing wandb!
[2023-10-29 13:38:55,838][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 13:38:55,838][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 13:38:55,842][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 13:38:55,842][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 13:38:55,898][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 13:38:55,908][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 13:38:56,545][__main__][INFO] - Instantiating callbacks...
[2023-10-29 13:38:56,545][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 13:38:56,547][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 13:38:56,548][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 13:38:56,548][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 13:38:56,549][__main__][INFO] - Instantiating loggers...
[2023-10-29 13:38:56,549][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 13:38:59,357][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 13:38:59,380][__main__][INFO] - Logging hyperparameters!
[2023-10-29 13:38:59,385][__main__][INFO] - Starting training!
[2023-10-29 13:41:27,852][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v6.ckpt
[2023-10-29 13:41:27,853][__main__][INFO] - Starting testing!
[2023-10-29 13:41:38,298][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 92, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 203, in test_step
    print(" batch_y", batch_y.sahpe)
AttributeError: 'numpy.ndarray' object has no attribute 'sahpe'
[2023-10-29 13:41:38,302][utiles.utils][INFO] - Closing loggers...
[2023-10-29 13:41:38,302][utiles.utils][INFO] - Closing wandb!
[2023-10-29 13:43:38,613][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 13:43:38,614][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 13:43:38,618][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 13:43:38,618][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 13:43:38,678][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 13:43:38,688][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 13:43:39,438][__main__][INFO] - Instantiating callbacks...
[2023-10-29 13:43:39,438][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 13:43:39,440][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 13:43:39,441][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 13:43:39,441][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 13:43:39,442][__main__][INFO] - Instantiating loggers...
[2023-10-29 13:43:39,442][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 13:43:42,626][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 13:43:42,652][__main__][INFO] - Logging hyperparameters!
[2023-10-29 13:43:42,659][__main__][INFO] - Starting training!
[2023-10-29 13:46:19,272][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v7.ckpt
[2023-10-29 13:46:19,272][__main__][INFO] - Starting testing!
[2023-10-29 13:46:30,351][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v7.ckpt
[2023-10-29 13:46:30,354][utiles.utils][INFO] - Closing loggers...
[2023-10-29 13:46:30,354][utiles.utils][INFO] - Closing wandb!
[2023-10-29 13:46:38,075][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty
[2023-10-29 13:46:38,075][utiles.utils][INFO] - Retrieved metric value! <val/mae=441.3849182128906>
[2023-10-29 13:59:17,770][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 13:59:17,770][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 13:59:17,774][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 13:59:17,774][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 13:59:17,834][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 13:59:17,845][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 13:59:18,611][__main__][INFO] - Instantiating callbacks...
[2023-10-29 13:59:18,611][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 13:59:18,614][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 13:59:18,616][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 13:59:18,616][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 13:59:18,616][__main__][INFO] - Instantiating loggers...
[2023-10-29 13:59:18,616][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 13:59:21,470][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 13:59:21,497][__main__][INFO] - Logging hyperparameters!
[2023-10-29 13:59:21,502][__main__][INFO] - Starting training!
[2023-10-29 14:01:05,896][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 14:01:05,896][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 14:01:05,899][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 14:01:05,900][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 14:01:05,962][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 14:01:05,974][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 14:01:06,740][__main__][INFO] - Instantiating callbacks...
[2023-10-29 14:01:06,741][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 14:01:06,744][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 14:01:06,744][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 14:01:06,745][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 14:01:06,745][__main__][INFO] - Instantiating loggers...
[2023-10-29 14:01:06,745][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 14:01:09,578][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 14:01:09,604][__main__][INFO] - Logging hyperparameters!
[2023-10-29 14:01:09,611][__main__][INFO] - Starting training!
[2023-10-29 14:16:48,011][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 14:16:48,012][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 14:16:48,015][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 14:16:48,016][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 14:16:48,074][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 14:16:48,088][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 14:16:48,788][__main__][INFO] - Instantiating callbacks...
[2023-10-29 14:16:48,788][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 14:16:48,791][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 14:16:48,791][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 14:16:48,792][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 14:16:48,792][__main__][INFO] - Instantiating loggers...
[2023-10-29 14:16:48,792][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 14:16:51,655][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 14:16:51,680][__main__][INFO] - Logging hyperparameters!
[2023-10-29 14:16:51,686][__main__][INFO] - Starting training!
[2023-10-29 14:17:03,724][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 81, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 212, in __getitem__
    print("ghi_channel_id shape:", return_tensors["ghi"].shape)
AttributeError: 'int' object has no attribute 'shape'

[2023-10-29 14:17:03,770][utiles.utils][INFO] - Closing loggers...
[2023-10-29 14:17:03,770][utiles.utils][INFO] - Closing wandb!
[2023-10-29 14:28:24,660][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 14:28:24,661][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 14:28:24,664][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 14:28:24,664][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 14:28:24,725][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 14:28:24,743][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 45, in train
    datamodule.print_train_data_size()
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_module.py", line 68, in print_train_data_size
    print("Size of training dataset:", len(self.data_train))
TypeError: object of type 'NoneType' has no len()
[2023-10-29 14:28:24,745][utiles.utils][INFO] - Closing loggers...
[2023-10-29 14:32:29,533][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 14:32:29,533][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 14:32:29,537][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 14:32:29,538][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 14:32:29,600][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 14:32:30,933][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 14:32:31,668][__main__][INFO] - Instantiating callbacks...
[2023-10-29 14:32:31,668][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 14:32:31,670][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 14:32:31,671][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 14:32:31,672][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 14:32:31,672][__main__][INFO] - Instantiating loggers...
[2023-10-29 14:32:31,672][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 14:32:34,518][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 14:32:34,545][__main__][INFO] - Logging hyperparameters!
[2023-10-29 14:32:34,551][__main__][INFO] - Starting training!
[2023-10-29 14:35:15,376][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v10.ckpt
[2023-10-29 14:35:15,377][__main__][INFO] - Starting testing!
[2023-10-29 14:35:26,808][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v10.ckpt
[2023-10-29 14:35:26,810][utiles.utils][INFO] - Closing loggers...
[2023-10-29 14:35:26,810][utiles.utils][INFO] - Closing wandb!
[2023-10-29 14:35:35,040][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty
[2023-10-29 14:35:35,040][utiles.utils][INFO] - Retrieved metric value! <val/mae=403.5111083984375>
[2023-10-29 14:38:02,379][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 14:38:02,379][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 14:38:02,384][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 14:38:02,384][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 14:38:02,450][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 14:38:04,077][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 14:38:04,835][__main__][INFO] - Instantiating callbacks...
[2023-10-29 14:38:04,835][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 14:38:04,837][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 14:38:04,839][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 14:38:04,840][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 14:38:04,840][__main__][INFO] - Instantiating loggers...
[2023-10-29 14:38:04,840][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 14:38:07,623][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 14:38:07,659][__main__][INFO] - Logging hyperparameters!
[2023-10-29 14:38:07,666][__main__][INFO] - Starting training!
[2023-10-29 14:40:46,925][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v11.ckpt
[2023-10-29 14:40:46,926][__main__][INFO] - Starting testing!
[2023-10-29 14:40:58,382][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v11.ckpt
[2023-10-29 14:40:58,385][utiles.utils][INFO] - Closing loggers...
[2023-10-29 14:40:58,385][utiles.utils][INFO] - Closing wandb!
[2023-10-29 14:41:05,483][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty
[2023-10-29 14:41:05,483][utiles.utils][INFO] - Retrieved metric value! <val/mae=571.0995483398438>
[2023-10-29 15:27:51,835][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 15:27:51,836][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 15:27:51,845][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 15:27:51,846][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 15:27:51,907][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 15:27:51,928][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 15:27:52,628][__main__][INFO] - Instantiating callbacks...
[2023-10-29 15:27:52,628][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 15:27:52,630][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 15:27:52,631][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 15:27:52,631][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 15:27:52,631][__main__][INFO] - Instantiating loggers...
[2023-10-29 15:27:52,632][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 15:27:55,495][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 15:27:55,520][__main__][INFO] - Logging hyperparameters!
[2023-10-29 15:27:55,525][__main__][INFO] - Starting training!
[2023-10-29 15:28:07,870][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 162, in __getitem__
    x_begin_index = int(step_idx[0])
IndexError: invalid index to scalar variable.

[2023-10-29 15:28:07,873][utiles.utils][INFO] - Closing loggers...
[2023-10-29 15:28:07,874][utiles.utils][INFO] - Closing wandb!
[2023-10-29 15:29:36,409][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 15:29:36,409][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 15:29:36,412][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 15:29:36,412][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 15:29:36,473][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 15:29:36,493][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 15:29:37,205][__main__][INFO] - Instantiating callbacks...
[2023-10-29 15:29:37,206][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 15:29:37,208][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 15:29:37,209][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 15:29:37,210][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 15:29:37,210][__main__][INFO] - Instantiating loggers...
[2023-10-29 15:29:37,210][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 15:29:40,030][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 15:29:40,054][__main__][INFO] - Logging hyperparameters!
[2023-10-29 15:29:40,059][__main__][INFO] - Starting training!
[2023-10-29 15:30:31,107][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 15:30:31,107][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 15:30:31,111][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 15:30:31,111][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 15:30:31,172][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 15:30:31,191][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 15:30:31,896][__main__][INFO] - Instantiating callbacks...
[2023-10-29 15:30:31,896][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 15:30:31,899][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 15:30:31,900][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 15:30:31,900][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 15:30:31,900][__main__][INFO] - Instantiating loggers...
[2023-10-29 15:30:31,900][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 15:30:34,671][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 15:30:34,696][__main__][INFO] - Logging hyperparameters!
[2023-10-29 15:30:34,701][__main__][INFO] - Starting training!
[2023-10-29 15:31:21,640][__main__][INFO] - Best model ckpt at 
[2023-10-29 15:31:21,640][__main__][INFO] - Starting testing!
[2023-10-29 15:31:21,641][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-29 15:31:52,232][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 15:31:52,232][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 15:31:52,236][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 15:31:52,236][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 15:31:52,294][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 15:31:52,303][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 15:31:53,024][__main__][INFO] - Instantiating callbacks...
[2023-10-29 15:31:53,024][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 15:31:53,027][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 15:31:53,027][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 15:31:53,028][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 15:31:53,028][__main__][INFO] - Instantiating loggers...
[2023-10-29 15:31:53,028][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 15:31:55,846][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 15:31:55,872][__main__][INFO] - Logging hyperparameters!
[2023-10-29 15:31:55,878][__main__][INFO] - Starting training!
[2023-10-29 15:33:00,240][__main__][INFO] - Best model ckpt at 
[2023-10-29 15:33:00,240][__main__][INFO] - Starting testing!
[2023-10-29 15:33:00,240][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-29 15:33:20,512][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 15:33:20,512][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 15:33:20,516][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 15:33:20,516][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 15:33:20,580][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 15:33:20,601][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 15:33:21,338][__main__][INFO] - Instantiating callbacks...
[2023-10-29 15:33:21,339][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 15:33:21,341][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 15:33:21,342][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 15:33:21,343][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 15:33:21,343][__main__][INFO] - Instantiating loggers...
[2023-10-29 15:33:21,343][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 15:33:24,201][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 15:33:24,226][__main__][INFO] - Logging hyperparameters!
[2023-10-29 15:33:24,232][__main__][INFO] - Starting training!
[2023-10-29 15:35:59,772][__main__][INFO] - Best model ckpt at 
[2023-10-29 15:35:59,772][__main__][INFO] - Starting testing!
[2023-10-29 15:35:59,773][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-29 15:36:49,362][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 15:36:49,362][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 15:36:49,366][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 15:36:49,366][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 15:36:49,426][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 15:36:49,436][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 15:36:50,158][__main__][INFO] - Instantiating callbacks...
[2023-10-29 15:36:50,158][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 15:36:50,160][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 15:36:50,161][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 15:36:50,162][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 15:36:50,162][__main__][INFO] - Instantiating loggers...
[2023-10-29 15:36:50,162][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 15:36:52,943][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 15:36:52,969][__main__][INFO] - Logging hyperparameters!
[2023-10-29 15:36:52,976][__main__][INFO] - Starting training!
[2023-10-29 17:06:47,922][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=000-v12.ckpt
[2023-10-29 17:06:47,924][__main__][INFO] - Starting testing!
[2023-10-29 17:19:23,098][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 17:19:23,098][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 17:19:23,102][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 17:19:23,103][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 17:19:23,165][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 17:19:23,175][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 17:19:23,902][__main__][INFO] - Instantiating callbacks...
[2023-10-29 17:19:23,902][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 17:19:23,904][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 17:19:23,905][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 17:19:23,905][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 17:19:23,906][__main__][INFO] - Instantiating loggers...
[2023-10-29 17:19:23,906][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 17:19:27,814][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 17:19:27,837][__main__][INFO] - Logging hyperparameters!
[2023-10-29 17:19:27,844][__main__][INFO] - Starting training!
[2023-10-29 17:21:46,450][__main__][INFO] - Best model ckpt at 
[2023-10-29 17:21:46,451][__main__][INFO] - Starting testing!
[2023-10-29 17:21:46,452][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-10-29 17:39:55,262][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-29 17:39:55,263][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 17:39:55,267][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-29 17:39:55,267][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-29 17:39:55,324][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-29 17:39:55,332][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-29 17:39:56,024][__main__][INFO] - Instantiating callbacks...
[2023-10-29 17:39:56,024][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 17:39:56,027][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 17:39:56,028][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-29 17:39:56,028][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 17:39:56,028][__main__][INFO] - Instantiating loggers...
[2023-10-29 17:39:56,028][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-29 17:39:58,757][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-29 17:39:58,780][__main__][INFO] - Logging hyperparameters!
[2023-10-29 17:39:58,786][__main__][INFO] - Starting training!
[2023-10-30 11:06:36,288][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=006.ckpt
[2023-10-30 11:06:36,289][__main__][INFO] - Starting testing!
[2023-10-30 11:07:07,648][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 93, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 208, in test_step
    self.log('test/outputs', outputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\module.py", line 371, in log
    apply_to_collection(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\lightning_utilities\core\apply_func.py", line 51, in apply_to_collection
    return function(data, *args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\module.py", line 535, in __check_allowed
    raise ValueError(f"`self.log({name}, {value})` was called, but `{type(v).__name__}` values cannot be logged")
ValueError: `self.log(test/outputs, [[ 36.78412     3.9957886   3.1718445 ...  41.01625    26.280045
  -27.32912  ]
 [ 25.753906    4.4652786  11.179718  ...   4.134384  -10.104645
  -37.44568  ]
 [ 22.542831   13.449547   16.570183  ... -17.130402  -30.674515
  -37.849297 ]
 ...
 [208.92313   330.7454    404.77325   ...  -3.0368958  39.810165
   77.82071  ]
 [299.52637   411.0199    479.38367   ...  32.380066   94.162025
  171.99586  ]
 [392.60648   463.0912    539.5014    ... 109.93574   192.05049
  273.37952  ]])` was called, but `ndarray` values cannot be logged
[2023-10-30 11:07:07,764][utiles.utils][INFO] - Closing loggers...
[2023-10-30 11:07:07,764][utiles.utils][INFO] - Closing wandb!
[2023-10-30 13:25:17,290][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-30 13:25:17,291][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-30 13:25:17,294][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-30 13:25:17,294][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-30 13:25:17,352][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-30 13:25:17,360][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-30 13:25:18,286][__main__][INFO] - Instantiating callbacks...
[2023-10-30 13:25:18,286][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-30 13:25:18,289][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-30 13:25:18,289][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-30 13:25:18,290][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-30 13:25:18,290][__main__][INFO] - Instantiating loggers...
[2023-10-30 13:25:18,290][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-30 13:25:21,223][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-30 13:25:21,247][__main__][INFO] - Logging hyperparameters!
[2023-10-30 13:25:21,253][__main__][INFO] - Starting training!
[2023-10-30 13:25:55,849][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 161, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 60, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 156, in forward
    enc_out, attns = self.encoder(enc_out, attn_mask=enc_self_mask)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Autoformer_EncDec.py", line 131, in forward
    x, attn = attn_layer(x, attn_mask=attn_mask)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Autoformer_EncDec.py", line 96, in forward
    new_x, attn = self.attention(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\AutoCorrelation.py", line 155, in forward
    out, attn = self.inner_correlation(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FourierCorrelation.py", line 63, in forward
    x_ft = torch.fft.rfft(x, dim=-1)
RuntimeError: cuFFT only supports dimensions whose sizes are powers of two when computing in half precision, but got a signal size of[48]
[2023-10-30 13:25:55,895][utiles.utils][INFO] - Closing loggers...
[2023-10-30 13:25:55,895][utiles.utils][INFO] - Closing wandb!
[2023-10-30 13:27:14,385][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-30 13:27:14,385][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-30 13:27:14,388][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-30 13:27:14,389][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-30 13:27:14,447][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-30 13:27:14,456][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-30 13:27:15,087][__main__][INFO] - Instantiating callbacks...
[2023-10-30 13:27:15,087][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-30 13:27:15,089][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-30 13:27:15,090][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-30 13:27:15,091][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-30 13:27:15,091][__main__][INFO] - Instantiating loggers...
[2023-10-30 13:27:15,091][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-30 13:27:17,893][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-30 13:27:17,915][__main__][INFO] - Logging hyperparameters!
[2023-10-30 13:27:17,920][__main__][INFO] - Starting training!
[2023-10-30 15:45:38,429][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=004.ckpt
[2023-10-30 15:45:38,429][__main__][INFO] - Starting testing!
[2023-10-30 15:47:16,335][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=004.ckpt
[2023-10-30 15:47:16,337][utiles.utils][INFO] - Closing loggers...
[2023-10-30 15:47:16,337][utiles.utils][INFO] - Closing wandb!
[2023-10-30 15:47:21,967][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty
[2023-10-30 15:47:21,968][utiles.utils][INFO] - Retrieved metric value! <val/mae=141.1802520751953>
[2023-10-30 15:57:56,797][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-10-30 15:57:56,797][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-30 15:57:56,801][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-10-30 15:57:56,801][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-10-30 15:57:56,856][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-10-30 15:57:56,865][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-10-30 15:57:57,502][__main__][INFO] - Instantiating callbacks...
[2023-10-30 15:57:57,502][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-30 15:57:57,505][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-30 15:57:57,505][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-10-30 15:57:57,506][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-30 15:57:57,506][__main__][INFO] - Instantiating loggers...
[2023-10-30 15:57:57,506][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-10-30 15:58:00,258][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-10-30 15:58:00,281][__main__][INFO] - Logging hyperparameters!
[2023-10-30 15:58:00,288][__main__][INFO] - Starting training!
[2023-10-30 19:04:58,086][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=006-v1.ckpt
[2023-10-30 19:04:58,087][__main__][INFO] - Starting testing!
[2023-10-30 19:06:30,376][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty/checkpoints\epoch_epoch=006-v1.ckpt
[2023-10-30 19:06:30,377][utiles.utils][INFO] - Closing loggers...
[2023-10-30 19:06:30,378][utiles.utils][INFO] - Closing wandb!
[2023-10-30 19:06:35,441][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\FEDformer_orion\runs\joty
[2023-10-30 19:06:35,442][utiles.utils][INFO] - Retrieved metric value! <val/mae=117.4603500366211>
[2023-11-02 17:11:32,232][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:11:32,232][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:11:32,235][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:11:32,236][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:11:32,333][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:11:32,344][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:11:32,904][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.my_model' has no attribute 'HFANformer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 13, in <module>
    from sub_models import High_FrequencyBlock, Low_FrequencyBlock
ModuleNotFoundError: No module named 'sub_models'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'models.my_model.HFANformer.Model':
ModuleNotFoundError("No module named 'sub_models'")
Are you sure that 'HFANformer' is importable from module 'models.my_model'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.my_model.HFANformer.Model', see chained exception above.
full_key: pl_module.model
[2023-11-02 17:11:32,915][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:15:55,672][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:15:55,672][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:15:55,676][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:15:55,676][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:15:55,733][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:15:55,742][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:15:56,300][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'seq_len'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
TypeError("__init__() got an unexpected keyword argument 'seq_len'")
full_key: pl_module.model
[2023-11-02 17:15:56,302][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:18:59,520][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:18:59,520][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:18:59,524][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:18:59,524][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:18:59,586][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:18:59,595][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:19:00,231][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 60, in __init__
    self.High_FrequencyBlock = High_FrequencyBlock(stack_types=self.Hstack_types, d_model=self.d_model, width=self.Hwidth, num_blocks=self.Lnum_blocks, num_block_layers=self.Hnum_block_layers,
TypeError: __init__() got an unexpected keyword argument 'stack_types'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
TypeError("__init__() got an unexpected keyword argument 'stack_types'")
full_key: pl_module.model
[2023-11-02 17:19:00,232][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:22:01,951][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:22:01,952][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:22:01,956][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:22:01,956][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:22:02,018][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:22:02,028][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:22:02,614][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 60, in __init__
    self.High_FrequencyBlock = High_FrequencyBlock(stack_types=self.Hstack_types, d_model=self.d_model, width=self.Hwidth, num_blocks=self.Lnum_blocks, num_block_layers=self.Hnum_block_layers,
TypeError: __init__() got an unexpected keyword argument 'stack_types'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
TypeError("__init__() got an unexpected keyword argument 'stack_types'")
full_key: pl_module.model
[2023-11-02 17:22:02,615][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:24:54,335][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:24:54,335][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:24:54,337][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:24:54,339][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:24:54,393][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:24:54,402][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:24:54,938][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 60, in __init__
    self.High_FrequencyBlock = High_FrequencyBlock(stack_types=self.Hstack_types, d_model=self.d_model, width=self.Hwidth, num_blocks=self.Lnum_blocks, num_block_layers=self.Hnum_block_layers,
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 154, in __init__
    self.save_hyperparameters()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1269, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'High_FrequencyBlock' object has no attribute 'save_hyperparameters'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
AttributeError("'High_FrequencyBlock' object has no attribute 'save_hyperparameters'")
full_key: pl_module.model
[2023-11-02 17:24:54,948][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:28:05,406][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:28:05,406][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:28:05,410][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:28:05,410][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:28:05,467][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:28:05,476][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:28:05,786][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 52, in __init__
    self.High_FrequencyBlock = High_FrequencyBlock(stack_types=self.Hstack_types, d_model=self.d_model, width=self.Hwidth, num_blocks=self.Lnum_blocks, num_block_layers=self.Hnum_block_layers,
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 172, in __init__
    for _ in range(num_blocks):
TypeError: 'ListConfig' object cannot be interpreted as an integer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
TypeError("'ListConfig' object cannot be interpreted as an integer")
full_key: pl_module.model
[2023-11-02 17:28:05,787][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:33:11,215][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:33:11,215][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:33:11,218][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:33:11,218][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:33:11,276][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:33:11,285][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:33:11,593][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 53, in __init__
    self.High_FrequencyBlock = High_FrequencyBlock(stack_types=self.Hstack_types, d_model=self.d_model, width=self.Hwidth, num_blocks=self.Lnum_blocks, num_block_layers=self.Hnum_block_layers,
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 172, in __init__
    for _ in range(num_blocks):
TypeError: 'ListConfig' object cannot be interpreted as an integer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
TypeError("'ListConfig' object cannot be interpreted as an integer")
full_key: pl_module.model
[2023-11-02 17:33:11,594][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:36:41,265][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:36:41,265][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:36:41,269][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:36:41,269][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:36:41,327][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:36:41,337][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:36:41,665][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 53, in __init__
    self.High_FrequencyBlock = High_FrequencyBlock(stack_types=self.Hstack_types, d_model=self.d_model, width=self.Hwidth, num_blocks=self.Lnum_blocks, num_block_layers=self.Hnum_block_layers,
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 172, in __init__
    for _ in range(num_blocks):
TypeError: 'ListConfig' object cannot be interpreted as an integer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
TypeError("'ListConfig' object cannot be interpreted as an integer")
full_key: pl_module.model
[2023-11-02 17:36:41,667][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:40:45,178][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:40:45,178][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:40:45,181][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:40:45,181][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:40:45,236][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:40:45,245][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:40:45,555][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 53, in __init__
    self.High_FrequencyBlock = High_FrequencyBlock(stack_types=self.Hstack_types, d_model=self.d_model, width=self.Hwidth, num_blocks=self.Lnum_blocks, num_block_layers=self.Hnum_block_layers,
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 172, in __init__
    for _ in range(num_blocks):
TypeError: 'list' object cannot be interpreted as an integer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
TypeError("'list' object cannot be interpreted as an integer")
full_key: pl_module.model
[2023-11-02 17:40:45,556][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:42:27,518][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:42:27,518][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:42:27,522][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:42:27,522][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:42:27,581][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:42:27,590][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:42:27,900][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 53, in __init__
    self.High_FrequencyBlock = High_FrequencyBlock(stack_types=self.Hstack_types, d_model=self.d_model, width=self.Hwidth, num_blocks=self.Lnum_blocks, num_block_layers=self.Hnum_block_layers,
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 172, in __init__
    for _ in range(num_blocks):
TypeError: 'list' object cannot be interpreted as an integer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
TypeError("'list' object cannot be interpreted as an integer")
full_key: pl_module.model
[2023-11-02 17:42:27,902][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:43:49,828][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:43:49,828][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:43:49,832][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:43:49,833][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:43:49,892][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:43:49,902][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:43:50,220][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 53, in __init__
    self.High_FrequencyBlock = High_FrequencyBlock(stack_types=self.Hstack_types, d_model=self.d_model, width=self.Hwidth, num_blocks=self.Lnum_blocks, num_block_layers=self.Hnum_block_layers,
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 172, in __init__
    for _ in range(num_blocks):
TypeError: 'list' object cannot be interpreted as an integer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
TypeError("'list' object cannot be interpreted as an integer")
full_key: pl_module.model
[2023-11-02 17:43:50,222][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:44:19,787][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:44:19,787][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:44:19,791][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:44:19,791][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:44:19,850][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:44:19,859][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:44:20,231][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 60, in __init__
    L_block = Low_FrequencyBlock(stack_types=self.Lstack_types, num_blocks=num_blocks,
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 248, in __init__
    for _ in range(num_blocks[stack_id]):
TypeError: 'int' object is not subscriptable

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
TypeError("'int' object is not subscriptable")
full_key: pl_module.model
[2023-11-02 17:44:20,233][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:45:43,065][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:45:43,065][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:45:43,069][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:45:43,069][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:45:43,126][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:45:43,135][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:45:43,513][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() missing 3 required positional arguments: 'seq_len', 'label_len', and 'pred_len'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'pl_models.HFDecomp.TSForecastTask':
TypeError("__init__() missing 3 required positional arguments: 'seq_len', 'label_len', and 'pred_len'")
full_key: pl_module
[2023-11-02 17:45:43,515][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:47:04,870][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 17:47:04,871][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 17:47:04,874][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 17:47:04,874][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 17:47:04,931][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 17:47:04,940][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 17:47:05,342][__main__][INFO] - Instantiating callbacks...
[2023-11-02 17:47:05,343][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 17:47:05,344][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 17:47:05,345][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 17:47:05,346][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 17:47:05,346][__main__][INFO] - Instantiating loggers...
[2023-11-02 17:47:05,346][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 17:47:08,272][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 17:47:08,295][__main__][INFO] - Logging hyperparameters!
[2023-11-02 17:47:08,302][__main__][INFO] - Starting training!
[2023-11-02 17:48:17,397][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 122, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 60, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
TypeError: forward() takes 2 positional arguments but 5 were given
[2023-11-02 17:48:17,431][utiles.utils][INFO] - Closing loggers...
[2023-11-02 17:48:17,431][utiles.utils][INFO] - Closing wandb!
[2023-11-02 18:35:11,529][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 18:35:11,529][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 18:35:11,532][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 18:35:11,533][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 18:35:11,619][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 18:35:11,629][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 18:35:12,296][__main__][INFO] - Instantiating callbacks...
[2023-11-02 18:35:12,296][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 18:35:12,298][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 18:35:12,299][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 18:35:12,299][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 18:35:12,299][__main__][INFO] - Instantiating loggers...
[2023-11-02 18:35:12,300][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 18:35:15,338][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 18:35:15,360][__main__][INFO] - Logging hyperparameters!
[2023-11-02 18:35:15,366][__main__][INFO] - Starting training!
[2023-11-02 18:36:30,475][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 72, in forward
    x_HighF = self.wave_decomp(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Wave_decomposition.py", line 78, in forward
    wav_kernels = torch.stack([gen_kernel(w) for w in self.W])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Wave_decomposition.py", line 78, in <listcomp>
    wav_kernels = torch.stack([gen_kernel(w) for w in self.W])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Wave_decomposition.py", line 61, in gen_kernel
    mod = (1 - (T2) / (w2))
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2023-11-02 18:36:30,550][utiles.utils][INFO] - Closing loggers...
[2023-11-02 18:36:30,551][utiles.utils][INFO] - Closing wandb!
[2023-11-02 18:39:45,825][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 18:39:45,826][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 18:39:45,829][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 18:39:45,829][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 18:39:45,895][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 18:39:45,907][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 18:39:47,305][__main__][INFO] - Instantiating callbacks...
[2023-11-02 18:39:47,305][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 18:39:47,307][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 18:39:47,309][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 18:39:47,309][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 18:39:47,309][__main__][INFO] - Instantiating loggers...
[2023-11-02 18:39:47,309][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 18:39:50,071][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 18:39:50,094][__main__][INFO] - Logging hyperparameters!
[2023-11-02 18:39:50,102][__main__][INFO] - Starting training!
[2023-11-02 18:41:07,160][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 73, in forward
    x_HighF = self.wave_decomp(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Wave_decomposition.py", line 78, in forward
    wav_kernels = torch.stack([gen_kernel(w) for w in self.W])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Wave_decomposition.py", line 78, in <listcomp>
    wav_kernels = torch.stack([gen_kernel(w) for w in self.W])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Wave_decomposition.py", line 61, in gen_kernel
    mod = (1 - (T2) / (w2))
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2023-11-02 18:41:07,169][utiles.utils][INFO] - Closing loggers...
[2023-11-02 18:41:07,170][utiles.utils][INFO] - Closing wandb!
[2023-11-02 18:45:18,913][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 18:45:18,913][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 18:45:18,917][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 18:45:18,917][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 18:45:18,987][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 18:45:18,996][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 18:45:20,475][__main__][INFO] - Instantiating callbacks...
[2023-11-02 18:45:20,476][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 18:45:20,477][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 18:45:20,479][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 18:45:20,480][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 18:45:20,480][__main__][INFO] - Instantiating loggers...
[2023-11-02 18:45:20,480][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 18:45:23,352][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 18:45:23,377][__main__][INFO] - Logging hyperparameters!
[2023-11-02 18:45:23,384][__main__][INFO] - Starting training!
[2023-11-02 18:46:41,749][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 75, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 188, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 44, in forward
    B, L, H, E = x.shape
ValueError: not enough values to unpack (expected 4, got 3)
[2023-11-02 18:46:41,770][utiles.utils][INFO] - Closing loggers...
[2023-11-02 18:46:41,772][utiles.utils][INFO] - Closing wandb!
[2023-11-02 19:14:57,295][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 19:14:57,295][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 19:14:57,299][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 19:14:57,299][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 19:14:57,362][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 19:14:57,372][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 19:14:58,789][__main__][INFO] - Instantiating callbacks...
[2023-11-02 19:14:58,789][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 19:14:58,792][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 19:14:58,792][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 19:14:58,793][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 19:14:58,793][__main__][INFO] - Instantiating loggers...
[2023-11-02 19:14:58,793][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 19:15:01,634][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 19:15:01,664][__main__][INFO] - Logging hyperparameters!
[2023-11-02 19:15:01,671][__main__][INFO] - Starting training!
[2023-11-02 19:16:21,008][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 75, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 188, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 48, in forward
    x = x.permute(0, 2, 3, 1)
RuntimeError: permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 3 is not equal to len(dims) = 4
[2023-11-02 19:16:21,016][utiles.utils][INFO] - Closing loggers...
[2023-11-02 19:16:21,016][utiles.utils][INFO] - Closing wandb!
[2023-11-02 19:40:02,261][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 19:40:02,261][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 19:40:02,266][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 19:40:02,266][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 19:40:02,344][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 19:40:02,358][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 19:40:03,829][__main__][INFO] - Instantiating callbacks...
[2023-11-02 19:40:03,830][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 19:40:03,832][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 19:40:03,833][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 19:40:03,833][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 19:40:03,834][__main__][INFO] - Instantiating loggers...
[2023-11-02 19:40:03,834][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 19:40:06,904][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 19:40:06,958][__main__][INFO] - Logging hyperparameters!
[2023-11-02 19:40:06,969][__main__][INFO] - Starting training!
[2023-11-02 19:40:45,917][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 19:40:45,917][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 19:40:45,920][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 19:40:45,920][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 19:40:45,991][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 19:40:46,002][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 19:40:47,424][__main__][INFO] - Instantiating callbacks...
[2023-11-02 19:40:47,424][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 19:40:47,426][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 19:40:47,427][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 19:40:47,428][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 19:40:47,428][__main__][INFO] - Instantiating loggers...
[2023-11-02 19:40:47,428][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 19:40:50,288][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 19:40:50,316][__main__][INFO] - Logging hyperparameters!
[2023-11-02 19:40:50,323][__main__][INFO] - Starting training!
[2023-11-02 19:42:08,329][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 75, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 188, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 61, in forward
    out_ft[:, :, wi] = self.compl_mul1d(x_ft[:, :, i], self.weights1[:, :, wi])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 42, in compl_mul1d
    return torch.einsum("bhi,hio->bho", input, weights)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
RuntimeError: einsum(): the number of subscripts in the equation (3) does not match the number of dimensions (2) for operand 0 and no ellipsis was given
[2023-11-02 19:42:08,334][utiles.utils][INFO] - Closing loggers...
[2023-11-02 19:42:08,335][utiles.utils][INFO] - Closing wandb!
[2023-11-02 20:08:13,796][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 20:08:13,796][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 20:08:13,800][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 20:08:13,800][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 20:08:13,860][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 20:08:13,870][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 20:08:15,213][__main__][INFO] - Instantiating callbacks...
[2023-11-02 20:08:15,213][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 20:08:15,215][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 20:08:15,216][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 20:08:15,216][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 20:08:15,216][__main__][INFO] - Instantiating loggers...
[2023-11-02 20:08:15,216][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 20:08:18,034][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 20:08:18,057][__main__][INFO] - Logging hyperparameters!
[2023-11-02 20:08:18,064][__main__][INFO] - Starting training!
[2023-11-02 20:09:34,613][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 75, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 188, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 72, in forward
    if i >= x_ft.shape[3] or wi >= out_ft.shape[3]:
IndexError: tuple index out of range
[2023-11-02 20:09:34,621][utiles.utils][INFO] - Closing loggers...
[2023-11-02 20:09:34,621][utiles.utils][INFO] - Closing wandb!
[2023-11-02 20:20:44,649][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 20:20:44,650][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 20:20:44,652][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 20:20:44,652][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 20:20:44,709][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 20:20:44,719][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 20:20:46,008][__main__][INFO] - Instantiating callbacks...
[2023-11-02 20:20:46,008][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 20:20:46,010][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 20:20:46,012][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 20:20:46,012][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 20:20:46,013][__main__][INFO] - Instantiating loggers...
[2023-11-02 20:20:46,013][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 20:20:48,809][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 20:20:48,830][__main__][INFO] - Logging hyperparameters!
[2023-11-02 20:20:48,836][__main__][INFO] - Starting training!
[2023-11-02 20:21:54,246][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 75, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 188, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 61, in forward
    out_ft[:, :, wi] = self.compl_mul1d(x_ft[:, :, i], self.weights1[:, :, wi])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 41, in compl_mul1d
    return torch.einsum("bhi,hio->bho", input, weights)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
RuntimeError: einsum(): the number of subscripts in the equation (3) does not match the number of dimensions (2) for operand 0 and no ellipsis was given
[2023-11-02 20:21:54,252][utiles.utils][INFO] - Closing loggers...
[2023-11-02 20:21:54,252][utiles.utils][INFO] - Closing wandb!
[2023-11-02 20:33:18,700][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 20:33:18,700][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 20:33:18,703][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 20:33:18,703][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 20:33:18,764][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 20:33:18,774][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 20:33:20,169][__main__][INFO] - Instantiating callbacks...
[2023-11-02 20:33:20,170][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 20:33:20,172][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 20:33:20,172][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 20:33:20,174][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 20:33:20,174][__main__][INFO] - Instantiating loggers...
[2023-11-02 20:33:20,174][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 20:33:23,040][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 20:33:23,065][__main__][INFO] - Logging hyperparameters!
[2023-11-02 20:33:23,071][__main__][INFO] - Starting training!
[2023-11-02 20:34:29,534][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 75, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 188, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 58, in forward
    out_ft[:, :, wi] = self.compl_mul1d(x_ft[:, :, i], self.weights1[:, :, wi])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 41, in compl_mul1d
    return torch.einsum("bhi,hio->bho", input, weights)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
RuntimeError: einsum(): the number of subscripts in the equation (3) does not match the number of dimensions (2) for operand 0 and no ellipsis was given
[2023-11-02 20:34:29,538][utiles.utils][INFO] - Closing loggers...
[2023-11-02 20:34:29,538][utiles.utils][INFO] - Closing wandb!
[2023-11-02 20:44:57,259][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 20:44:57,259][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 20:44:57,263][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 20:44:57,263][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 20:44:57,322][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 20:44:57,332][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 20:44:58,717][__main__][INFO] - Instantiating callbacks...
[2023-11-02 20:44:58,717][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 20:44:58,719][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 20:44:58,720][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 20:44:58,720][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 20:44:58,721][__main__][INFO] - Instantiating loggers...
[2023-11-02 20:44:58,721][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 20:45:01,550][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 20:45:01,573][__main__][INFO] - Logging hyperparameters!
[2023-11-02 20:45:01,580][__main__][INFO] - Starting training!
[2023-11-02 20:46:08,680][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 75, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 188, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 62, in forward
    phase[:, :, wi] = self.compl_mul1d(x_ft[:, :, i], self.weights1[:, :, wi])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 41, in compl_mul1d
    return torch.einsum("bhi,hio->bho", input, weights)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
RuntimeError: einsum(): the number of subscripts in the equation (3) does not match the number of dimensions (2) for operand 0 and no ellipsis was given
[2023-11-02 20:46:08,685][utiles.utils][INFO] - Closing loggers...
[2023-11-02 20:46:08,685][utiles.utils][INFO] - Closing wandb!
[2023-11-02 20:47:06,488][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 20:47:06,488][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 20:47:06,491][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 20:47:06,491][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 20:47:06,549][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 20:47:06,558][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 20:47:07,926][__main__][INFO] - Instantiating callbacks...
[2023-11-02 20:47:07,927][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 20:47:07,929][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 20:47:07,929][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 20:47:07,930][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 20:47:07,930][__main__][INFO] - Instantiating loggers...
[2023-11-02 20:47:07,930][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 20:47:10,667][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 20:47:10,690][__main__][INFO] - Logging hyperparameters!
[2023-11-02 20:47:10,696][__main__][INFO] - Starting training!
[2023-11-02 20:47:48,742][__main__][INFO] - Best model ckpt at 
[2023-11-02 20:47:48,743][__main__][INFO] - Starting testing!
[2023-11-02 20:47:48,743][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-02 20:47:57,078][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 20:47:57,078][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 20:47:57,082][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 20:47:57,082][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 20:47:57,142][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 20:47:57,153][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 20:47:58,527][__main__][INFO] - Instantiating callbacks...
[2023-11-02 20:47:58,527][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 20:47:58,529][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 20:47:58,530][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 20:47:58,530][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 20:47:58,531][__main__][INFO] - Instantiating loggers...
[2023-11-02 20:47:58,531][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 20:48:01,372][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 20:48:01,396][__main__][INFO] - Logging hyperparameters!
[2023-11-02 20:48:01,402][__main__][INFO] - Starting training!
[2023-11-02 20:49:07,614][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 75, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 188, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 63, in forward
    out_ft[:, :, wi] = self.compl_mul1d(phase[:, :, i], self.weights1[:, :, wi])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 41, in compl_mul1d
    return torch.einsum("bhi,hio->bho", input, weights)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
RuntimeError: einsum(): the number of subscripts in the equation (3) does not match the number of dimensions (2) for operand 0 and no ellipsis was given
[2023-11-02 20:49:07,623][utiles.utils][INFO] - Closing loggers...
[2023-11-02 20:49:07,623][utiles.utils][INFO] - Closing wandb!
[2023-11-02 20:49:35,658][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-02 20:49:35,659][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-02 20:49:35,662][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-02 20:49:35,662][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-02 20:49:35,718][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-02 20:49:35,728][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-02 20:49:37,098][__main__][INFO] - Instantiating callbacks...
[2023-11-02 20:49:37,098][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-02 20:49:37,101][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-02 20:49:37,101][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-02 20:49:37,102][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-02 20:49:37,102][__main__][INFO] - Instantiating loggers...
[2023-11-02 20:49:37,102][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-02 20:49:39,771][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-02 20:49:39,793][__main__][INFO] - Logging hyperparameters!
[2023-11-02 20:49:39,799][__main__][INFO] - Starting training!
[2023-11-02 20:50:47,155][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 75, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 188, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 64, in forward
    out_ft[:, :, wi] = self.compl_mul1d(phase[:, :, i], self.weights1[:, :, wi])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 41, in compl_mul1d
    return torch.einsum("bhi,hio->bho", input, weights)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
RuntimeError: einsum(): the number of subscripts in the equation (3) does not match the number of dimensions (2) for operand 0 and no ellipsis was given
[2023-11-02 20:50:47,163][utiles.utils][INFO] - Closing loggers...
[2023-11-02 20:50:47,163][utiles.utils][INFO] - Closing wandb!
[2023-11-03 10:04:45,881][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 10:04:45,881][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 10:04:45,884][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 10:04:45,885][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 10:04:45,987][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 10:04:45,996][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 10:04:47,429][__main__][INFO] - Instantiating callbacks...
[2023-11-03 10:04:47,430][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 10:04:47,432][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 10:04:47,432][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 10:04:47,433][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 10:04:47,433][__main__][INFO] - Instantiating loggers...
[2023-11-03 10:04:47,433][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 10:04:50,317][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 10:04:50,339][__main__][INFO] - Logging hyperparameters!
[2023-11-03 10:04:50,345][__main__][INFO] - Starting training!
[2023-11-03 10:05:57,545][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 75, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 188, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 66, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase[:, :, :, i], self.weights1[:, :, :, wi])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 41, in compl_mul1d
    return torch.einsum("bhi,hio->bho", input, weights)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
RuntimeError: einsum(): subscript h has size 8 for operand 1 which does not broadcast with previously seen size 9
[2023-11-03 10:05:57,622][utiles.utils][INFO] - Closing loggers...
[2023-11-03 10:05:57,622][utiles.utils][INFO] - Closing wandb!
[2023-11-03 10:09:08,255][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 10:09:08,255][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 10:09:08,258][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 10:09:08,258][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 10:09:08,312][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 10:09:08,320][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 10:09:09,549][__main__][INFO] - Instantiating callbacks...
[2023-11-03 10:09:09,549][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 10:09:09,550][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 10:09:09,551][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 10:09:09,551][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 10:09:09,552][__main__][INFO] - Instantiating loggers...
[2023-11-03 10:09:09,552][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 10:09:12,719][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 10:09:12,745][__main__][INFO] - Logging hyperparameters!
[2023-11-03 10:09:12,753][__main__][INFO] - Starting training!
[2023-11-03 10:10:19,303][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 112, in validation_step
    outputs = self(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 75, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 188, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 70, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase[:, :, :, i], self.weights1[:, :, :, wi])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 42, in compl_mul1d
    return torch.einsum("bhi,hio->bho", input, weights)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
RuntimeError: einsum(): subscript h has size 8 for operand 1 which does not broadcast with previously seen size 9
[2023-11-03 10:10:19,309][utiles.utils][INFO] - Closing loggers...
[2023-11-03 10:10:19,309][utiles.utils][INFO] - Closing wandb!
[2023-11-03 10:19:37,616][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 10:19:37,616][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 10:19:37,619][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 10:19:37,619][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 10:19:37,719][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 10:19:37,728][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 10:19:38,545][__main__][INFO] - Instantiating callbacks...
[2023-11-03 10:19:38,546][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 10:19:38,547][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 10:19:38,548][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 10:19:38,549][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 10:19:38,549][__main__][INFO] - Instantiating loggers...
[2023-11-03 10:19:38,549][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 10:19:41,436][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 10:19:41,457][__main__][INFO] - Logging hyperparameters!
[2023-11-03 10:19:41,463][__main__][INFO] - Starting training!
[2023-11-03 10:21:43,443][__main__][INFO] - Best model ckpt at 
[2023-11-03 10:21:43,443][__main__][INFO] - Starting testing!
[2023-11-03 10:21:43,443][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-03 10:23:12,968][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 10:23:12,968][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 10:23:12,971][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 10:23:12,971][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 10:23:13,027][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 10:23:13,038][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 10:23:13,693][__main__][INFO] - Instantiating callbacks...
[2023-11-03 10:23:13,694][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 10:23:13,696][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 10:23:13,696][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 10:23:13,696][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 10:23:13,698][__main__][INFO] - Instantiating loggers...
[2023-11-03 10:23:13,698][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 10:23:16,466][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 10:23:16,489][__main__][INFO] - Logging hyperparameters!
[2023-11-03 10:23:16,494][__main__][INFO] - Starting training!
[2023-11-03 10:28:10,624][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 10:28:10,624][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 10:28:10,628][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 10:28:10,628][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 10:28:10,682][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 10:28:10,692][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 10:28:11,356][__main__][INFO] - Instantiating callbacks...
[2023-11-03 10:28:11,356][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 10:28:11,359][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 10:28:11,359][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 10:28:11,359][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 10:28:11,360][__main__][INFO] - Instantiating loggers...
[2023-11-03 10:28:11,360][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 10:28:14,231][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 10:28:14,256][__main__][INFO] - Logging hyperparameters!
[2023-11-03 10:28:14,262][__main__][INFO] - Starting training!
[2023-11-03 10:34:13,777][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 10:34:13,777][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 10:34:13,780][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 10:34:13,780][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 10:34:13,843][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 10:34:13,852][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 10:34:14,513][__main__][INFO] - Instantiating callbacks...
[2023-11-03 10:34:14,513][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 10:34:14,515][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 10:34:14,516][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 10:34:14,516][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 10:34:14,517][__main__][INFO] - Instantiating loggers...
[2023-11-03 10:34:14,517][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 10:34:17,326][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 10:34:17,349][__main__][INFO] - Logging hyperparameters!
[2023-11-03 10:34:17,355][__main__][INFO] - Starting training!
[2023-11-03 10:36:02,144][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 10:36:02,144][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 10:36:02,147][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 10:36:02,148][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 10:36:02,210][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 10:36:02,219][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 10:36:02,869][__main__][INFO] - Instantiating callbacks...
[2023-11-03 10:36:02,869][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 10:36:02,872][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 10:36:02,872][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 10:36:02,873][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 10:36:02,873][__main__][INFO] - Instantiating loggers...
[2023-11-03 10:36:02,873][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 10:36:05,617][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 10:36:05,641][__main__][INFO] - Logging hyperparameters!
[2023-11-03 10:36:05,646][__main__][INFO] - Starting training!
[2023-11-03 11:56:24,660][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 11:56:24,660][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 11:56:24,664][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 11:56:24,664][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 11:56:24,723][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 11:56:24,733][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 11:56:26,084][__main__][INFO] - Instantiating callbacks...
[2023-11-03 11:56:26,085][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 11:56:26,087][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 11:56:26,088][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 11:56:26,088][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 11:56:26,088][__main__][INFO] - Instantiating loggers...
[2023-11-03 11:56:26,088][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 11:56:28,884][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 11:56:28,910][__main__][INFO] - Logging hyperparameters!
[2023-11-03 11:56:28,916][__main__][INFO] - Starting training!
[2023-11-03 11:57:39,525][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 91, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 48, in forward
    B, L, H, E = x.shape
ValueError: not enough values to unpack (expected 4, got 3)
[2023-11-03 11:57:39,588][utiles.utils][INFO] - Closing loggers...
[2023-11-03 11:57:39,588][utiles.utils][INFO] - Closing wandb!
[2023-11-03 11:58:47,341][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 11:58:47,341][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 11:58:47,345][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 11:58:47,345][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 11:58:47,403][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 11:58:47,414][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 11:58:48,782][__main__][INFO] - Instantiating callbacks...
[2023-11-03 11:58:48,782][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 11:58:48,784][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 11:58:48,785][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 11:58:48,786][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 11:58:48,786][__main__][INFO] - Instantiating loggers...
[2023-11-03 11:58:48,786][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 11:58:51,567][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 11:58:51,593][__main__][INFO] - Logging hyperparameters!
[2023-11-03 11:58:51,600][__main__][INFO] - Starting training!
[2023-11-03 12:00:02,641][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 48, in forward
    B, L, H, E = x.shape
ValueError: not enough values to unpack (expected 4, got 3)
[2023-11-03 12:00:02,644][utiles.utils][INFO] - Closing loggers...
[2023-11-03 12:00:02,644][utiles.utils][INFO] - Closing wandb!
[2023-11-03 12:01:39,452][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 12:01:39,452][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 12:01:39,456][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 12:01:39,456][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 12:01:39,516][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 12:01:39,525][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 12:01:40,217][__main__][INFO] - Instantiating callbacks...
[2023-11-03 12:01:40,218][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 12:01:40,220][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 12:01:40,221][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 12:01:40,221][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 12:01:40,222][__main__][INFO] - Instantiating loggers...
[2023-11-03 12:01:40,222][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 12:01:43,222][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 12:01:43,245][__main__][INFO] - Logging hyperparameters!
[2023-11-03 12:01:43,252][__main__][INFO] - Starting training!
[2023-11-03 12:06:41,020][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 12:06:41,020][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 12:06:41,024][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 12:06:41,024][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 12:06:41,086][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 12:06:41,096][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 12:06:42,460][__main__][INFO] - Instantiating callbacks...
[2023-11-03 12:06:42,460][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 12:06:42,463][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 12:06:42,464][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 12:06:42,464][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 12:06:42,464][__main__][INFO] - Instantiating loggers...
[2023-11-03 12:06:42,465][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 12:06:45,368][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 12:06:45,392][__main__][INFO] - Logging hyperparameters!
[2023-11-03 12:06:45,398][__main__][INFO] - Starting training!
[2023-11-03 12:07:51,759][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 48, in forward
    B, L, H, E = x.shape
ValueError: not enough values to unpack (expected 4, got 3)
[2023-11-03 12:07:51,767][utiles.utils][INFO] - Closing loggers...
[2023-11-03 12:07:51,769][utiles.utils][INFO] - Closing wandb!
[2023-11-03 12:09:22,095][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 12:09:22,095][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 12:09:22,098][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 12:09:22,098][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 12:09:22,161][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 12:09:22,171][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 12:09:22,868][__main__][INFO] - Instantiating callbacks...
[2023-11-03 12:09:22,869][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 12:09:22,871][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 12:09:22,872][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 12:09:22,872][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 12:09:22,872][__main__][INFO] - Instantiating loggers...
[2023-11-03 12:09:22,872][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 12:09:25,701][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 12:09:25,727][__main__][INFO] - Logging hyperparameters!
[2023-11-03 12:09:25,733][__main__][INFO] - Starting training!
[2023-11-03 12:30:48,492][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 12:30:48,493][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 12:30:48,496][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 12:30:48,496][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 12:30:48,555][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 12:30:48,565][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 12:30:49,888][__main__][INFO] - Instantiating callbacks...
[2023-11-03 12:30:49,888][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 12:30:49,890][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 12:30:49,891][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 12:30:49,891][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 12:30:49,891][__main__][INFO] - Instantiating loggers...
[2023-11-03 12:30:49,891][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 12:30:52,589][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 12:30:52,612][__main__][INFO] - Logging hyperparameters!
[2023-11-03 12:30:52,618][__main__][INFO] - Starting training!
[2023-11-03 12:31:58,609][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 69, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase[:, :, :, i], self.weights1[:, :, :, wi])
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 42, in compl_mul1d
    return torch.einsum("bhi,hio->bho", input, weights)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
RuntimeError: expected scalar type ComplexFloat but found Float
[2023-11-03 12:31:58,615][utiles.utils][INFO] - Closing loggers...
[2023-11-03 12:31:58,615][utiles.utils][INFO] - Closing wandb!
[2023-11-03 12:34:10,985][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 12:34:10,985][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 12:34:10,988][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 12:34:10,988][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 12:34:11,048][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 12:34:11,057][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 12:34:12,349][__main__][INFO] - Instantiating callbacks...
[2023-11-03 12:34:12,349][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 12:34:12,351][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 12:34:12,352][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 12:34:12,352][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 12:34:12,353][__main__][INFO] - Instantiating loggers...
[2023-11-03 12:34:12,353][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 12:34:15,168][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 12:34:15,191][__main__][INFO] - Logging hyperparameters!
[2023-11-03 12:34:15,198][__main__][INFO] - Starting training!
[2023-11-03 12:35:28,998][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 69, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase_i[:, :, :, i], self.weights1_wi[:, :, :, wi])
IndexError: too many indices for tensor of dimension 3
[2023-11-03 12:35:29,003][utiles.utils][INFO] - Closing loggers...
[2023-11-03 12:35:29,003][utiles.utils][INFO] - Closing wandb!
[2023-11-03 12:37:21,441][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 12:37:21,441][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 12:37:21,445][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 12:37:21,445][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 12:37:21,509][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 12:37:21,520][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 12:37:22,913][__main__][INFO] - Instantiating callbacks...
[2023-11-03 12:37:22,913][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 12:37:22,916][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 12:37:22,917][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 12:37:22,917][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 12:37:22,917][__main__][INFO] - Instantiating loggers...
[2023-11-03 12:37:22,918][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 12:37:25,769][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 12:37:25,801][__main__][INFO] - Logging hyperparameters!
[2023-11-03 12:37:25,815][__main__][INFO] - Starting training!
[2023-11-03 12:38:41,252][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 71, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase_i[:, :, :, i], weights1_wi[:, :, :, wi])
IndexError: too many indices for tensor of dimension 3
[2023-11-03 12:38:41,257][utiles.utils][INFO] - Closing loggers...
[2023-11-03 12:38:41,258][utiles.utils][INFO] - Closing wandb!
[2023-11-03 12:46:23,068][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 12:46:23,068][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 12:46:23,072][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 12:46:23,072][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 12:46:23,136][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 12:46:23,146][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 12:46:24,579][__main__][INFO] - Instantiating callbacks...
[2023-11-03 12:46:24,579][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 12:46:24,582][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 12:46:24,582][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 12:46:24,583][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 12:46:24,583][__main__][INFO] - Instantiating loggers...
[2023-11-03 12:46:24,583][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 12:46:27,445][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 12:46:27,471][__main__][INFO] - Logging hyperparameters!
[2023-11-03 12:46:27,478][__main__][INFO] - Starting training!
[2023-11-03 12:47:43,524][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 69, in forward
    print(phase_i[:, :, :, i].shape)
IndexError: too many indices for tensor of dimension 3
[2023-11-03 12:47:43,529][utiles.utils][INFO] - Closing loggers...
[2023-11-03 12:47:43,530][utiles.utils][INFO] - Closing wandb!
[2023-11-03 12:48:21,195][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 12:48:21,196][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 12:48:21,200][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 12:48:21,200][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 12:48:21,262][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 12:48:21,274][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 12:48:22,736][__main__][INFO] - Instantiating callbacks...
[2023-11-03 12:48:22,736][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 12:48:22,738][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 12:48:22,739][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 12:48:22,740][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 12:48:22,740][__main__][INFO] - Instantiating loggers...
[2023-11-03 12:48:22,740][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 12:48:25,563][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 12:48:25,588][__main__][INFO] - Logging hyperparameters!
[2023-11-03 12:48:25,595][__main__][INFO] - Starting training!
[2023-11-03 12:49:41,588][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 71, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase_i, weights1_wi)
IndexError: index 25 is out of bounds for dimension 3 with size 25
[2023-11-03 12:49:41,593][utiles.utils][INFO] - Closing loggers...
[2023-11-03 12:49:41,593][utiles.utils][INFO] - Closing wandb!
[2023-11-03 13:01:15,015][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 13:01:15,015][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 13:01:15,018][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 13:01:15,019][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 13:01:15,086][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 13:01:15,095][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 13:01:16,403][__main__][INFO] - Instantiating callbacks...
[2023-11-03 13:01:16,404][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 13:01:16,406][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 13:01:16,406][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 13:01:16,407][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 13:01:16,407][__main__][INFO] - Instantiating loggers...
[2023-11-03 13:01:16,407][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 13:01:19,193][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 13:01:19,216][__main__][INFO] - Logging hyperparameters!
[2023-11-03 13:01:19,222][__main__][INFO] - Starting training!
[2023-11-03 13:02:32,409][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 72, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase_i, weights1_wi)
IndexError: index 25 is out of bounds for dimension 3 with size 25
[2023-11-03 13:02:32,419][utiles.utils][INFO] - Closing loggers...
[2023-11-03 13:02:32,420][utiles.utils][INFO] - Closing wandb!
[2023-11-03 13:03:14,176][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 13:03:14,177][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 13:03:14,181][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 13:03:14,181][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 13:03:14,245][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 13:03:14,255][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 13:03:15,634][__main__][INFO] - Instantiating callbacks...
[2023-11-03 13:03:15,635][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 13:03:15,637][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 13:03:15,638][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 13:03:15,638][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 13:03:15,638][__main__][INFO] - Instantiating loggers...
[2023-11-03 13:03:15,639][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 13:03:18,476][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 13:03:18,501][__main__][INFO] - Logging hyperparameters!
[2023-11-03 13:03:18,508][__main__][INFO] - Starting training!
[2023-11-03 13:04:33,893][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 70, in forward
    print(phase_i[:, :, :, i].shape)
IndexError: too many indices for tensor of dimension 3
[2023-11-03 13:04:33,900][utiles.utils][INFO] - Closing loggers...
[2023-11-03 13:04:33,900][utiles.utils][INFO] - Closing wandb!
[2023-11-03 13:05:11,642][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 13:05:11,642][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 13:05:11,646][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 13:05:11,646][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 13:05:11,708][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 13:05:11,718][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 13:05:13,093][__main__][INFO] - Instantiating callbacks...
[2023-11-03 13:05:13,094][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 13:05:13,096][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 13:05:13,096][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 13:05:13,097][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 13:05:13,097][__main__][INFO] - Instantiating loggers...
[2023-11-03 13:05:13,097][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 13:05:15,976][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 13:05:16,002][__main__][INFO] - Logging hyperparameters!
[2023-11-03 13:05:16,008][__main__][INFO] - Starting training!
[2023-11-03 13:06:31,859][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 72, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase_i, weights1_wi)
IndexError: index 25 is out of bounds for dimension 3 with size 25
[2023-11-03 13:06:31,868][utiles.utils][INFO] - Closing loggers...
[2023-11-03 13:06:31,868][utiles.utils][INFO] - Closing wandb!
[2023-11-03 13:37:26,839][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 13:37:26,840][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 13:37:26,843][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 13:37:26,843][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 13:37:26,899][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 13:37:26,909][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 13:37:28,204][__main__][INFO] - Instantiating callbacks...
[2023-11-03 13:37:28,204][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 13:37:28,207][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 13:37:28,207][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 13:37:28,207][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 13:37:28,208][__main__][INFO] - Instantiating loggers...
[2023-11-03 13:37:28,208][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 13:37:31,068][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 13:37:31,090][__main__][INFO] - Logging hyperparameters!
[2023-11-03 13:37:31,096][__main__][INFO] - Starting training!
[2023-11-03 13:38:38,387][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 63, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase_i, weights1_wi)
IndexError: index 25 is out of bounds for dimension 3 with size 25
[2023-11-03 13:38:38,393][utiles.utils][INFO] - Closing loggers...
[2023-11-03 13:38:38,393][utiles.utils][INFO] - Closing wandb!
[2023-11-03 13:43:48,067][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 13:43:48,068][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 13:43:48,071][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 13:43:48,071][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 13:43:48,130][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 13:43:48,139][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 13:43:49,434][__main__][INFO] - Instantiating callbacks...
[2023-11-03 13:43:49,441][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 13:43:49,443][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 13:43:49,444][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 13:43:49,444][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 13:43:49,444][__main__][INFO] - Instantiating loggers...
[2023-11-03 13:43:49,444][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 13:43:52,176][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 13:43:52,200][__main__][INFO] - Logging hyperparameters!
[2023-11-03 13:43:52,206][__main__][INFO] - Starting training!
[2023-11-03 13:44:58,047][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 64, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase_i, weights1_wi)
IndexError: index 25 is out of bounds for dimension 3 with size 25
[2023-11-03 13:44:58,052][utiles.utils][INFO] - Closing loggers...
[2023-11-03 13:44:58,052][utiles.utils][INFO] - Closing wandb!
[2023-11-03 13:47:12,381][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 13:47:12,381][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 13:47:12,384][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 13:47:12,385][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 13:47:12,443][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 13:47:12,452][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 13:47:13,790][__main__][INFO] - Instantiating callbacks...
[2023-11-03 13:47:13,790][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 13:47:13,792][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 13:47:13,793][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 13:47:13,793][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 13:47:13,794][__main__][INFO] - Instantiating loggers...
[2023-11-03 13:47:13,794][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 13:47:16,554][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 13:47:16,580][__main__][INFO] - Logging hyperparameters!
[2023-11-03 13:47:16,587][__main__][INFO] - Starting training!
[2023-11-03 13:48:23,878][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 64, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase_i, weights1_wi)
IndexError: index 25 is out of bounds for dimension 3 with size 25
[2023-11-03 13:48:23,885][utiles.utils][INFO] - Closing loggers...
[2023-11-03 13:48:23,885][utiles.utils][INFO] - Closing wandb!
[2023-11-03 13:51:22,256][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 13:51:22,256][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 13:51:22,260][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 13:51:22,260][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 13:51:22,319][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 13:51:22,328][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 13:51:23,637][__main__][INFO] - Instantiating callbacks...
[2023-11-03 13:51:23,637][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 13:51:23,639][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 13:51:23,640][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 13:51:23,640][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 13:51:23,641][__main__][INFO] - Instantiating loggers...
[2023-11-03 13:51:23,641][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 13:51:26,371][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 13:51:26,395][__main__][INFO] - Logging hyperparameters!
[2023-11-03 13:51:26,401][__main__][INFO] - Starting training!
[2023-11-03 13:52:32,823][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 65, in forward
    out_ft[:, :, :, wi] = self.compl_mul1d(phase_i, weights1_wi)
IndexError: index 25 is out of bounds for dimension 3 with size 25
[2023-11-03 13:52:32,830][utiles.utils][INFO] - Closing loggers...
[2023-11-03 13:52:32,830][utiles.utils][INFO] - Closing wandb!
[2023-11-03 13:56:09,602][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 13:56:09,602][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 13:56:09,606][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 13:56:09,606][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 13:56:09,662][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 13:56:09,672][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 13:56:10,967][__main__][INFO] - Instantiating callbacks...
[2023-11-03 13:56:10,968][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 13:56:10,969][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 13:56:10,970][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 13:56:10,970][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 13:56:10,970][__main__][INFO] - Instantiating loggers...
[2023-11-03 13:56:10,971][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 13:56:13,795][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 13:56:13,818][__main__][INFO] - Logging hyperparameters!
[2023-11-03 13:56:13,824][__main__][INFO] - Starting training!
[2023-11-03 13:57:21,631][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 67, in forward
    envelope = self.grn_envelope(envelope)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\utils.py", line 232, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (262144x48 and 9x512)
[2023-11-03 13:57:21,649][utiles.utils][INFO] - Closing loggers...
[2023-11-03 13:57:21,649][utiles.utils][INFO] - Closing wandb!
[2023-11-03 14:13:51,430][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 14:13:51,430][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 14:13:51,433][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 14:13:51,434][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 14:13:51,496][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 14:13:51,505][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 14:13:52,821][__main__][INFO] - Instantiating callbacks...
[2023-11-03 14:13:52,821][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 14:13:52,823][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 14:13:52,824][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 14:13:52,824][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 14:13:52,825][__main__][INFO] - Instantiating loggers...
[2023-11-03 14:13:52,825][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 14:13:55,633][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 14:13:55,655][__main__][INFO] - Logging hyperparameters!
[2023-11-03 14:13:55,660][__main__][INFO] - Starting training!
[2023-11-03 14:15:02,360][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 68, in forward
    envelope = envelope.view(B, H, L//2 + 1)
RuntimeError: shape '[512, 8, 25]' is invalid for input of size 12582912
[2023-11-03 14:15:02,366][utiles.utils][INFO] - Closing loggers...
[2023-11-03 14:15:02,366][utiles.utils][INFO] - Closing wandb!
[2023-11-03 14:18:54,483][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 14:18:54,484][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 14:18:54,487][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 14:18:54,487][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 14:18:54,543][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 14:18:54,552][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 14:18:55,856][__main__][INFO] - Instantiating callbacks...
[2023-11-03 14:18:55,856][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 14:18:55,858][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 14:18:55,859][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 14:18:55,859][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 14:18:55,859][__main__][INFO] - Instantiating loggers...
[2023-11-03 14:18:55,860][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 14:18:58,669][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 14:18:58,692][__main__][INFO] - Logging hyperparameters!
[2023-11-03 14:18:58,698][__main__][INFO] - Starting training!
[2023-11-03 14:20:10,454][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 67, in forward
    phase = self.grn_phase(out_ft)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\utils.py", line 232, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: expected scalar type ComplexFloat but found Float
[2023-11-03 14:20:10,460][utiles.utils][INFO] - Closing loggers...
[2023-11-03 14:20:10,460][utiles.utils][INFO] - Closing wandb!
[2023-11-03 14:48:25,754][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 14:48:25,754][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 14:48:25,758][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 14:48:25,758][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 14:48:25,820][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 14:48:25,829][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 14:48:27,142][__main__][INFO] - Instantiating callbacks...
[2023-11-03 14:48:27,142][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 14:48:27,144][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 14:48:27,145][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 14:48:27,145][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 14:48:27,145][__main__][INFO] - Instantiating loggers...
[2023-11-03 14:48:27,145][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 14:48:29,976][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 14:48:29,999][__main__][INFO] - Logging hyperparameters!
[2023-11-03 14:48:30,005][__main__][INFO] - Starting training!
[2023-11-03 14:49:42,548][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 71, in forward
    x_ft_reconstructed[..., x_ft.size(-1) // 2 + 1:] = x_ft_neg
RuntimeError: expand(CUDAComplexFloatType{[512, 8, 64, 23]}, size=[512, 48, 487]): the number of sizes provided (3) must be greater or equal to the number of dimensions in the tensor (4)
[2023-11-03 14:49:42,556][utiles.utils][INFO] - Closing loggers...
[2023-11-03 14:49:42,558][utiles.utils][INFO] - Closing wandb!
[2023-11-03 14:53:38,686][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 14:53:38,686][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 14:53:38,691][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 14:53:38,691][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 14:53:38,755][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 14:53:38,765][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 14:53:40,189][__main__][INFO] - Instantiating callbacks...
[2023-11-03 14:53:40,189][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 14:53:40,191][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 14:53:40,192][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 14:53:40,193][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 14:53:40,193][__main__][INFO] - Instantiating loggers...
[2023-11-03 14:53:40,193][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 14:53:42,998][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 14:53:43,022][__main__][INFO] - Logging hyperparameters!
[2023-11-03 14:53:43,030][__main__][INFO] - Starting training!
[2023-11-03 14:55:00,378][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 214, in forward
    backcast_block, forecast_block = block(backcast)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\NeuralBasis_Decomp.py", line 113, in forward
    x = super().forward(x)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\NeuralBasis_Decomp.py", line 63, in forward
    return self.fc(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (512x48 and 96x1024)
[2023-11-03 14:55:00,404][utiles.utils][INFO] - Closing loggers...
[2023-11-03 14:55:00,404][utiles.utils][INFO] - Closing wandb!
[2023-11-03 15:39:01,607][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 15:39:01,608][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 15:39:01,611][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 15:39:01,611][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 15:39:01,667][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 15:39:01,677][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 15:39:02,987][__main__][INFO] - Instantiating callbacks...
[2023-11-03 15:39:02,988][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 15:39:02,990][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 15:39:02,990][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 15:39:02,991][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 15:39:02,991][__main__][INFO] - Instantiating loggers...
[2023-11-03 15:39:02,991][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 15:39:05,833][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 15:39:05,855][__main__][INFO] - Logging hyperparameters!
[2023-11-03 15:39:05,861][__main__][INFO] - Starting training!
[2023-11-03 15:40:13,144][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 92, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 203, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 64, in forward
    envelope = self.grn_envelope(envelope)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\utils.py", line 232, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (262144x96 and 48x512)
[2023-11-03 15:40:13,149][utiles.utils][INFO] - Closing loggers...
[2023-11-03 15:40:13,149][utiles.utils][INFO] - Closing wandb!
[2023-11-03 15:41:14,448][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 15:41:14,448][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 15:41:14,451][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 15:41:14,452][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 15:41:14,514][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 15:41:14,522][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 15:41:15,827][__main__][INFO] - Instantiating callbacks...
[2023-11-03 15:41:15,828][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 15:41:15,830][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 15:41:15,830][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 15:41:15,830][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 15:41:15,832][__main__][INFO] - Instantiating loggers...
[2023-11-03 15:41:15,832][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 15:41:18,711][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 15:41:18,739][__main__][INFO] - Logging hyperparameters!
[2023-11-03 15:41:18,746][__main__][INFO] - Starting training!
[2023-11-03 15:42:26,629][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 96, in forward
    seasonal_forecasting = self.Layernorm(nonstationary_forecasting)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 20, in forward
    x_hat = self.layernorm(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\normalization.py", line 190, in forward
    return F.layer_norm(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 2515, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
RuntimeError: Given normalized_shape=[512], expected input with shape [*, 512], but got input of size[512, 48, 1]
[2023-11-03 15:42:26,648][utiles.utils][INFO] - Closing loggers...
[2023-11-03 15:42:26,648][utiles.utils][INFO] - Closing wandb!
[2023-11-03 15:45:34,613][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 15:45:34,614][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 15:45:34,617][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 15:45:34,617][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 15:45:34,677][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 15:45:34,687][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 15:45:35,980][__main__][INFO] - Instantiating callbacks...
[2023-11-03 15:45:35,980][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 15:45:35,982][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 15:45:35,983][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 15:45:35,984][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 15:45:35,984][__main__][INFO] - Instantiating loggers...
[2023-11-03 15:45:35,984][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 15:45:38,725][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 15:45:38,749][__main__][INFO] - Logging hyperparameters!
[2023-11-03 15:45:38,756][__main__][INFO] - Starting training!
[2023-11-03 15:46:48,528][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 116, in validation_step
    outputs = outputs[:, -self.model.pred_len:, ghi_id]  # 0 is the index of the target variable GHI , 8 is the index of the target variable DHI
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1269, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'Model' object has no attribute 'pred_len'
[2023-11-03 15:46:48,532][utiles.utils][INFO] - Closing loggers...
[2023-11-03 15:46:48,532][utiles.utils][INFO] - Closing wandb!
[2023-11-03 15:48:44,601][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 15:48:44,601][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 15:48:44,605][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 15:48:44,605][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 15:48:44,667][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 15:48:44,677][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 15:48:46,090][__main__][INFO] - Instantiating callbacks...
[2023-11-03 15:48:46,090][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 15:48:46,092][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 15:48:46,093][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 15:48:46,094][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 15:48:46,094][__main__][INFO] - Instantiating loggers...
[2023-11-03 15:48:46,094][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 15:48:48,927][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 15:48:48,952][__main__][INFO] - Logging hyperparameters!
[2023-11-03 15:48:48,959][__main__][INFO] - Starting training!
[2023-11-03 15:49:58,357][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 116, in validation_step
    outputs = outputs[:, -self.model.pred_len:, ghi_id]  # 0 is the index of the target variable GHI , 8 is the index of the target variable DHI
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1269, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'Model' object has no attribute 'pred_len'
[2023-11-03 15:49:58,359][utiles.utils][INFO] - Closing loggers...
[2023-11-03 15:49:58,360][utiles.utils][INFO] - Closing wandb!
[2023-11-03 15:50:31,400][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 15:50:31,400][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 15:50:31,403][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 15:50:31,404][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 15:50:31,461][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 15:50:31,471][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 15:50:32,849][__main__][INFO] - Instantiating callbacks...
[2023-11-03 15:50:32,849][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 15:50:32,851][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 15:50:32,851][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 15:50:32,853][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 15:50:32,853][__main__][INFO] - Instantiating loggers...
[2023-11-03 15:50:32,853][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 15:50:35,713][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 15:50:35,739][__main__][INFO] - Logging hyperparameters!
[2023-11-03 15:50:35,745][__main__][INFO] - Starting training!
[2023-11-03 15:51:49,310][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 116, in validation_step
    outputs = outputs[:, -self.model.forecast_length:, ghi_id]  # 0 is the index of the target variable GHI , 8 is the index of the target variable DHI
IndexError: too many indices for tensor of dimension 2
[2023-11-03 15:51:49,357][utiles.utils][INFO] - Closing loggers...
[2023-11-03 15:51:49,357][utiles.utils][INFO] - Closing wandb!
[2023-11-03 15:54:39,338][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 15:54:39,338][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 15:54:39,342][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 15:54:39,342][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 15:54:39,437][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 15:54:39,446][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 15:54:40,943][__main__][INFO] - Instantiating callbacks...
[2023-11-03 15:54:40,943][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 15:54:40,945][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 15:54:40,946][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 15:54:40,946][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 15:54:40,946][__main__][INFO] - Instantiating loggers...
[2023-11-03 15:54:40,947][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 15:54:43,893][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 15:54:43,916][__main__][INFO] - Logging hyperparameters!
[2023-11-03 15:54:43,922][__main__][INFO] - Starting training!
[2023-11-03 15:56:43,269][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 15:56:43,269][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 15:56:43,272][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 15:56:43,272][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 15:56:43,333][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 15:56:43,342][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 15:56:44,690][__main__][INFO] - Instantiating callbacks...
[2023-11-03 15:56:44,690][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 15:56:44,693][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 15:56:44,694][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 15:56:44,694][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 15:56:44,695][__main__][INFO] - Instantiating loggers...
[2023-11-03 15:56:44,695][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 15:56:47,486][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 15:56:47,510][__main__][INFO] - Logging hyperparameters!
[2023-11-03 15:56:47,516][__main__][INFO] - Starting training!
[2023-11-03 16:00:07,627][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1200, in _run_train
    self.fit_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\training_epoch_loop.py", line 214, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\batch\training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 200, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 247, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 357, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\module.py", line 1661, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 121, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\autograd\grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\adamw.py", line 120, in step
    loss = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 107, in _wrap_closure
    closure_result = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 147, in __call__
    self._result = self.closure(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 133, in closure
    step_output = self._step_fn()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 406, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 88, in training_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 93, in forward
    seasonal_forecasting, _, _ = self.Low_FrequencyBlock(x_LowF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 298, in forward
    backcast_block, forecast_block = block(backcast)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\NeuralBasis_Decomp.py", line 174, in forward
    x = super().forward(x)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\NeuralBasis_Decomp.py", line 63, in forward
    return self.fc(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 11.99 GiB total capacity; 41.27 GiB already allocated; 0 bytes free; 41.32 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 63, in _call_and_handle_interrupt
    trainer._teardown()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1161, in _teardown
    self.strategy.teardown()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 496, in teardown
    self.lightning_module.cpu()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\lightning_lite\utilities\device_dtype_mixin.py", line 78, in cpu
    return super().cpu()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 798, in cpu
    return self._apply(lambda t: t.cpu())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 641, in _apply
    module._apply(fn)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 641, in _apply
    module._apply(fn)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 664, in _apply
    param_applied = fn(param)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 798, in <lambda>
    return self._apply(lambda t: t.cpu())
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
[2023-11-03 16:00:07,784][utiles.utils][INFO] - Closing loggers...
[2023-11-03 16:00:07,784][utiles.utils][INFO] - Closing wandb!
[2023-11-03 16:00:30,558][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:00:30,559][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:00:30,562][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:00:30,562][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:00:30,620][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:00:30,630][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 16:00:31,945][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:00:31,945][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:00:31,947][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:00:31,948][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:00:31,948][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:00:31,948][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:00:31,949][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:00:34,686][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:00:34,710][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:00:34,716][__main__][INFO] - Starting training!
[2023-11-03 16:01:58,125][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1200, in _run_train
    self.fit_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\training_epoch_loop.py", line 214, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\batch\training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 200, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 247, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 357, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\module.py", line 1661, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 121, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\autograd\grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\adamw.py", line 120, in step
    loss = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 107, in _wrap_closure
    closure_result = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 147, in __call__
    self._result = self.closure(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 133, in closure
    step_output = self._step_fn()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 406, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 93, in training_step
    loss = self.criterion(outputs, batch_y)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\loss.py", line 536, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 3291, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 74, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (48) must match the size of tensor b (9) at non-singleton dimension 2
[2023-11-03 16:01:58,141][utiles.utils][INFO] - Closing loggers...
[2023-11-03 16:01:58,141][utiles.utils][INFO] - Closing wandb!
[2023-11-03 16:05:05,219][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:05:05,219][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:05:05,223][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:05:05,223][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:05:05,289][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:05:05,300][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 16:05:06,719][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:05:06,720][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:05:06,722][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:05:06,722][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:05:06,723][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:05:06,723][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:05:06,723][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:05:09,473][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:05:09,497][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:05:09,503][__main__][INFO] - Starting training!
[2023-11-03 16:06:36,503][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1200, in _run_train
    self.fit_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\training_epoch_loop.py", line 214, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\batch\training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 200, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 247, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 357, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\module.py", line 1661, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 121, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\autograd\grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\adamw.py", line 120, in step
    loss = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 107, in _wrap_closure
    closure_result = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 147, in __call__
    self._result = self.closure(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 133, in closure
    step_output = self._step_fn()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 406, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 93, in training_step
    loss = self.criterion(outputs, batch_y)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\loss.py", line 536, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 3291, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 74, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (48) must match the size of tensor b (9) at non-singleton dimension 2
[2023-11-03 16:06:36,510][utiles.utils][INFO] - Closing loggers...
[2023-11-03 16:06:36,511][utiles.utils][INFO] - Closing wandb!
[2023-11-03 16:08:30,417][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:08:30,417][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:08:30,420][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:08:30,421][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:08:30,482][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:08:30,490][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 16:08:31,937][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:08:31,937][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:08:31,940][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:08:31,940][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:08:31,941][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:08:31,941][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:08:31,941][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:08:34,765][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:08:34,789][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:08:34,795][__main__][INFO] - Starting training!
[2023-11-03 16:09:56,233][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1200, in _run_train
    self.fit_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\training_epoch_loop.py", line 214, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\batch\training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 200, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 247, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 357, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\module.py", line 1661, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 121, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\autograd\grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\adamw.py", line 120, in step
    loss = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 107, in _wrap_closure
    closure_result = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 147, in __call__
    self._result = self.closure(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 133, in closure
    step_output = self._step_fn()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 406, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 93, in training_step
    loss = self.criterion(outputs, batch_y)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\loss.py", line 536, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 3291, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 74, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (48) must match the size of tensor b (9) at non-singleton dimension 2
[2023-11-03 16:09:56,242][utiles.utils][INFO] - Closing loggers...
[2023-11-03 16:09:56,242][utiles.utils][INFO] - Closing wandb!
[2023-11-03 16:12:32,797][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:12:32,798][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:12:32,801][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:12:32,801][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:12:32,862][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:12:32,870][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 16:12:34,193][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:12:34,193][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:12:34,195][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:12:34,196][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:12:34,196][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:12:34,196][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:12:34,197][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:12:37,067][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:12:37,093][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:12:37,101][__main__][INFO] - Starting training!
[2023-11-03 16:13:55,466][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1200, in _run_train
    self.fit_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\training_epoch_loop.py", line 214, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\batch\training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 200, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 247, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 357, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\module.py", line 1661, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 121, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\autograd\grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\adamw.py", line 120, in step
    loss = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 107, in _wrap_closure
    closure_result = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 147, in __call__
    self._result = self.closure(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 133, in closure
    step_output = self._step_fn()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 406, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 93, in training_step
    loss = self.criterion(outputs, batch_y)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\loss.py", line 536, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 3291, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 74, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (48) must match the size of tensor b (9) at non-singleton dimension 2
[2023-11-03 16:13:55,470][utiles.utils][INFO] - Closing loggers...
[2023-11-03 16:13:55,470][utiles.utils][INFO] - Closing wandb!
[2023-11-03 16:14:53,573][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:14:53,573][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:14:53,576][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:14:53,577][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:14:53,634][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:14:53,644][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 16:14:54,964][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:14:54,964][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:14:54,967][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:14:54,967][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:14:54,968][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:14:54,968][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:14:54,968][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:14:57,817][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:14:57,842][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:14:57,848][__main__][INFO] - Starting training!
[2023-11-03 16:16:17,720][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1200, in _run_train
    self.fit_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\training_epoch_loop.py", line 214, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\batch\training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 200, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 247, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 357, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\module.py", line 1661, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 121, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\autograd\grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\adamw.py", line 120, in step
    loss = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 107, in _wrap_closure
    closure_result = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 147, in __call__
    self._result = self.closure(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 133, in closure
    step_output = self._step_fn()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 406, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 93, in training_step
    loss = self.criterion(outputs, batch_y)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\loss.py", line 536, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 3291, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 74, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (48) must match the size of tensor b (9) at non-singleton dimension 2
[2023-11-03 16:16:17,729][utiles.utils][INFO] - Closing loggers...
[2023-11-03 16:16:17,729][utiles.utils][INFO] - Closing wandb!
[2023-11-03 16:18:14,307][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:18:14,307][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:18:14,310][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:18:14,311][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:18:14,371][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:18:14,388][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 16:18:15,754][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:18:15,754][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:18:15,756][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:18:15,757][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:18:15,757][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:18:15,757][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:18:15,758][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:18:18,572][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:18:18,596][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:18:18,603][__main__][INFO] - Starting training!
[2023-11-03 16:20:41,068][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:20:41,068][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:20:41,080][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:20:41,080][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:20:41,355][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:20:41,390][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 16:20:42,949][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:20:42,949][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:20:42,954][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:20:42,957][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:20:42,958][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:20:42,959][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:20:42,959][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:20:46,722][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:20:46,772][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:20:46,798][__main__][INFO] - Starting training!
[2023-11-03 16:27:01,579][__main__][INFO] - Best model ckpt at 
[2023-11-03 16:27:01,579][__main__][INFO] - Starting testing!
[2023-11-03 16:27:01,580][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-03 16:27:13,434][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:27:13,435][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:27:13,439][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:27:13,440][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:27:13,498][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:27:13,507][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 16:27:14,272][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:27:14,273][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:27:14,275][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:27:14,275][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:27:14,276][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:27:14,276][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:27:14,276][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:27:17,158][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:27:17,183][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:27:17,189][__main__][INFO] - Starting training!
[2023-11-03 16:27:45,903][__main__][INFO] - Best model ckpt at 
[2023-11-03 16:27:45,904][__main__][INFO] - Starting testing!
[2023-11-03 16:27:45,904][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-03 16:28:20,719][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:28:20,719][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:28:20,722][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:28:20,722][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:28:20,782][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:28:20,797][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 16:28:21,467][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:28:21,467][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:28:21,469][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:28:21,470][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:28:21,470][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:28:21,470][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:28:21,472][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:28:24,250][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:28:24,275][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:28:24,280][__main__][INFO] - Starting training!
[2023-11-03 16:29:00,529][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 163, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 60, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 161, in forward
    dec_out = self.dec_embedding(seasonal_init, x_mark_dec)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Embed.py", line 124, in forward
    x = self.value_embedding(
RuntimeError: The size of tensor a (96) must match the size of tensor b (144) at non-singleton dimension 1
[2023-11-03 16:29:00,544][utiles.utils][INFO] - Closing loggers...
[2023-11-03 16:29:00,544][utiles.utils][INFO] - Closing wandb!
[2023-11-03 16:29:25,297][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:29:25,297][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:29:25,301][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:29:25,301][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:29:25,365][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:29:25,375][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 16:29:26,057][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:29:26,057][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:29:26,059][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:29:26,060][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:29:26,060][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:29:26,060][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:29:26,060][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:29:28,884][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:29:28,907][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:29:28,914][__main__][INFO] - Starting training!
[2023-11-03 16:30:04,925][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 163, in validation_step
    outputs = self(batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\pl_baselines.py", line 60, in forward
    outputs = self.model(batch_x, batch_x_mark, decoder_input, batch_y_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\baseline_models\FEDformer.py", line 161, in forward
    dec_out = self.dec_embedding(seasonal_init, x_mark_dec)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Embed.py", line 124, in forward
    x = self.value_embedding(
RuntimeError: The size of tensor a (96) must match the size of tensor b (144) at non-singleton dimension 1
[2023-11-03 16:30:04,929][utiles.utils][INFO] - Closing loggers...
[2023-11-03 16:30:04,929][utiles.utils][INFO] - Closing wandb!
[2023-11-03 16:32:58,716][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:32:58,716][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:32:58,720][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:32:58,720][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:32:58,776][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:32:58,784][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 16:32:59,462][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:32:59,462][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:32:59,464][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:32:59,465][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:32:59,465][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:32:59,465][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:32:59,465][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:33:02,316][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:33:02,340][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:33:02,346][__main__][INFO] - Starting training!
[2023-11-03 16:34:10,973][__main__][INFO] - Best model ckpt at 
[2023-11-03 16:34:10,974][__main__][INFO] - Starting testing!
[2023-11-03 16:34:10,974][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-03 16:37:19,105][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:37:19,106][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:37:19,109][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:37:19,110][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:37:19,170][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:37:19,179][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 16:37:20,522][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:37:20,522][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:37:20,523][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:37:20,524][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:37:20,525][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:37:20,525][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:37:20,525][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:37:23,307][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:37:23,330][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:37:23,338][__main__][INFO] - Starting training!
[2023-11-03 16:40:17,420][__main__][INFO] - Best model ckpt at 
[2023-11-03 16:40:17,420][__main__][INFO] - Starting testing!
[2023-11-03 16:40:17,420][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-03 16:55:50,958][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:55:50,959][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:55:50,962][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:55:50,962][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:55:51,023][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:55:51,032][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 16:55:52,446][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:55:52,446][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:55:52,448][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:55:52,449][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:55:52,449][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:55:52,449][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:55:52,449][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:55:55,270][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:55:55,295][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:55:55,301][__main__][INFO] - Starting training!
[2023-11-03 16:56:31,278][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 113, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 94, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 205, in forward
    target = self.conv(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 313, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 309, in _conv_forward
    return F.conv1d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [16, 512, 1], expected input[128, 48, 512] to have 512 channels, but got 48 channels instead
[2023-11-03 16:56:31,290][utiles.utils][INFO] - Closing loggers...
[2023-11-03 16:56:31,290][utiles.utils][INFO] - Closing wandb!
[2023-11-03 16:57:38,093][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 16:57:38,093][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 16:57:38,097][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 16:57:38,097][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 16:57:38,157][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 16:57:38,168][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 16:57:39,545][__main__][INFO] - Instantiating callbacks...
[2023-11-03 16:57:39,546][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 16:57:39,548][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 16:57:39,549][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 16:57:39,549][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 16:57:39,549][__main__][INFO] - Instantiating loggers...
[2023-11-03 16:57:39,550][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 16:57:42,337][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 16:57:42,362][__main__][INFO] - Logging hyperparameters!
[2023-11-03 16:57:42,368][__main__][INFO] - Starting training!
[2023-11-03 16:58:19,361][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 113, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 94, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 206, in forward
    target = self.conv(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 313, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 309, in _conv_forward
    return F.conv1d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [16, 512, 1], expected input[128, 48, 512] to have 512 channels, but got 48 channels instead
[2023-11-03 16:58:19,368][utiles.utils][INFO] - Closing loggers...
[2023-11-03 16:58:19,369][utiles.utils][INFO] - Closing wandb!
[2023-11-03 17:02:29,334][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 17:02:29,334][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 17:02:29,338][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 17:02:29,338][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 17:02:29,398][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 17:02:29,407][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 17:02:30,731][__main__][INFO] - Instantiating callbacks...
[2023-11-03 17:02:30,731][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 17:02:30,733][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 17:02:30,734][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 17:02:30,734][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 17:02:30,734][__main__][INFO] - Instantiating loggers...
[2023-11-03 17:02:30,734][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 17:02:33,589][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 17:02:33,615][__main__][INFO] - Logging hyperparameters!
[2023-11-03 17:02:33,621][__main__][INFO] - Starting training!
[2023-11-03 17:03:52,603][__main__][INFO] - Best model ckpt at 
[2023-11-03 17:03:52,604][__main__][INFO] - Starting testing!
[2023-11-03 17:03:52,605][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-03 17:05:36,150][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 17:05:36,150][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 17:05:36,153][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 17:05:36,154][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 17:05:36,211][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 17:05:36,221][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 17:05:37,532][__main__][INFO] - Instantiating callbacks...
[2023-11-03 17:05:37,532][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 17:05:37,534][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 17:05:37,535][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 17:05:37,535][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 17:05:37,535][__main__][INFO] - Instantiating loggers...
[2023-11-03 17:05:37,535][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 17:05:40,283][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 17:05:40,306][__main__][INFO] - Logging hyperparameters!
[2023-11-03 17:05:40,313][__main__][INFO] - Starting training!
[2023-11-03 17:49:34,183][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=000-v1.ckpt
[2023-11-03 17:49:34,184][__main__][INFO] - Starting testing!
[2023-11-03 17:51:25,933][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=000-v1.ckpt
[2023-11-03 17:51:25,936][utiles.utils][INFO] - Closing loggers...
[2023-11-03 17:51:25,936][utiles.utils][INFO] - Closing wandb!
[2023-11-03 17:51:32,241][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-11-03 17:51:32,242][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-11-03 17:57:10,925][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 17:57:10,925][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 17:57:10,928][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 17:57:10,929][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 17:57:10,989][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 17:57:10,999][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 17:57:12,340][__main__][INFO] - Instantiating callbacks...
[2023-11-03 17:57:12,341][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 17:57:12,343][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 17:57:12,344][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 17:57:12,344][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 17:57:12,344][__main__][INFO] - Instantiating loggers...
[2023-11-03 17:57:12,345][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 17:57:15,240][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 17:57:15,264][__main__][INFO] - Logging hyperparameters!
[2023-11-03 17:57:15,271][__main__][INFO] - Starting training!
[2023-11-03 17:58:42,428][__main__][INFO] - Best model ckpt at 
[2023-11-03 17:58:42,428][__main__][INFO] - Starting testing!
[2023-11-03 17:58:42,429][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-03 17:59:04,908][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 17:59:04,908][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 17:59:04,912][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 17:59:04,912][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 17:59:04,974][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 17:59:04,982][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 17:59:06,425][__main__][INFO] - Instantiating callbacks...
[2023-11-03 17:59:06,426][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 17:59:06,428][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 17:59:06,429][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 17:59:06,429][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 17:59:06,430][__main__][INFO] - Instantiating loggers...
[2023-11-03 17:59:06,430][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 17:59:09,265][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 17:59:09,290][__main__][INFO] - Logging hyperparameters!
[2023-11-03 17:59:09,297][__main__][INFO] - Starting training!
[2023-11-03 18:00:42,133][__main__][INFO] - Best model ckpt at 
[2023-11-03 18:00:42,135][__main__][INFO] - Starting testing!
[2023-11-03 18:00:42,135][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-03 18:01:02,473][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 18:01:02,473][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 18:01:02,477][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 18:01:02,477][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 18:01:02,539][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 18:01:02,552][__main__][INFO] - Instantiating model <pl_models.pl_baselines.TSForecastTask>
[2023-11-03 18:01:03,279][__main__][INFO] - Instantiating callbacks...
[2023-11-03 18:01:03,279][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 18:01:03,281][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 18:01:03,282][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 18:01:03,282][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 18:01:03,282][__main__][INFO] - Instantiating loggers...
[2023-11-03 18:01:03,283][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 18:01:06,268][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 18:01:06,294][__main__][INFO] - Logging hyperparameters!
[2023-11-03 18:01:06,301][__main__][INFO] - Starting training!
[2023-11-03 18:04:20,009][__main__][INFO] - Best model ckpt at 
[2023-11-03 18:04:20,009][__main__][INFO] - Starting testing!
[2023-11-03 18:04:20,010][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-03 18:19:52,360][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 18:19:52,361][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 18:19:52,364][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 18:19:52,364][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 18:19:52,423][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 18:19:52,431][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 18:19:53,706][__main__][INFO] - Instantiating callbacks...
[2023-11-03 18:19:53,706][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 18:19:53,708][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 18:19:53,709][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 18:19:53,710][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 18:19:53,710][__main__][INFO] - Instantiating loggers...
[2023-11-03 18:19:53,710][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 18:19:56,443][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 18:19:56,466][__main__][INFO] - Logging hyperparameters!
[2023-11-03 18:19:56,472][__main__][INFO] - Starting training!
[2023-11-03 18:20:30,059][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 113, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 94, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 206, in forward
    target = self.conv(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 313, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 309, in _conv_forward
    return F.conv1d(input, weight, bias, self.stride,
RuntimeError: Expected 2D (unbatched) or 3D (batched) input to conv1d, but got input of size: [128, 64, 8, 48]
[2023-11-03 18:20:30,065][utiles.utils][INFO] - Closing loggers...
[2023-11-03 18:20:30,065][utiles.utils][INFO] - Closing wandb!
[2023-11-03 18:21:52,561][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 18:21:52,562][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 18:21:52,565][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 18:21:52,565][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 18:21:52,622][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 18:21:52,631][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 18:21:53,888][__main__][INFO] - Instantiating callbacks...
[2023-11-03 18:21:53,888][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 18:21:53,890][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 18:21:53,891][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 18:21:53,891][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 18:21:53,891][__main__][INFO] - Instantiating loggers...
[2023-11-03 18:21:53,891][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 18:21:56,610][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 18:21:56,632][__main__][INFO] - Logging hyperparameters!
[2023-11-03 18:21:56,638][__main__][INFO] - Starting training!
[2023-11-03 18:23:45,409][__main__][INFO] - Best model ckpt at 
[2023-11-03 18:23:45,410][__main__][INFO] - Starting testing!
[2023-11-03 18:23:45,410][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-03 18:27:00,611][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 18:27:00,611][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 18:27:00,614][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 18:27:00,614][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 18:27:00,675][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 18:27:00,684][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 18:27:01,979][__main__][INFO] - Instantiating callbacks...
[2023-11-03 18:27:01,979][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 18:27:01,981][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 18:27:01,982][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 18:27:01,982][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 18:27:01,982][__main__][INFO] - Instantiating loggers...
[2023-11-03 18:27:01,982][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 18:27:04,746][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 18:27:04,772][__main__][INFO] - Logging hyperparameters!
[2023-11-03 18:27:04,778][__main__][INFO] - Starting training!
[2023-11-03 18:29:50,246][__main__][INFO] - Best model ckpt at 
[2023-11-03 18:29:50,247][__main__][INFO] - Starting testing!
[2023-11-03 18:29:50,247][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-03 18:30:03,185][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 18:30:03,186][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 18:30:03,189][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 18:30:03,189][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 18:30:03,249][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 18:30:03,259][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 18:30:04,495][__main__][INFO] - Instantiating callbacks...
[2023-11-03 18:30:04,495][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 18:30:04,497][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 18:30:04,498][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 18:30:04,498][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 18:30:04,498][__main__][INFO] - Instantiating loggers...
[2023-11-03 18:30:04,498][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 18:30:07,433][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 18:30:07,457][__main__][INFO] - Logging hyperparameters!
[2023-11-03 18:30:07,463][__main__][INFO] - Starting training!
[2023-11-03 20:31:14,034][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=000-v2.ckpt
[2023-11-03 20:31:14,035][__main__][INFO] - Starting testing!
[2023-11-03 20:33:11,122][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=000-v2.ckpt
[2023-11-03 20:33:11,124][utiles.utils][INFO] - Closing loggers...
[2023-11-03 20:33:11,124][utiles.utils][INFO] - Closing wandb!
[2023-11-03 20:33:18,615][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-11-03 20:33:18,615][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-11-03 21:00:39,040][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 21:00:39,040][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 21:00:39,044][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 21:00:39,045][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 21:00:39,148][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 21:00:39,158][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 21:00:40,918][__main__][INFO] - Instantiating callbacks...
[2023-11-03 21:00:40,918][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 21:00:40,920][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 21:00:40,921][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 21:00:40,922][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 21:00:40,922][__main__][INFO] - Instantiating loggers...
[2023-11-03 21:00:40,922][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 21:00:43,992][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 21:00:44,032][__main__][INFO] - Logging hyperparameters!
[2023-11-03 21:00:44,045][__main__][INFO] - Starting training!
[2023-11-03 21:02:02,391][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 113, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 94, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x_HighF)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 204, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 63, in forward
    envelope = self.grn_envelope(envelope)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1269, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'HilbertBlock' object has no attribute 'grn_envelope'
[2023-11-03 21:02:02,471][utiles.utils][INFO] - Closing loggers...
[2023-11-03 21:02:02,472][utiles.utils][INFO] - Closing wandb!
[2023-11-03 21:02:48,009][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-03 21:02:48,009][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-03 21:02:48,012][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-03 21:02:48,013][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-03 21:02:48,075][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-03 21:02:48,085][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-03 21:02:49,501][__main__][INFO] - Instantiating callbacks...
[2023-11-03 21:02:49,501][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-03 21:02:49,503][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-03 21:02:49,504][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-03 21:02:49,504][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-03 21:02:49,505][__main__][INFO] - Instantiating loggers...
[2023-11-03 21:02:49,505][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-03 21:02:52,346][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-03 21:02:52,372][__main__][INFO] - Logging hyperparameters!
[2023-11-03 21:02:52,378][__main__][INFO] - Starting training!
[2023-11-03 23:13:13,286][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=000-v3.ckpt
[2023-11-03 23:13:13,287][__main__][INFO] - Starting testing!
[2023-11-03 23:14:56,199][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=000-v3.ckpt
[2023-11-03 23:14:56,201][utiles.utils][INFO] - Closing loggers...
[2023-11-03 23:14:56,202][utiles.utils][INFO] - Closing wandb!
[2023-11-03 23:15:03,898][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-11-03 23:15:03,898][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-11-16 21:09:52,207][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-16 21:09:52,208][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-16 21:09:52,213][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-16 21:09:52,213][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-16 21:09:52,353][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-16 21:09:52,369][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-16 21:09:57,439][__main__][INFO] - Instantiating callbacks...
[2023-11-16 21:09:57,439][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-16 21:09:57,442][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-16 21:09:57,442][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-16 21:09:57,443][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-16 21:09:57,443][__main__][INFO] - Instantiating loggers...
[2023-11-16 21:09:57,443][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-16 21:10:00,653][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-16 21:10:00,686][__main__][INFO] - Logging hyperparameters!
[2023-11-16 21:10:00,695][__main__][INFO] - Starting training!
[2023-11-16 21:13:32,576][__main__][INFO] - Best model ckpt at 
[2023-11-16 21:13:32,576][__main__][INFO] - Starting testing!
[2023-11-16 21:13:32,576][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-16 21:16:20,531][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-16 21:16:20,531][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-16 21:16:20,535][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-16 21:16:20,535][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-16 21:16:20,597][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-16 21:16:20,607][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-16 21:16:21,987][__main__][INFO] - Instantiating callbacks...
[2023-11-16 21:16:21,987][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-16 21:16:21,990][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-16 21:16:21,990][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-16 21:16:21,991][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-16 21:16:21,991][__main__][INFO] - Instantiating loggers...
[2023-11-16 21:16:21,991][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-16 21:16:24,825][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-16 21:16:24,850][__main__][INFO] - Logging hyperparameters!
[2023-11-16 21:16:24,858][__main__][INFO] - Starting training!
[2023-11-16 23:17:24,956][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=000-v4.ckpt
[2023-11-16 23:17:24,956][__main__][INFO] - Starting testing!
[2023-11-16 23:19:02,534][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=000-v4.ckpt
[2023-11-16 23:19:02,535][utiles.utils][INFO] - Closing loggers...
[2023-11-16 23:19:02,535][utiles.utils][INFO] - Closing wandb!
[2023-11-16 23:19:09,236][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-11-16 23:19:09,237][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-11-18 11:10:02,607][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:10:02,607][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:10:02,610][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:10:02,611][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:10:02,713][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:10:02,724][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:10:05,031][__main__][INFO] - Instantiating callbacks...
[2023-11-18 11:10:05,032][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 11:10:05,034][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 11:10:05,035][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 11:10:05,035][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 11:10:05,035][__main__][INFO] - Instantiating loggers...
[2023-11-18 11:10:05,035][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 11:10:07,933][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 11:10:07,955][__main__][INFO] - Logging hyperparameters!
[2023-11-18 11:10:07,961][__main__][INFO] - Starting training!
[2023-11-18 11:10:43,932][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 113, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 91, in forward
    x_HighF = self.enc_embedding(x, x_timestamp)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Embed.py", line 124, in forward
    x = self.value_embedding(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\Embed.py", line 41, in forward
    x = self.tokenConv(x.permute(0, 2, 1)).transpose(1, 2)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 313, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 306, in _conv_forward
    return F.conv1d(F.pad(input, self._reversed_padding_repeated_twice, mode=self.padding_mode),
RuntimeError: Given groups=1, weight of size [512, 9, 3], expected input[128, 7, 146] to have 9 channels, but got 7 channels instead
[2023-11-18 11:10:43,995][utiles.utils][INFO] - Closing loggers...
[2023-11-18 11:10:43,995][utiles.utils][INFO] - Closing wandb!
[2023-11-18 11:14:19,224][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:14:19,225][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:14:19,228][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:14:19,228][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:14:19,285][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:14:19,293][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:14:20,614][__main__][INFO] - Instantiating callbacks...
[2023-11-18 11:14:20,614][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 11:14:20,616][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 11:14:20,617][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 11:14:20,618][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 11:14:20,618][__main__][INFO] - Instantiating loggers...
[2023-11-18 11:14:20,618][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 11:14:23,484][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 11:14:23,505][__main__][INFO] - Logging hyperparameters!
[2023-11-18 11:14:23,511][__main__][INFO] - Starting training!
[2023-11-18 11:15:00,530][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 113, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 96, in forward
    nonstationary_forecasting = self.Layernorm(nonstationary_forecasting)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 20, in forward
    x_hat = self.layernorm(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\normalization.py", line 190, in forward
    return F.layer_norm(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 2515, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
RuntimeError: Given normalized_shape=[512], expected input with shape [*, 512], but got input of size[128, 144, 16]
[2023-11-18 11:15:00,549][utiles.utils][INFO] - Closing loggers...
[2023-11-18 11:15:00,549][utiles.utils][INFO] - Closing wandb!
[2023-11-18 11:18:43,326][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:18:43,326][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:18:43,328][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:18:43,328][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:18:43,386][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:18:43,395][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:18:44,706][__main__][INFO] - Instantiating callbacks...
[2023-11-18 11:18:44,706][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 11:18:44,708][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 11:18:44,709][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 11:18:44,709][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 11:18:44,710][__main__][INFO] - Instantiating loggers...
[2023-11-18 11:18:44,710][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 11:18:47,398][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 11:18:47,419][__main__][INFO] - Logging hyperparameters!
[2023-11-18 11:18:47,425][__main__][INFO] - Starting training!
[2023-11-18 11:19:22,480][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 113, in validation_step
    outputs = self(batch_x, batch_x_mark).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x, batch_x_mark)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 96, in forward
    nonstationary_forecasting = self.Layernorm(nonstationary_forecasting)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 20, in forward
    x_hat = self.layernorm(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\normalization.py", line 190, in forward
    return F.layer_norm(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 2515, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
RuntimeError: Given normalized_shape=[128], expected input with shape [*, 128], but got input of size[128, 144, 16]
[2023-11-18 11:19:22,484][utiles.utils][INFO] - Closing loggers...
[2023-11-18 11:19:22,484][utiles.utils][INFO] - Closing wandb!
[2023-11-18 11:21:33,384][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:21:33,385][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:21:33,388][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:21:33,388][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:21:33,445][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:21:33,455][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:21:33,964][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 85, in __init__
    self.projection = nn.Linear(self.hidden_size, self.c_out, bias=True)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 96, in __init__
    self.weight = Parameter(torch.empty((out_features, in_features), **factory_kwargs))
TypeError: empty(): argument 'size' must be tuple of SymInts, but found element of type list at pos 2

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.HFANformer.Model':
TypeError("empty(): argument 'size' must be tuple of SymInts, but found element of type list at pos 2")
full_key: pl_module.model
[2023-11-18 11:21:33,978][utiles.utils][INFO] - Closing loggers...
[2023-11-18 11:22:10,757][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:22:10,757][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:22:10,761][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:22:10,761][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:22:10,816][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:22:10,824][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:22:12,121][__main__][INFO] - Instantiating callbacks...
[2023-11-18 11:22:12,122][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 11:22:12,124][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 11:22:12,125][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 11:22:12,125][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 11:22:12,125][__main__][INFO] - Instantiating loggers...
[2023-11-18 11:22:12,125][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 11:22:14,921][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 11:22:14,945][__main__][INFO] - Logging hyperparameters!
[2023-11-18 11:22:14,951][__main__][INFO] - Starting training!
[2023-11-18 11:22:52,801][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 114, in validation_step
    outputs = outputs[:, -self.model.forecast_length:, ghi_id]  # 0 is the index of the target variable GHI , 8 is the index of the target variable DHI
IndexError: index 8 is out of bounds for dimension 2 with size 7
[2023-11-18 11:22:52,804][utiles.utils][INFO] - Closing loggers...
[2023-11-18 11:22:52,805][utiles.utils][INFO] - Closing wandb!
[2023-11-18 11:29:01,257][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:29:01,258][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:29:01,262][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:29:01,262][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:29:01,320][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:29:01,328][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:29:02,774][__main__][INFO] - Instantiating callbacks...
[2023-11-18 11:29:02,775][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 11:29:02,776][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 11:29:02,778][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 11:29:02,779][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 11:29:02,779][__main__][INFO] - Instantiating loggers...
[2023-11-18 11:29:02,779][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 11:29:05,461][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 11:29:05,484][__main__][INFO] - Logging hyperparameters!
[2023-11-18 11:29:05,491][__main__][INFO] - Starting training!
[2023-11-18 11:29:43,459][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 115, in validation_step
    outputs = outputs[:, -self.model.forecast_length:, ghi_id]  # 0 is the index of the target variable GHI , 8 is the index of the target variable DHI
IndexError: index 8 is out of bounds for dimension 2 with size 7
[2023-11-18 11:29:43,462][utiles.utils][INFO] - Closing loggers...
[2023-11-18 11:29:43,462][utiles.utils][INFO] - Closing wandb!
[2023-11-18 11:31:03,855][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:31:03,855][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:31:03,859][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:31:03,859][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:31:03,923][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:31:03,932][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:31:05,302][__main__][INFO] - Instantiating callbacks...
[2023-11-18 11:31:05,302][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 11:31:05,304][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 11:31:05,305][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 11:31:05,305][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 11:31:05,305][__main__][INFO] - Instantiating loggers...
[2023-11-18 11:31:05,305][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 11:31:08,111][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 11:31:08,133][__main__][INFO] - Logging hyperparameters!
[2023-11-18 11:31:08,139][__main__][INFO] - Starting training!
[2023-11-18 11:31:47,013][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 116, in validation_step
    outputs = outputs[:, -self.model.forecast_length:, ghi_id]  # 0 is the index of the target variable GHI , 8 is the index of the target variable DHI
IndexError: index 8 is out of bounds for dimension 2 with size 7
[2023-11-18 11:31:47,015][utiles.utils][INFO] - Closing loggers...
[2023-11-18 11:31:47,015][utiles.utils][INFO] - Closing wandb!
[2023-11-18 11:34:44,282][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:34:44,283][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:34:44,286][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:34:44,286][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:34:44,342][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:34:44,353][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:34:45,747][__main__][INFO] - Instantiating callbacks...
[2023-11-18 11:34:45,747][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 11:34:45,749][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 11:34:45,750][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 11:34:45,750][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 11:34:45,751][__main__][INFO] - Instantiating loggers...
[2023-11-18 11:34:45,751][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 11:34:48,617][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 11:34:48,641][__main__][INFO] - Logging hyperparameters!
[2023-11-18 11:34:48,647][__main__][INFO] - Starting training!
[2023-11-18 11:35:13,016][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 216, in __getitem__
    print("ghi shape:", return_tensors["ghi"].shape)
AttributeError: 'int' object has no attribute 'shape'

[2023-11-18 11:35:13,055][utiles.utils][INFO] - Closing loggers...
[2023-11-18 11:35:13,055][utiles.utils][INFO] - Closing wandb!
[2023-11-18 11:36:37,457][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:36:37,457][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:36:37,469][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:36:37,469][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:36:37,740][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:36:37,767][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:36:39,376][__main__][INFO] - Instantiating callbacks...
[2023-11-18 11:36:39,376][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 11:36:39,382][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 11:36:39,384][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 11:36:39,385][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 11:36:39,385][__main__][INFO] - Instantiating loggers...
[2023-11-18 11:36:39,386][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 11:36:42,884][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 11:36:42,935][__main__][INFO] - Logging hyperparameters!
[2023-11-18 11:36:42,959][__main__][INFO] - Starting training!
[2023-11-18 11:40:23,738][__main__][INFO] - Best model ckpt at 
[2023-11-18 11:40:23,739][__main__][INFO] - Starting testing!
[2023-11-18 11:40:23,739][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-18 11:40:35,102][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:40:35,102][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:40:35,106][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:40:35,107][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:40:35,169][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:40:35,179][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:40:36,598][__main__][INFO] - Instantiating callbacks...
[2023-11-18 11:40:36,599][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 11:40:36,601][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 11:40:36,601][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 11:40:36,602][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 11:40:36,602][__main__][INFO] - Instantiating loggers...
[2023-11-18 11:40:36,602][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 11:40:39,277][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 11:40:39,300][__main__][INFO] - Logging hyperparameters!
[2023-11-18 11:40:39,307][__main__][INFO] - Starting training!
[2023-11-18 11:41:01,953][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\timeseries_data.py", line 216, in __getitem__
    print("ghi shape:", return_tensors["ghi"].shape)
AttributeError: 'int' object has no attribute 'shape'

[2023-11-18 11:41:01,961][utiles.utils][INFO] - Closing loggers...
[2023-11-18 11:41:01,961][utiles.utils][INFO] - Closing wandb!
[2023-11-18 11:41:22,341][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:41:22,341][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:41:22,344][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:41:22,345][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:41:22,405][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:41:22,415][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:41:23,778][__main__][INFO] - Instantiating callbacks...
[2023-11-18 11:41:23,778][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 11:41:23,780][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 11:41:23,781][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 11:41:23,781][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 11:41:23,781][__main__][INFO] - Instantiating loggers...
[2023-11-18 11:41:23,781][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 11:41:26,530][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 11:41:26,552][__main__][INFO] - Logging hyperparameters!
[2023-11-18 11:41:26,559][__main__][INFO] - Starting training!
[2023-11-18 11:45:01,223][__main__][INFO] - Best model ckpt at 
[2023-11-18 11:45:01,223][__main__][INFO] - Starting testing!
[2023-11-18 11:45:01,224][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-18 11:46:07,541][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 11:46:07,541][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 11:46:07,544][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 11:46:07,545][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 11:46:07,608][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 11:46:07,617][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 11:46:08,982][__main__][INFO] - Instantiating callbacks...
[2023-11-18 11:46:08,982][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 11:46:08,984][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 11:46:08,985][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 11:46:08,985][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 11:46:08,986][__main__][INFO] - Instantiating loggers...
[2023-11-18 11:46:08,986][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 11:46:11,752][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 11:46:11,775][__main__][INFO] - Logging hyperparameters!
[2023-11-18 11:46:11,782][__main__][INFO] - Starting training!
[2023-11-18 11:59:15,569][__main__][INFO] - Best model ckpt at 
[2023-11-18 11:59:15,570][__main__][INFO] - Starting testing!
[2023-11-18 11:59:15,571][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-18 12:02:21,467][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 12:02:21,467][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 12:02:21,471][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 12:02:21,471][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 12:02:21,531][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 12:02:21,542][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 12:02:22,955][__main__][INFO] - Instantiating callbacks...
[2023-11-18 12:02:22,955][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 12:02:22,958][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 12:02:22,959][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 12:02:22,959][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 12:02:22,960][__main__][INFO] - Instantiating loggers...
[2023-11-18 12:02:22,960][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 12:02:25,733][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 12:02:25,766][__main__][INFO] - Logging hyperparameters!
[2023-11-18 12:02:25,780][__main__][INFO] - Starting training!
[2023-11-18 12:03:46,307][__main__][INFO] - Best model ckpt at 
[2023-11-18 12:03:46,307][__main__][INFO] - Starting testing!
[2023-11-18 12:03:46,308][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-18 12:06:43,223][__main__][INFO] - Best ckpt path: None
[2023-11-18 12:06:43,225][utiles.utils][INFO] - Closing loggers...
[2023-11-18 12:06:43,225][utiles.utils][INFO] - Closing wandb!
[2023-11-18 12:06:50,094][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-11-18 12:06:50,095][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-11-18 12:18:43,991][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 12:18:43,991][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 12:18:43,995][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 12:18:43,996][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 12:18:44,052][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 12:18:44,064][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 12:18:45,414][__main__][INFO] - Instantiating callbacks...
[2023-11-18 12:18:45,415][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 12:18:45,417][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 12:18:45,418][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 12:18:45,418][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 12:18:45,418][__main__][INFO] - Instantiating loggers...
[2023-11-18 12:18:45,418][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 12:18:48,146][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 12:18:48,172][__main__][INFO] - Logging hyperparameters!
[2023-11-18 12:18:48,178][__main__][INFO] - Starting training!
[2023-11-18 12:19:22,600][__main__][INFO] - Best model ckpt at 
[2023-11-18 12:19:22,601][__main__][INFO] - Starting testing!
[2023-11-18 12:19:22,601][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-18 12:21:05,446][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 12:21:05,446][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 12:21:05,449][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 12:21:05,449][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 12:21:05,510][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 12:21:05,523][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 12:21:06,935][__main__][INFO] - Instantiating callbacks...
[2023-11-18 12:21:06,935][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 12:21:06,937][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 12:21:06,938][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 12:21:06,938][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 12:21:06,938][__main__][INFO] - Instantiating loggers...
[2023-11-18 12:21:06,939][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 12:21:09,728][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 12:21:09,755][__main__][INFO] - Logging hyperparameters!
[2023-11-18 12:21:09,762][__main__][INFO] - Starting training!
[2023-11-18 12:27:31,491][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 12:27:31,491][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 12:27:31,495][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 12:27:31,495][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 12:27:31,557][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 12:27:31,571][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 12:27:33,012][__main__][INFO] - Instantiating callbacks...
[2023-11-18 12:27:33,012][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 12:27:33,014][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 12:27:33,015][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 12:27:33,016][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 12:27:33,016][__main__][INFO] - Instantiating loggers...
[2023-11-18 12:27:33,016][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 12:27:35,752][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 12:27:35,777][__main__][INFO] - Logging hyperparameters!
[2023-11-18 12:27:35,784][__main__][INFO] - Starting training!
[2023-11-18 12:29:28,826][__main__][INFO] - Best model ckpt at 
[2023-11-18 12:29:28,827][__main__][INFO] - Starting testing!
[2023-11-18 12:29:28,828][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-18 12:41:40,190][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 12:41:40,192][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 12:41:40,195][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 12:41:40,195][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 12:41:40,257][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 12:41:40,278][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 12:41:41,712][__main__][INFO] - Instantiating callbacks...
[2023-11-18 12:41:41,712][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 12:41:41,714][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 12:41:41,715][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 12:41:41,715][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 12:41:41,716][__main__][INFO] - Instantiating loggers...
[2023-11-18 12:41:41,716][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 12:41:44,767][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 12:41:44,792][__main__][INFO] - Logging hyperparameters!
[2023-11-18 12:41:44,800][__main__][INFO] - Starting training!
[2023-11-18 13:00:44,794][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 13:00:44,794][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 13:00:44,798][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 13:00:44,798][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 13:00:44,858][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 13:00:44,882][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 13:00:46,341][__main__][INFO] - Instantiating callbacks...
[2023-11-18 13:00:46,341][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 13:00:46,343][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 13:00:46,344][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 13:00:46,345][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 13:00:46,345][__main__][INFO] - Instantiating loggers...
[2023-11-18 13:00:46,345][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 13:00:49,369][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 13:00:49,395][__main__][INFO] - Logging hyperparameters!
[2023-11-18 13:00:49,404][__main__][INFO] - Starting training!
[2023-11-18 15:19:46,198][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 15:19:46,198][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 15:19:46,203][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 15:19:46,203][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 15:19:46,258][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 15:19:46,268][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 15:19:47,582][__main__][INFO] - Instantiating callbacks...
[2023-11-18 15:19:47,582][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 15:19:47,584][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 15:19:47,585][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 15:19:47,585][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 15:19:47,585][__main__][INFO] - Instantiating loggers...
[2023-11-18 15:19:47,586][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 15:19:50,350][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 15:19:50,372][__main__][INFO] - Logging hyperparameters!
[2023-11-18 15:19:50,379][__main__][INFO] - Starting training!
[2023-11-18 17:05:33,505][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=001.ckpt
[2023-11-18 17:05:33,506][__main__][INFO] - Starting testing!
[2023-11-18 17:06:36,632][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 17:06:36,632][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 17:06:36,636][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 17:06:36,636][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 17:06:36,695][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 17:06:36,705][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 17:06:38,135][__main__][INFO] - Instantiating callbacks...
[2023-11-18 17:06:38,135][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 17:06:38,137][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 17:06:38,138][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 17:06:38,139][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 17:06:38,139][__main__][INFO] - Instantiating loggers...
[2023-11-18 17:06:38,139][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 17:06:40,835][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 17:06:40,858][__main__][INFO] - Logging hyperparameters!
[2023-11-18 17:06:40,865][__main__][INFO] - Starting training!
[2023-11-18 17:08:22,133][__main__][INFO] - Best model ckpt at 
[2023-11-18 17:08:22,134][__main__][INFO] - Starting testing!
[2023-11-18 17:08:22,134][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-18 17:10:07,489][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-18 17:10:07,489][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-18 17:10:07,493][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-18 17:10:07,493][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-18 17:10:07,559][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-18 17:10:07,569][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-18 17:10:08,001][__main__][INFO] - Instantiating callbacks...
[2023-11-18 17:10:08,002][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-18 17:10:08,004][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-18 17:10:08,005][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-18 17:10:08,006][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-18 17:10:08,006][__main__][INFO] - Instantiating loggers...
[2023-11-18 17:10:08,006][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-18 17:10:10,953][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-18 17:10:10,979][__main__][INFO] - Logging hyperparameters!
[2023-11-18 17:10:10,986][__main__][INFO] - Starting training!
[2023-11-18 21:28:06,999][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=003.ckpt
[2023-11-18 21:28:07,000][__main__][INFO] - Starting testing!
[2023-11-18 21:30:24,925][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=003.ckpt
[2023-11-18 21:30:24,926][utiles.utils][INFO] - Closing loggers...
[2023-11-18 21:30:24,926][utiles.utils][INFO] - Closing wandb!
[2023-11-18 21:30:30,840][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-11-18 21:30:30,841][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-11-19 10:25:04,575][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-19 10:25:04,575][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-19 10:25:04,578][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-19 10:25:04,578][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-19 10:25:04,676][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-19 10:25:04,684][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-19 10:25:05,288][__main__][INFO] - Instantiating callbacks...
[2023-11-19 10:25:05,288][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-19 10:25:05,290][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-19 10:25:05,291][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-19 10:25:05,291][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-19 10:25:05,291][__main__][INFO] - Instantiating loggers...
[2023-11-19 10:25:05,291][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-19 10:25:08,362][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-19 10:25:08,385][__main__][INFO] - Logging hyperparameters!
[2023-11-19 10:25:08,390][__main__][INFO] - Starting training!
[2023-11-19 10:25:46,254][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 118, in validation_step
    outputs = self(batch_x).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
TypeError: forward() missing 1 required positional argument: 'batch_x_mark'
[2023-11-19 10:25:46,295][utiles.utils][INFO] - Closing loggers...
[2023-11-19 10:25:46,296][utiles.utils][INFO] - Closing wandb!
[2023-11-19 10:26:22,936][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-19 10:26:22,936][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-19 10:26:22,940][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-19 10:26:22,940][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-19 10:26:23,000][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-19 10:26:23,009][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-19 10:26:23,384][__main__][INFO] - Instantiating callbacks...
[2023-11-19 10:26:23,384][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-19 10:26:23,386][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-19 10:26:23,387][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-19 10:26:23,387][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-19 10:26:23,388][__main__][INFO] - Instantiating loggers...
[2023-11-19 10:26:23,388][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-19 10:26:26,167][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-19 10:26:26,189][__main__][INFO] - Logging hyperparameters!
[2023-11-19 10:26:26,195][__main__][INFO] - Starting training!
[2023-11-19 10:27:04,856][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 118, in validation_step
    outputs = self(batch_x).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
TypeError: forward() missing 1 required positional argument: 'batch_x_mark'
[2023-11-19 10:27:04,861][utiles.utils][INFO] - Closing loggers...
[2023-11-19 10:27:04,861][utiles.utils][INFO] - Closing wandb!
[2023-11-19 10:27:34,291][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-19 10:27:34,292][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-19 10:27:34,295][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-19 10:27:34,295][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-19 10:27:34,352][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-19 10:27:34,361][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-19 10:27:34,755][__main__][INFO] - Instantiating callbacks...
[2023-11-19 10:27:34,755][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-19 10:27:34,757][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-19 10:27:34,758][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-19 10:27:34,758][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-19 10:27:34,759][__main__][INFO] - Instantiating loggers...
[2023-11-19 10:27:34,759][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-19 10:27:37,388][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-19 10:27:37,412][__main__][INFO] - Logging hyperparameters!
[2023-11-19 10:27:37,418][__main__][INFO] - Starting training!
[2023-11-19 10:28:13,830][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 118, in validation_step
    outputs = self(batch_x).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 95, in forward
    nonstationary_forecasting, _ = self.High_FrequencyBlock(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 204, in forward
    target, _ = self.FA_Block(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\layers\FA_Block.py", line 40, in forward
    x = x.view(B, L, 8, -1)
RuntimeError: shape '[128, 144, 8, -1]' is invalid for input of size 129024
[2023-11-19 10:28:13,852][utiles.utils][INFO] - Closing loggers...
[2023-11-19 10:28:13,852][utiles.utils][INFO] - Closing wandb!
[2023-11-19 10:29:30,642][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-19 10:29:30,642][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-19 10:29:30,646][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-19 10:29:30,646][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-19 10:29:30,706][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-19 10:29:30,715][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-19 10:29:31,123][__main__][INFO] - Instantiating callbacks...
[2023-11-19 10:29:31,123][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-19 10:29:31,125][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-19 10:29:31,126][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-19 10:29:31,126][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-19 10:29:31,127][__main__][INFO] - Instantiating loggers...
[2023-11-19 10:29:31,127][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-19 10:29:33,858][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-19 10:29:33,882][__main__][INFO] - Logging hyperparameters!
[2023-11-19 10:29:33,889][__main__][INFO] - Starting training!
[2023-11-19 10:30:13,933][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 118, in validation_step
    outputs = self(batch_x).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 96, in forward
    seasonal_forecasting, _, _ = self.Low_FrequencyBlock(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 293, in forward
    target = self.conv(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 313, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 309, in _conv_forward
    return F.conv1d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [16, 512, 1], expected input[128, 7, 144] to have 512 channels, but got 7 channels instead
[2023-11-19 10:30:13,950][utiles.utils][INFO] - Closing loggers...
[2023-11-19 10:30:13,951][utiles.utils][INFO] - Closing wandb!
[2023-11-19 10:36:31,466][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-19 10:36:31,467][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-19 10:36:31,471][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-19 10:36:31,472][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-19 10:36:31,533][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-19 10:36:31,542][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-19 10:36:31,977][__main__][INFO] - Instantiating callbacks...
[2023-11-19 10:36:31,977][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-19 10:36:31,979][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-19 10:36:31,980][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-19 10:36:31,980][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-19 10:36:31,981][__main__][INFO] - Instantiating loggers...
[2023-11-19 10:36:31,981][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-19 10:36:34,962][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-19 10:36:34,987][__main__][INFO] - Logging hyperparameters!
[2023-11-19 10:36:34,993][__main__][INFO] - Starting training!
[2023-11-19 10:37:15,496][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 118, in validation_step
    outputs = self(batch_x).squeeze()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 53, in forward
    outputs = self.model(batch_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\HFANformer.py", line 96, in forward
    seasonal_forecasting, _, _ = self.Low_FrequencyBlock(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\sub_models.py", line 293, in forward
    target = self.conv(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 313, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 309, in _conv_forward
    return F.conv1d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [16, 512, 1], expected input[128, 7, 144] to have 512 channels, but got 7 channels instead
[2023-11-19 10:37:15,505][utiles.utils][INFO] - Closing loggers...
[2023-11-19 10:37:15,505][utiles.utils][INFO] - Closing wandb!
[2023-11-19 10:38:28,495][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-19 10:38:28,495][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-19 10:38:28,499][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-19 10:38:28,499][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-19 10:38:28,563][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-19 10:38:28,571][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-19 10:38:28,998][__main__][INFO] - Instantiating callbacks...
[2023-11-19 10:38:28,998][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-19 10:38:29,000][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-19 10:38:29,001][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-19 10:38:29,002][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-19 10:38:29,002][__main__][INFO] - Instantiating loggers...
[2023-11-19 10:38:29,002][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-19 10:38:31,853][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-19 10:38:31,880][__main__][INFO] - Logging hyperparameters!
[2023-11-19 10:38:31,886][__main__][INFO] - Starting training!
[2023-11-19 10:40:11,337][__main__][INFO] - Best model ckpt at 
[2023-11-19 10:40:11,338][__main__][INFO] - Starting testing!
[2023-11-19 10:40:11,338][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-11-19 10:41:10,155][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-19 10:41:10,155][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-19 10:41:10,159][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-19 10:41:10,160][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-19 10:41:10,221][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-19 10:41:10,232][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-19 10:41:10,639][__main__][INFO] - Instantiating callbacks...
[2023-11-19 10:41:10,639][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-19 10:41:10,641][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-19 10:41:10,642][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-19 10:41:10,642][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-19 10:41:10,643][__main__][INFO] - Instantiating loggers...
[2023-11-19 10:41:10,643][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-19 10:41:13,383][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-19 10:41:13,406][__main__][INFO] - Logging hyperparameters!
[2023-11-19 10:41:13,413][__main__][INFO] - Starting training!
[2023-11-19 10:41:54,210][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\HFDecomp.py", line 120, in validation_step
    outputs = outputs[:, -self.model.forecast_length:, ghi_id]  # 0 is the index of the target variable GHI , 8 is the index of the target variable DHI
IndexError: too many indices for tensor of dimension 2
[2023-11-19 10:41:54,212][utiles.utils][INFO] - Closing loggers...
[2023-11-19 10:41:54,213][utiles.utils][INFO] - Closing wandb!
[2023-11-19 10:44:15,580][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-19 10:44:15,580][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-19 10:44:15,584][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-19 10:44:15,584][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-19 10:44:15,642][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-19 10:44:15,652][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-19 10:44:16,084][__main__][INFO] - Instantiating callbacks...
[2023-11-19 10:44:16,085][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-19 10:44:16,086][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-19 10:44:16,087][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-19 10:44:16,088][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-19 10:44:16,088][__main__][INFO] - Instantiating loggers...
[2023-11-19 10:44:16,088][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-19 10:44:18,876][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-19 10:44:18,901][__main__][INFO] - Logging hyperparameters!
[2023-11-19 10:44:18,907][__main__][INFO] - Starting training!
[2023-11-19 15:22:27,113][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=000-v5.ckpt
[2023-11-19 15:22:27,114][__main__][INFO] - Starting testing!
[2023-11-21 09:29:25,486][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-11-21 09:29:25,487][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-21 09:29:25,490][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-11-21 09:29:25,490][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-11-21 09:29:25,575][__main__][INFO] - Instantiating datamodule <data_provider.timeseries_module.TSDataModule>
[2023-11-21 09:29:25,584][__main__][INFO] - Instantiating model <pl_models.HFDecomp.TSForecastTask>
[2023-11-21 09:29:26,207][__main__][INFO] - Instantiating callbacks...
[2023-11-21 09:29:26,207][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-21 09:29:26,210][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-21 09:29:26,211][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-11-21 09:29:26,211][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-21 09:29:26,211][__main__][INFO] - Instantiating loggers...
[2023-11-21 09:29:26,212][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-11-21 09:29:34,487][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-11-21 09:29:34,507][__main__][INFO] - Logging hyperparameters!
[2023-11-21 09:29:34,513][__main__][INFO] - Starting training!
[2023-12-13 15:54:15,993][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 15:54:15,993][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 15:54:15,997][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 15:54:15,997][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 15:54:16,107][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 15:54:16,360][__main__][INFO] - Instantiating model <pl_models.Fusionformer.Fusionformer>
[2023-12-13 15:54:16,418][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.my_model' has no attribute 'FusionFormer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 15, in <module>
    from CVselection_network import ConvGatedResidualNetwork, Spectral_Selection_Unit
ModuleNotFoundError: No module named 'CVselection_network'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'models.my_model.FusionFormer.FusionFormer':
ModuleNotFoundError("No module named 'CVselection_network'")
Are you sure that 'FusionFormer' is importable from module 'models.my_model'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.my_model.FusionFormer.FusionFormer', see chained exception above.
full_key: pl_module.model
[2023-12-13 15:54:16,433][utiles.utils][INFO] - Closing loggers...
[2023-12-13 15:58:05,192][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 15:58:05,192][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 15:58:05,196][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 15:58:05,196][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 15:58:05,262][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 15:58:05,471][__main__][INFO] - Instantiating model <pl_models.Fusionformer.Fusionformer>
[2023-12-13 15:58:05,484][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.my_model' has no attribute 'FusionFormer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 15, in <module>
    from CVselection_network import ConvGatedResidualNetwork, Spectral_Selection_Unit
ModuleNotFoundError: No module named 'CVselection_network'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'models.my_model.FusionFormer.FusionFormer':
ModuleNotFoundError("No module named 'CVselection_network'")
Are you sure that 'FusionFormer' is importable from module 'models.my_model'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.my_model.FusionFormer.FusionFormer', see chained exception above.
full_key: pl_module.model
[2023-12-13 15:58:05,485][utiles.utils][INFO] - Closing loggers...
[2023-12-13 15:59:13,573][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 15:59:13,573][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 15:59:13,577][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 15:59:13,577][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 15:59:13,642][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 15:59:13,853][__main__][INFO] - Instantiating model <pl_models.Fusionformer.Fusionformer>
[2023-12-13 15:59:13,866][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.my_model' has no attribute 'FusionFormer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 15, in <module>
    from CVselection_network import ConvGatedResidualNetwork, Spectral_Selection_Unit
ModuleNotFoundError: No module named 'CVselection_network'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'models.my_model.FusionFormer.FusionFormer':
ModuleNotFoundError("No module named 'CVselection_network'")
Are you sure that 'FusionFormer' is importable from module 'models.my_model'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.my_model.FusionFormer.FusionFormer', see chained exception above.
full_key: pl_module.model
[2023-12-13 15:59:13,867][utiles.utils][INFO] - Closing loggers...
[2023-12-13 16:04:02,004][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 16:04:02,005][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 16:04:02,008][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 16:04:02,009][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 16:04:02,079][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 16:04:02,295][__main__][INFO] - Instantiating model <pl_models.Fusionformer.Fusionformer>
[2023-12-13 16:04:02,315][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.my_model' has no attribute 'FusionFormer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 15, in <module>
    from CVselection_network import ConvGatedResidualNetwork, Spectral_Selection_Unit
ModuleNotFoundError: No module named 'CVselection_network'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'models.my_model.FusionFormer.FusionFormer':
ModuleNotFoundError("No module named 'CVselection_network'")
Are you sure that 'FusionFormer' is importable from module 'models.my_model'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.my_model.FusionFormer.FusionFormer', see chained exception above.
full_key: pl_module.model
[2023-12-13 16:04:02,317][utiles.utils][INFO] - Closing loggers...
[2023-12-13 16:10:10,346][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 16:10:10,347][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 16:10:10,351][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 16:10:10,351][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 16:10:10,416][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 16:10:10,646][__main__][INFO] - Instantiating model <pl_models.Fusionformer.Fusionformer>
[2023-12-13 16:10:10,668][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.my_model' has no attribute 'FusionFormer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 15, in <module>
    from CVselection_network import ConvGatedResidualNetwork, Spectral_Selection_Unit
ModuleNotFoundError: No module named 'CVselection_network'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'models.my_model.FusionFormer.FusionFormer':
ModuleNotFoundError("No module named 'CVselection_network'")
Are you sure that 'FusionFormer' is importable from module 'models.my_model'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.my_model.FusionFormer.FusionFormer', see chained exception above.
full_key: pl_module.model
[2023-12-13 16:10:10,669][utiles.utils][INFO] - Closing loggers...
[2023-12-13 16:26:51,919][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 16:26:51,919][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 16:26:51,923][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 16:26:51,924][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 16:26:51,985][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 16:26:52,198][__main__][INFO] - Instantiating model <pl_models.FusionFormer.Fusionformer>
[2023-12-13 16:26:52,214][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 981, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'pl_models.FusionFormer.Fusionformer'; 'pl_models.FusionFormer' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'pl_models.FusionFormer.Fusionformer':
ModuleNotFoundError("No module named 'pl_models.FusionFormer.Fusionformer'; 'pl_models.FusionFormer' is not a package")
Are you sure that 'Fusionformer' is importable from module 'pl_models.FusionFormer'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'pl_models.FusionFormer.Fusionformer', see chained exception above.
full_key: pl_module
[2023-12-13 16:26:52,216][utiles.utils][INFO] - Closing loggers...
[2023-12-13 16:28:35,763][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 16:28:35,763][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 16:28:35,767][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 16:28:35,767][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 16:28:35,827][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 16:28:36,025][__main__][INFO] - Instantiating model <pl_models.FusionFormer.Fusionformer>
[2023-12-13 16:28:36,039][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 981, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'pl_models.FusionFormer.Fusionformer'; 'pl_models.FusionFormer' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'pl_models.FusionFormer.Fusionformer':
ModuleNotFoundError("No module named 'pl_models.FusionFormer.Fusionformer'; 'pl_models.FusionFormer' is not a package")
Are you sure that 'Fusionformer' is importable from module 'pl_models.FusionFormer'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'pl_models.FusionFormer.Fusionformer', see chained exception above.
full_key: pl_module
[2023-12-13 16:28:36,040][utiles.utils][INFO] - Closing loggers...
[2023-12-13 16:29:06,474][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 16:29:06,474][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 16:29:06,478][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 16:29:06,478][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 16:29:06,542][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 16:29:06,745][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 16:29:06,757][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.my_model' has no attribute 'FusionFormer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 15, in <module>
    from CVselection_network import ConvGatedResidualNetwork, Spectral_Selection_Unit
ModuleNotFoundError: No module named 'CVselection_network'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'models.my_model.FusionFormer.FusionFormer':
ModuleNotFoundError("No module named 'CVselection_network'")
Are you sure that 'FusionFormer' is importable from module 'models.my_model'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.my_model.FusionFormer.FusionFormer', see chained exception above.
full_key: pl_module.model
[2023-12-13 16:29:06,759][utiles.utils][INFO] - Closing loggers...
[2023-12-13 16:31:11,540][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 16:31:11,540][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 16:31:11,543][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 16:31:11,543][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 16:31:11,608][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 16:31:11,812][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 16:31:11,825][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.my_model' has no attribute 'FusionFormer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 15, in <module>
    from CVselection_network import ConvGatedResidualNetwork, Spectral_Selection_Unit
ModuleNotFoundError: No module named 'CVselection_network'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'models.my_model.FusionFormer.FusionFormer':
ModuleNotFoundError("No module named 'CVselection_network'")
Are you sure that 'FusionFormer' is importable from module 'models.my_model'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.my_model.FusionFormer.FusionFormer', see chained exception above.
full_key: pl_module.model
[2023-12-13 16:31:11,827][utiles.utils][INFO] - Closing loggers...
[2023-12-13 16:34:02,706][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 16:34:02,706][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 16:34:02,710][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 16:34:02,710][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 16:34:02,775][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 16:34:02,986][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 16:34:03,081][__main__][INFO] - Instantiating callbacks...
[2023-12-13 16:34:03,082][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 16:34:03,084][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 16:34:03,085][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 16:34:03,085][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 16:34:03,086][__main__][INFO] - Instantiating loggers...
[2023-12-13 16:34:03,086][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 16:34:16,051][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 16:34:16,102][__main__][INFO] - Logging hyperparameters!
[2023-12-13 16:34:16,110][__main__][INFO] - Starting training!
[2023-12-13 16:34:16,195][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1037, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1284, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1361, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\satellite_ts_module.py", line 36, in setup
    self.data_train = TSContextDataset(**self.hparams.dataset, mode="train")
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\satellite_ts.py", line 102, in __init__
    with open(self.stats_path, "r") as fp:
FileNotFoundError: [Errno 2] No such file or directory: 'E:/research/my_code/solar_forecasting/EMD/data/stats_multi.json'
[2023-12-13 16:34:16,210][utiles.utils][INFO] - Closing loggers...
[2023-12-13 16:34:16,210][utiles.utils][INFO] - Closing wandb!
[2023-12-13 17:28:32,154][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 17:28:32,155][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 17:28:32,158][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 17:28:32,158][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 17:28:32,233][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 17:28:32,435][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 17:28:32,524][__main__][INFO] - Instantiating callbacks...
[2023-12-13 17:28:32,524][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 17:28:32,526][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 17:28:32,527][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 17:28:32,527][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 17:28:32,527][__main__][INFO] - Instantiating loggers...
[2023-12-13 17:28:32,528][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 17:28:41,007][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 17:28:41,049][__main__][INFO] - Logging hyperparameters!
[2023-12-13 17:28:41,056][__main__][INFO] - Starting training!
[2023-12-13 17:28:42,757][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1037, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1284, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1361, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\satellite_ts_module.py", line 36, in setup
    self.data_train = TSContextDataset(**self.hparams.dataset, mode="train")
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\satellite_ts.py", line 106, in __init__
    self.deeplake_ds = deeplake.load(self.data_dir, read_only=True)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\deeplake\util\spinner.py", line 151, in inner
    return func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\deeplake\api\dataset.py", line 624, in load
    raise DatasetHandlerError(
deeplake.util.exceptions.DatasetHandlerError: A Deep Lake dataset does not exist at the given path (E:/research/my_code/solar_forecasting/EMD/data). Check the path provided or in case you want to create a new dataset, use deeplake.empty().
[2023-12-13 17:28:42,759][utiles.utils][INFO] - Closing loggers...
[2023-12-13 17:28:42,759][utiles.utils][INFO] - Closing wandb!
[2023-12-13 19:21:44,544][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 19:21:44,544][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 19:21:44,547][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 19:21:44,547][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 19:21:44,626][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 19:21:44,818][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 19:21:44,907][__main__][INFO] - Instantiating callbacks...
[2023-12-13 19:21:44,907][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 19:21:44,909][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 19:21:44,910][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 19:21:44,910][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 19:21:44,910][__main__][INFO] - Instantiating loggers...
[2023-12-13 19:21:44,910][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 19:21:58,195][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 19:21:58,240][__main__][INFO] - Logging hyperparameters!
[2023-12-13 19:21:58,248][__main__][INFO] - Starting training!
[2023-12-13 19:21:58,446][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1037, in _run
    self._call_setup_hook()  # allow user to setup lightning_module in accelerator environment
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1284, in _call_setup_hook
    self._call_lightning_datamodule_hook("setup", stage=fn)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1361, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\satellite_ts_module.py", line 36, in setup
    self.data_train = TSContextDataset(**self.hparams.dataset, mode="train")
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\satellite_ts.py", line 114, in __init__
    self.deeplake_ds[f"{year}/context/time_utc"].numpy()[0],
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\deeplake\core\dataset\dataset.py", line 541, in __getitem__
    ret = self[splt[0]][splt[1]]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\deeplake\core\dataset\dataset.py", line 541, in __getitem__
    ret = self[splt[0]][splt[1]]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\deeplake\core\dataset\dataset.py", line 543, in __getitem__
    raise TensorDoesNotExistError(item)
deeplake.util.exceptions.TensorDoesNotExistError: "Tensor 'train' does not exist."
[2023-12-13 19:21:58,477][utiles.utils][INFO] - Closing loggers...
[2023-12-13 19:21:58,478][utiles.utils][INFO] - Closing wandb!
[2023-12-13 21:43:21,096][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 21:43:21,097][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 21:43:21,100][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 21:43:21,100][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 21:43:21,189][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 21:43:21,403][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 21:43:21,517][__main__][INFO] - Instantiating callbacks...
[2023-12-13 21:43:21,517][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 21:43:21,520][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 21:43:21,521][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 21:43:21,521][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 21:43:21,521][__main__][INFO] - Instantiating loggers...
[2023-12-13 21:43:21,521][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 21:43:35,938][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 21:43:36,009][__main__][INFO] - Logging hyperparameters!
[2023-12-13 21:43:36,017][__main__][INFO] - Starting training!
[2023-12-13 21:43:51,845][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
KeyError: Caught KeyError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\satellite_ts.py", line 285, in __getitem__
    mean, std = self.get_stats(station)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\satellite_ts.py", line 156, in get_stats
    mean.append(float(self.stats[station][chan]["mean"]))
KeyError: 'validation_solar_data'

[2023-12-13 21:43:51,893][utiles.utils][INFO] - Closing loggers...
[2023-12-13 21:43:51,893][utiles.utils][INFO] - Closing wandb!
[2023-12-13 21:50:27,662][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 21:50:27,662][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 21:50:27,665][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 21:50:27,665][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 21:50:27,724][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 21:50:27,939][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 21:50:28,028][__main__][INFO] - Instantiating callbacks...
[2023-12-13 21:50:28,028][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 21:50:28,030][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 21:50:28,031][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 21:50:28,031][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 21:50:28,031][__main__][INFO] - Instantiating loggers...
[2023-12-13 21:50:28,032][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 21:50:36,432][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 21:50:36,474][__main__][INFO] - Logging hyperparameters!
[2023-12-13 21:50:36,481][__main__][INFO] - Starting training!
[2023-12-13 21:50:48,812][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
KeyError: Caught KeyError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\_utils\fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\satellite_ts.py", line 286, in __getitem__
    mean, std = self.get_stats(station)
  File "E:\research\my_code\solar_forecasting\EMD\data_provider\satellite_ts.py", line 157, in get_stats
    mean.append(float(self.stats[station][chan]["mean"]))
KeyError: 'validation_solar_data'

[2023-12-13 21:50:48,816][utiles.utils][INFO] - Closing loggers...
[2023-12-13 21:50:48,816][utiles.utils][INFO] - Closing wandb!
[2023-12-13 21:55:15,364][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 21:55:15,364][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 21:55:15,367][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 21:55:15,367][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 21:55:15,434][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 21:55:15,649][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 21:55:15,740][__main__][INFO] - Instantiating callbacks...
[2023-12-13 21:55:15,740][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 21:55:15,742][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 21:55:15,743][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 21:55:15,743][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 21:55:15,743][__main__][INFO] - Instantiating loggers...
[2023-12-13 21:55:15,743][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 21:55:24,482][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 21:55:24,531][__main__][INFO] - Logging hyperparameters!
[2023-12-13 21:55:24,539][__main__][INFO] - Starting training!
[2023-12-13 21:55:37,435][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 121, in advance
    batch = next(data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 184, in __next__
    return self.fetching_function()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 265, in fetching_function
    self._fetch_next_batch(self.dataloader_iter)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\utilities\fetching.py", line 280, in _fetch_next_batch
    batch = next(iterator)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 628, in __next__
    data = self._next_data()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\utils\data\dataloader.py", line 1359, in _process_data
    data.reraise()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\_utils.py", line 543, in reraise
    raise exception
deeplake.util.exceptions.TensorDoesNotExistError: 'Tensor \'Caught TensorDoesNotExistError in DataLoader worker process 0.\nOriginal Traceback (most recent call last):\n  File "E:\\application\\anaconda\\envs\\pytorch_lightning\\lib\\site-packages\\torch\\utils\\data\\_utils\\worker.py", line 302, in _worker_loop\n    data = fetcher.fetch(index)\n  File "E:\\application\\anaconda\\envs\\pytorch_lightning\\lib\\site-packages\\torch\\utils\\data\\_utils\\fetch.py", line 58, in fetch\n    data = [self.dataset[idx] for idx in possibly_batched_index]\n  File "E:\\application\\anaconda\\envs\\pytorch_lightning\\lib\\site-packages\\torch\\utils\\data\\_utils\\fetch.py", line 58, in <listcomp>\n    data = [self.dataset[idx] for idx in possibly_batched_index]\n  File "E:\\research\\my_code\\solar_forecasting\\EMD\\data_provider\\satellite_ts.py", line 290, in __getitem__\n    optflow_tensor = self.deeplake_ds[f"{year}/ctx_opt_flow/data"]\n  File "E:\\application\\anaconda\\envs\\pytorch_lightning\\lib\\site-packages\\deeplake\\core\\dataset\\dataset.py", line 541, in __getitem__\n    ret = self[splt[0]][splt[1]]\n  File "E:\\application\\anaconda\\envs\\pytorch_lightning\\lib\\site-packages\\deeplake\\core\\dataset\\dataset.py", line 541, in __getitem__\n    ret = self[splt[0]][splt[1]]\n  File "E:\\application\\anaconda\\envs\\pytorch_lightning\\lib\\site-packages\\deeplake\\core\\dataset\\dataset.py", line 543, in __getitem__\n    raise TensorDoesNotExistError(item)\ndeeplake.util.exceptions.TensorDoesNotExistError: "Tensor \'ctx_opt_flow\' does not exist."\n\' does not exist.'
[2023-12-13 21:55:37,442][utiles.utils][INFO] - Closing loggers...
[2023-12-13 21:55:37,442][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:14:28,351][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:14:28,351][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:14:28,354][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:14:28,355][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:14:28,420][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:14:28,630][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:14:28,724][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:14:28,724][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:14:28,726][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:14:28,727][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:14:28,727][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:14:28,728][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:14:28,728][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:14:37,696][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:14:37,741][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:14:37,749][__main__][INFO] - Starting training!
[2023-12-13 22:14:51,247][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 73, in validation_step
    ) = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\utils.py", line 83, in prepare_batch
    x_opt = batch["optical_flow"].float()
KeyError: 'optical_flow'
[2023-12-13 22:14:51,261][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:14:51,261][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:18:25,739][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:18:25,739][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:18:25,743][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:18:25,743][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:18:25,807][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:18:26,017][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:18:26,110][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:18:26,110][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:18:26,112][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:18:26,113][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:18:26,113][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:18:26,114][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:18:26,114][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:18:34,770][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:18:34,812][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:18:34,819][__main__][INFO] - Starting training!
[2023-12-13 22:18:49,219][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 152, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:18:49,251][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:18:49,251][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:20:59,720][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:20:59,720][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:20:59,723][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:20:59,724][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:20:59,785][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:20:59,989][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:21:00,086][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:21:00,086][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:21:00,088][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:21:00,089][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:21:00,089][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:21:00,090][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:21:00,090][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:21:08,939][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:21:08,983][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:21:08,991][__main__][INFO] - Starting training!
[2023-12-13 22:21:22,957][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:21:22,964][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:21:22,965][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:24:35,017][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:24:35,017][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:24:35,021][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:24:35,021][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:24:35,081][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:24:35,281][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:24:35,372][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:24:35,372][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:24:35,375][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:24:35,375][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:24:35,376][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:24:35,376][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:24:35,376][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:24:44,001][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:24:44,041][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:24:44,049][__main__][INFO] - Starting training!
[2023-12-13 22:24:57,962][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:24:57,971][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:24:57,971][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:26:26,258][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:26:26,258][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:26:26,261][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:26:26,261][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:26:26,328][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:26:26,534][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:26:26,623][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:26:26,623][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:26:26,626][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:26:26,626][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:26:26,627][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:26:26,627][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:26:26,627][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:26:36,829][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:26:36,871][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:26:36,879][__main__][INFO] - Starting training!
[2023-12-13 22:26:50,660][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:26:50,664][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:26:50,664][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:27:43,727][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:27:43,727][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:27:43,731][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:27:43,731][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:27:43,796][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:27:43,994][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:27:44,085][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:27:44,085][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:27:44,087][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:27:44,088][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:27:44,088][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:27:44,088][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:27:44,089][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:27:52,663][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:27:52,703][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:27:52,710][__main__][INFO] - Starting training!
[2023-12-13 22:28:06,441][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:28:06,446][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:28:06,446][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:29:57,334][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:29:57,334][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:29:57,339][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:29:57,339][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:29:57,403][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:29:57,622][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:29:57,710][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:29:57,710][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:29:57,712][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:29:57,713][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:29:57,714][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:29:57,714][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:29:57,714][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:30:06,366][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:30:06,411][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:30:06,418][__main__][INFO] - Starting training!
[2023-12-13 22:30:20,234][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:30:20,241][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:30:20,241][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:31:28,910][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:31:28,911][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:31:28,914][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:31:28,914][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:31:28,979][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:31:29,188][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:31:29,280][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:31:29,281][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:31:29,283][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:31:29,283][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:31:29,284][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:31:29,284][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:31:29,284][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:31:37,849][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:31:37,901][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:31:37,910][__main__][INFO] - Starting training!
[2023-12-13 22:31:51,852][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:31:51,857][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:31:51,857][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:33:30,462][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:33:30,462][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:33:30,466][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:33:30,466][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:33:30,529][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:33:30,741][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:33:30,832][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:33:30,832][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:33:30,834][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:33:30,835][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:33:30,835][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:33:30,835][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:33:30,835][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:33:39,441][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:33:39,485][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:33:39,492][__main__][INFO] - Starting training!
[2023-12-13 22:33:54,259][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:33:54,266][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:33:54,266][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:39:31,500][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:39:31,500][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:39:31,504][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:39:31,504][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:39:31,571][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:39:31,783][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:39:31,874][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:39:31,875][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:39:31,876][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:39:31,877][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:39:31,878][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:39:31,878][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:39:31,878][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:39:40,635][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:39:40,682][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:39:40,690][__main__][INFO] - Starting training!
[2023-12-13 22:39:54,745][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:39:54,753][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:39:54,753][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:40:34,760][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:40:34,761][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:40:34,763][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:40:34,763][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:40:34,827][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:40:35,022][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:40:35,111][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:40:35,111][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:40:35,113][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:40:35,113][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:40:35,114][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:40:35,114][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:40:35,114][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:40:51,142][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:40:51,184][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:40:51,192][__main__][INFO] - Starting training!
[2023-12-13 22:41:04,263][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 73, in validation_step
    ) = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\utils.py", line 93, in prepare_batch
    print("batch[auxiliary_data]", batch["auxiliary_data"].shape)
AttributeError: 'dict' object has no attribute 'shape'
[2023-12-13 22:41:04,266][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:41:04,266][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:43:19,494][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:43:19,494][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:43:19,497][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:43:19,497][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:43:19,563][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:43:19,775][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:43:19,865][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:43:19,865][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:43:19,867][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:43:19,868][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:43:19,869][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:43:19,869][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:43:19,869][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:43:37,119][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:43:37,158][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:43:37,165][__main__][INFO] - Starting training!
[2023-12-13 22:43:51,114][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:43:51,118][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:43:51,118][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:47:23,238][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:47:23,238][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:47:23,242][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:47:23,242][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:47:23,306][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:47:23,512][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:47:23,608][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:47:23,610][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:47:23,612][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:47:23,612][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:47:23,613][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:47:23,613][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:47:23,613][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:47:45,600][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:47:45,667][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:47:45,676][__main__][INFO] - Starting training!
[2023-12-13 22:48:01,563][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:48:01,567][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:48:01,569][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:51:04,956][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:51:04,957][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:51:04,960][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:51:04,960][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:51:05,021][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:51:05,218][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:51:05,307][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:51:05,307][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:51:05,309][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:51:05,310][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:51:05,310][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:51:05,311][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:51:05,311][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:51:21,933][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:51:21,980][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:51:21,988][__main__][INFO] - Starting training!
[2023-12-13 22:51:35,677][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:51:35,683][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:51:35,683][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:53:46,897][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:53:46,897][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:53:46,908][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:53:46,908][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:53:47,126][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:53:47,467][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:53:47,628][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:53:47,628][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:53:47,641][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:53:47,641][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:53:47,641][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:53:47,641][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:53:47,641][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:54:08,757][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:54:08,846][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:54:08,868][__main__][INFO] - Starting training!
[2023-12-13 22:55:13,968][__main__][INFO] - Best model ckpt at 
[2023-12-13 22:55:13,968][__main__][INFO] - Starting testing!
[2023-12-13 22:55:13,968][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-13 22:55:14,187][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-12-13 22:55:14,202][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:55:14,202][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:55:23,282][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:55:23,282][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:55:23,286][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:55:23,286][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:55:23,351][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:55:23,559][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:55:23,651][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:55:23,651][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:55:23,653][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:55:23,654][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:55:23,654][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:55:23,654][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:55:23,654][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:55:41,327][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:55:41,370][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:55:41,378][__main__][INFO] - Starting training!
[2023-12-13 22:55:55,339][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:55:55,344][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:55:55,344][utiles.utils][INFO] - Closing wandb!
[2023-12-13 22:58:35,953][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 22:58:35,953][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 22:58:35,956][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 22:58:35,956][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 22:58:36,018][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 22:58:36,213][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 22:58:36,304][__main__][INFO] - Instantiating callbacks...
[2023-12-13 22:58:36,305][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 22:58:36,307][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 22:58:36,307][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 22:58:36,308][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 22:58:36,308][__main__][INFO] - Instantiating loggers...
[2023-12-13 22:58:36,308][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 22:58:55,230][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 22:58:55,273][__main__][INFO] - Logging hyperparameters!
[2023-12-13 22:58:55,280][__main__][INFO] - Starting training!
[2023-12-13 22:59:09,288][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 22:59:09,294][utiles.utils][INFO] - Closing loggers...
[2023-12-13 22:59:09,295][utiles.utils][INFO] - Closing wandb!
[2023-12-13 23:02:59,247][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 23:02:59,247][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 23:02:59,251][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 23:02:59,251][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 23:02:59,320][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 23:02:59,404][utiles.utils][INFO] - Closing loggers...
[2023-12-13 23:03:36,758][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 23:03:36,758][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 23:03:36,761][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 23:03:36,762][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 23:03:36,823][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 23:03:37,019][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 23:03:37,113][__main__][INFO] - Instantiating callbacks...
[2023-12-13 23:03:37,113][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 23:03:37,116][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 23:03:37,117][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 23:03:37,117][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 23:03:37,118][__main__][INFO] - Instantiating loggers...
[2023-12-13 23:03:37,118][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 23:03:54,430][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 23:03:54,478][__main__][INFO] - Logging hyperparameters!
[2023-12-13 23:03:54,488][__main__][INFO] - Starting training!
[2023-12-13 23:04:08,319][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 23:04:08,327][utiles.utils][INFO] - Closing loggers...
[2023-12-13 23:04:08,327][utiles.utils][INFO] - Closing wandb!
[2023-12-13 23:05:58,244][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 23:05:58,244][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 23:05:58,248][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 23:05:58,248][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 23:05:58,310][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 23:05:58,521][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 23:05:58,615][__main__][INFO] - Instantiating callbacks...
[2023-12-13 23:05:58,616][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 23:05:58,617][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 23:05:58,618][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 23:05:58,619][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 23:05:58,619][__main__][INFO] - Instantiating loggers...
[2023-12-13 23:05:58,619][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 23:06:17,654][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 23:06:17,698][__main__][INFO] - Logging hyperparameters!
[2023-12-13 23:06:17,706][__main__][INFO] - Starting training!
[2023-12-13 23:06:31,587][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 23:06:31,594][utiles.utils][INFO] - Closing loggers...
[2023-12-13 23:06:31,594][utiles.utils][INFO] - Closing wandb!
[2023-12-13 23:06:59,435][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 23:06:59,435][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 23:06:59,439][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 23:06:59,439][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 23:06:59,501][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 23:06:59,704][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 23:06:59,795][__main__][INFO] - Instantiating callbacks...
[2023-12-13 23:06:59,795][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 23:06:59,797][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 23:06:59,798][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 23:06:59,798][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 23:06:59,799][__main__][INFO] - Instantiating loggers...
[2023-12-13 23:06:59,799][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 23:07:18,274][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 23:07:18,315][__main__][INFO] - Logging hyperparameters!
[2023-12-13 23:07:18,323][__main__][INFO] - Starting training!
[2023-12-13 23:07:32,040][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 23:07:32,045][utiles.utils][INFO] - Closing loggers...
[2023-12-13 23:07:32,045][utiles.utils][INFO] - Closing wandb!
[2023-12-13 23:08:08,692][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 23:08:08,692][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 23:08:08,696][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 23:08:08,696][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 23:08:08,757][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 23:08:08,959][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 23:08:09,050][__main__][INFO] - Instantiating callbacks...
[2023-12-13 23:08:09,050][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 23:08:09,052][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 23:08:09,053][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 23:08:09,054][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 23:08:09,054][__main__][INFO] - Instantiating loggers...
[2023-12-13 23:08:09,054][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 23:08:28,252][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 23:08:28,293][__main__][INFO] - Logging hyperparameters!
[2023-12-13 23:08:28,300][__main__][INFO] - Starting training!
[2023-12-13 23:08:42,166][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 293, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 217, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 23:08:42,175][utiles.utils][INFO] - Closing loggers...
[2023-12-13 23:08:42,176][utiles.utils][INFO] - Closing wandb!
[2023-12-13 23:12:51,311][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 23:12:51,312][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 23:12:51,314][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 23:12:51,316][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 23:12:51,376][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 23:12:51,574][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 23:12:51,667][__main__][INFO] - Instantiating callbacks...
[2023-12-13 23:12:51,668][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 23:12:51,670][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 23:12:51,670][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 23:12:51,671][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 23:12:51,671][__main__][INFO] - Instantiating loggers...
[2023-12-13 23:12:51,671][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 23:13:03,727][utiles.utils][INFO] - Closing loggers...
[2023-12-13 23:13:42,743][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 23:13:42,743][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 23:13:42,746][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 23:13:42,746][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 23:13:42,810][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 23:13:43,006][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 23:13:43,098][__main__][INFO] - Instantiating callbacks...
[2023-12-13 23:13:43,099][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 23:13:43,101][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 23:13:43,101][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 23:13:43,102][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 23:13:43,102][__main__][INFO] - Instantiating loggers...
[2023-12-13 23:13:43,102][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 23:13:59,595][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 23:13:59,640][__main__][INFO] - Logging hyperparameters!
[2023-12-13 23:13:59,647][__main__][INFO] - Starting training!
[2023-12-13 23:14:13,311][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 296, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 220, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 23:14:13,319][utiles.utils][INFO] - Closing loggers...
[2023-12-13 23:14:13,320][utiles.utils][INFO] - Closing wandb!
[2023-12-13 23:16:02,270][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 23:16:02,270][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 23:16:02,274][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 23:16:02,274][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 23:16:02,336][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 23:16:02,531][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 23:16:02,620][__main__][INFO] - Instantiating callbacks...
[2023-12-13 23:16:02,620][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 23:16:02,622][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 23:16:02,624][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 23:16:02,624][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 23:16:02,624][__main__][INFO] - Instantiating loggers...
[2023-12-13 23:16:02,624][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 23:16:11,242][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 23:16:11,292][__main__][INFO] - Logging hyperparameters!
[2023-12-13 23:16:11,299][__main__][INFO] - Starting training!
[2023-12-13 23:16:25,242][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 296, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 220, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-13 23:16:25,249][utiles.utils][INFO] - Closing loggers...
[2023-12-13 23:16:25,249][utiles.utils][INFO] - Closing wandb!
[2023-12-13 23:18:20,786][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 23:18:20,786][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 23:18:20,789][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 23:18:20,789][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 23:18:20,856][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 23:18:21,069][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 23:18:21,084][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.my_model' has no attribute 'FusionFormer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 15, in <module>
    from models.my_model.CVselection_network import ConvGatedResidualNetwork, Spectral_Selection_Unit
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 272
    if name in prescalers:  # reals need to be first scaled up
                                                              ^
IndentationError: unindent does not match any outer indentation level

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'models.my_model.FusionFormer.FusionFormer':
IndentationError('unindent does not match any outer indentation level', ('E:\\research\\my_code\\solar_forecasting\\EMD\\models\\my_model\\CVselection_network.py', 272, 71, '            if name in prescalers:  # reals need to be first scaled up\n'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.my_model.FusionFormer.FusionFormer', see chained exception above.
full_key: pl_module.model
[2023-12-13 23:18:21,086][utiles.utils][INFO] - Closing loggers...
[2023-12-13 23:18:46,145][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-13 23:18:46,146][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-13 23:18:46,149][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-13 23:18:46,149][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-13 23:18:46,211][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-13 23:18:46,408][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-13 23:18:46,490][__main__][INFO] - Instantiating callbacks...
[2023-12-13 23:18:46,490][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-13 23:18:46,492][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-13 23:18:46,493][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-13 23:18:46,494][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-13 23:18:46,494][__main__][INFO] - Instantiating loggers...
[2023-12-13 23:18:46,494][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-13 23:18:55,334][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-13 23:18:55,376][__main__][INFO] - Logging hyperparameters!
[2023-12-13 23:18:55,382][__main__][INFO] - Starting training!
[2023-12-13 23:19:08,452][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 296, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 416, in __getitem__
    return self._modules[key]
KeyError: '0'
[2023-12-13 23:19:08,462][utiles.utils][INFO] - Closing loggers...
[2023-12-13 23:19:08,462][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:16:58,296][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:16:58,296][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:16:58,300][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:16:58,300][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:16:58,406][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:16:58,916][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:16:59,065][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:16:59,065][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:16:59,070][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:16:59,071][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:16:59,071][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:16:59,071][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:16:59,071][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:17:08,264][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:17:08,338][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:17:08,345][__main__][INFO] - Starting training!
[2023-12-14 10:17:31,392][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 296, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 220, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [24, 242, 3, 3], expected input[8, 24, 64, 64] to have 242 channels, but got 24 channels instead
[2023-12-14 10:17:31,454][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:17:31,454][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:24:55,305][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:24:55,305][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:24:55,309][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:24:55,309][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:24:55,370][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:24:55,559][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:24:55,649][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:24:55,649][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:24:55,651][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:24:55,651][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:24:55,652][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:24:55,652][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:24:55,652][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:24:59,304][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:28:28,355][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:28:28,355][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:28:28,358][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:28:28,359][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:28:28,419][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:28:28,595][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:28:28,666][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:28:28,666][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:28:28,668][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:28:28,669][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:28:28,669][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:28:28,669][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:28:28,670][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:28:37,558][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:28:37,599][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:28:37,605][__main__][INFO] - Starting training!
[2023-12-14 10:28:56,020][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 161, in forward
    ctx_output = self.ctx_embedding(ctx_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (786432x9 and 23x64)
[2023-12-14 10:28:56,037][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:28:56,037][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:29:59,068][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:29:59,068][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:29:59,072][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:29:59,072][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:29:59,131][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:29:59,333][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:29:59,407][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:29:59,407][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:29:59,409][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:29:59,409][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:29:59,410][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:29:59,410][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:29:59,410][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:30:07,872][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:30:07,914][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:30:07,921][__main__][INFO] - Starting training!
[2023-12-14 10:30:25,549][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 162, in forward
    ctx_output = self.ctx_embedding(ctx_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (786432x9 and 23x64)
[2023-12-14 10:30:25,557][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:30:25,557][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:31:26,396][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:31:26,396][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:31:26,400][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:31:26,400][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:31:26,459][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:31:26,636][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:31:26,712][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:31:26,712][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:31:26,714][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:31:26,714][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:31:26,716][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:31:26,716][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:31:26,716][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:31:35,099][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:31:35,140][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:31:35,147][__main__][INFO] - Starting training!
[2023-12-14 10:31:52,039][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 163, in forward
    ctx_output = self.ctx_embedding(ctx_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (786432x9 and 23x64)
[2023-12-14 10:31:52,047][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:31:52,047][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:35:28,460][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:35:28,460][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:35:28,464][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:35:28,464][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:35:28,523][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:35:28,707][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:35:28,777][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:35:28,777][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:35:28,779][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:35:28,779][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:35:28,780][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:35:28,780][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:35:28,780][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:35:37,099][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:35:37,140][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:35:37,147][__main__][INFO] - Starting training!
[2023-12-14 10:35:54,267][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 189, in forward
    satellite_output, satellite_weights = self.satellite_attention(satellite=Convlstm_output_decoder, satellite_pos_embedding=satellite_pos_emb)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 174, in forward
    q, k = map(lambda t: (t * cos_satellite) + (rotate_every_two(t) * sin_satellite), (q, k))
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 174, in <lambda>
    q, k = map(lambda t: (t * cos_satellite) + (rotate_every_two(t) * sin_satellite), (q, k))
RuntimeError: The size of tensor a (64) must match the size of tensor b (4096) at non-singleton dimension 1
[2023-12-14 10:35:54,280][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:35:54,280][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:37:45,822][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:37:45,822][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:37:45,826][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:37:45,826][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:37:45,886][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:37:46,074][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:37:46,146][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:37:46,146][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:37:46,148][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:37:46,149][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:37:46,149][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:37:46,150][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:37:46,150][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:37:54,455][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:37:54,493][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:37:54,500][__main__][INFO] - Starting training!
[2023-12-14 10:38:11,396][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 188, in forward
    print("satellite_pos_emb", satellite_pos_emb.shape)
AttributeError: 'tuple' object has no attribute 'shape'
[2023-12-14 10:38:11,398][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:38:11,399][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:40:13,249][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:40:13,249][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:40:13,253][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:40:13,253][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:40:13,314][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:40:13,501][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:40:13,571][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:40:13,571][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:40:13,573][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:40:13,574][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:40:13,575][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:40:13,575][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:40:13,575][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:40:21,931][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:40:21,977][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:40:21,985][__main__][INFO] - Starting training!
[2023-12-14 10:40:39,349][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 189, in forward
    satellite_output, satellite_weights = self.satellite_attention(satellite=Convlstm_output_decoder, satellite_pos_embedding=satellite_pos_emb)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 174, in forward
    q, k = map(lambda t: (t * cos_satellite) + (rotate_every_two(t) * sin_satellite), (q, k))
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 174, in <lambda>
    q, k = map(lambda t: (t * cos_satellite) + (rotate_every_two(t) * sin_satellite), (q, k))
RuntimeError: The size of tensor a (64) must match the size of tensor b (4096) at non-singleton dimension 1
[2023-12-14 10:40:39,355][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:40:39,355][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:43:11,050][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:43:11,050][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:43:11,055][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:43:11,055][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:43:11,119][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:43:11,311][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:43:11,382][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:43:11,383][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:43:11,385][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:43:11,385][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:43:11,386][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:43:11,386][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:43:11,386][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:43:19,798][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:43:19,842][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:43:19,849][__main__][INFO] - Starting training!
[2023-12-14 10:43:36,499][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 189, in forward
    satellite_output, satellite_weights = self.satellite_attention(satellite=Convlstm_output_decoder, satellite_pos_embedding=satellite_pos_emb)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 174, in forward
    q, k = map(lambda t: (t * cos_satellite) + (rotate_every_two(t) * sin_satellite), (q, k))
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 174, in <lambda>
    q, k = map(lambda t: (t * cos_satellite) + (rotate_every_two(t) * sin_satellite), (q, k))
RuntimeError: The size of tensor a (64) must match the size of tensor b (4096) at non-singleton dimension 1
[2023-12-14 10:43:36,504][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:43:36,504][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:44:12,991][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:44:12,991][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:44:12,994][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:44:12,994][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:44:13,052][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:44:13,231][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:44:13,301][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:44:13,302][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:44:13,304][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:44:13,304][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:44:13,305][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:44:13,305][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:44:13,305][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:44:22,324][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:44:22,367][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:44:22,374][__main__][INFO] - Starting training!
[2023-12-14 10:44:38,711][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 192, in forward
    satellite_output, satellite_weights = self.satellite_attention(satellite=Convlstm_output_decoder, satellite_pos_embedding=satellite_pos_emb)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 174, in forward
    q, k = map(lambda t: (t * cos_satellite) + (rotate_every_two(t) * sin_satellite), (q, k))
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 174, in <lambda>
    q, k = map(lambda t: (t * cos_satellite) + (rotate_every_two(t) * sin_satellite), (q, k))
RuntimeError: The size of tensor a (64) must match the size of tensor b (4096) at non-singleton dimension 1
[2023-12-14 10:44:38,715][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:44:38,715][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:47:07,510][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:47:07,510][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:47:07,520][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:47:07,520][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:47:07,736][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:47:08,081][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:47:08,223][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:47:08,224][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:47:08,229][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:47:08,230][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:47:08,232][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:47:08,233][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:47:08,233][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:47:17,379][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:47:17,452][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:47:17,477][__main__][INFO] - Starting training!
[2023-12-14 10:47:41,141][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 194, in forward
    satellite_output, satellite_weights = self.satellite_attention(satellite=Convlstm_output_decoder, satellite_pos_embedding=satellite_pos_emb)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 174, in forward
    q, k = map(lambda t: (t * cos_satellite) + (rotate_every_two(t) * sin_satellite), (q, k))
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 174, in <lambda>
    q, k = map(lambda t: (t * cos_satellite) + (rotate_every_two(t) * sin_satellite), (q, k))
RuntimeError: The size of tensor a (64) must match the size of tensor b (4096) at non-singleton dimension 1
[2023-12-14 10:47:41,145][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:47:41,146][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:54:09,163][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:54:09,163][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:54:09,166][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:54:09,166][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:54:09,224][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:54:09,399][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:54:09,472][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:54:09,473][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:54:09,475][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:54:09,476][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:54:09,477][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:54:09,478][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:54:09,478][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:54:17,673][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:54:17,713][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:54:17,720][__main__][INFO] - Starting training!
[2023-12-14 10:54:34,006][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 207, in forward
    embeddings_varying_encoder, feature_weights = self.Weather_feather_Selection_Unit(ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 331, in forward
    sparse_weights = self.flattened_grn(flat_embedding, context)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (192x11 and 264x11)
[2023-12-14 10:54:34,015][utiles.utils][INFO] - Closing loggers...
[2023-12-14 10:54:34,015][utiles.utils][INFO] - Closing wandb!
[2023-12-14 10:56:23,746][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 10:56:23,746][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 10:56:23,756][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 10:56:23,757][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 10:56:23,980][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 10:56:24,331][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 10:56:24,475][__main__][INFO] - Instantiating callbacks...
[2023-12-14 10:56:24,476][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 10:56:24,481][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 10:56:24,483][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 10:56:24,484][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 10:56:24,484][__main__][INFO] - Instantiating loggers...
[2023-12-14 10:56:24,485][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 10:56:33,818][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 10:56:33,904][__main__][INFO] - Logging hyperparameters!
[2023-12-14 10:56:33,929][__main__][INFO] - Starting training!
[2023-12-14 11:03:45,692][__main__][INFO] - Best model ckpt at 
[2023-12-14 11:03:45,693][__main__][INFO] - Starting testing!
[2023-12-14 11:03:45,693][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-14 11:03:45,871][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-12-14 11:03:45,887][utiles.utils][INFO] - Closing loggers...
[2023-12-14 11:03:45,888][utiles.utils][INFO] - Closing wandb!
[2023-12-14 11:05:01,684][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 11:05:01,684][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 11:05:01,687][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 11:05:01,687][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 11:05:01,747][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 11:05:01,927][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 11:05:01,999][__main__][INFO] - Instantiating callbacks...
[2023-12-14 11:05:02,000][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 11:05:02,002][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 11:05:02,002][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 11:05:02,003][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 11:05:02,003][__main__][INFO] - Instantiating loggers...
[2023-12-14 11:05:02,003][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 11:05:10,314][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 11:05:10,353][__main__][INFO] - Logging hyperparameters!
[2023-12-14 11:05:10,360][__main__][INFO] - Starting training!
[2023-12-14 11:05:26,165][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 201, in forward
    embeddings_varying_encoder, feature_weights = self.Weather_feather_Selection_Unit(ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 331, in forward
    sparse_weights = self.flattened_grn(flat_embedding, context)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (192x11 and 264x11)
[2023-12-14 11:05:26,173][utiles.utils][INFO] - Closing loggers...
[2023-12-14 11:05:26,173][utiles.utils][INFO] - Closing wandb!
[2023-12-14 11:09:35,689][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 11:09:35,689][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 11:09:35,693][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 11:09:35,693][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 11:09:35,756][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 11:09:35,944][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 11:09:36,025][__main__][INFO] - Instantiating callbacks...
[2023-12-14 11:09:36,025][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 11:09:36,027][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 11:09:36,027][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 11:09:36,028][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 11:09:36,028][__main__][INFO] - Instantiating loggers...
[2023-12-14 11:09:36,028][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 11:09:44,406][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 11:09:44,443][__main__][INFO] - Logging hyperparameters!
[2023-12-14 11:09:44,451][__main__][INFO] - Starting training!
[2023-12-14 11:10:00,726][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 78, in validation_step
    loss = self.criterion(y_hat, y_ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\loss.py", line 536, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 3291, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 74, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (8) must match the size of tensor b (24) at non-singleton dimension 1
[2023-12-14 11:10:00,736][utiles.utils][INFO] - Closing loggers...
[2023-12-14 11:10:00,736][utiles.utils][INFO] - Closing wandb!
[2023-12-14 11:10:54,115][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 11:10:54,115][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 11:10:54,125][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 11:10:54,125][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 11:10:54,351][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 11:10:54,679][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 11:10:54,919][__main__][INFO] - Instantiating callbacks...
[2023-12-14 11:10:54,919][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 11:10:54,925][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 11:10:54,927][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 11:10:54,928][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 11:10:54,928][__main__][INFO] - Instantiating loggers...
[2023-12-14 11:10:54,929][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 11:11:04,205][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 11:11:04,279][__main__][INFO] - Logging hyperparameters!
[2023-12-14 11:11:04,310][__main__][INFO] - Starting training!
[2023-12-14 11:11:27,675][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 78, in validation_step
    loss = self.criterion(y_hat, y_ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\loss.py", line 536, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 3291, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 74, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (8) must match the size of tensor b (24) at non-singleton dimension 1
[2023-12-14 11:11:27,680][utiles.utils][INFO] - Closing loggers...
[2023-12-14 11:11:27,680][utiles.utils][INFO] - Closing wandb!
[2023-12-14 11:17:17,955][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 11:17:17,955][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 11:17:17,959][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 11:17:17,959][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 11:17:18,023][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 11:17:18,210][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 11:17:18,294][__main__][INFO] - Instantiating callbacks...
[2023-12-14 11:17:18,295][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 11:17:18,296][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 11:17:18,297][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 11:17:18,297][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 11:17:18,298][__main__][INFO] - Instantiating loggers...
[2023-12-14 11:17:18,298][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 11:17:30,468][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 11:17:30,507][__main__][INFO] - Logging hyperparameters!
[2023-12-14 11:17:30,515][__main__][INFO] - Starting training!
[2023-12-14 11:17:45,278][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat, _, _, _, _, _  = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
ValueError: too many values to unpack (expected 6)
[2023-12-14 11:17:45,280][utiles.utils][INFO] - Closing loggers...
[2023-12-14 11:17:45,281][utiles.utils][INFO] - Closing wandb!
[2023-12-14 11:18:31,250][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 11:18:31,250][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 11:18:31,268][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 11:18:31,268][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 11:18:31,508][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 11:18:31,843][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 11:18:32,086][__main__][INFO] - Instantiating callbacks...
[2023-12-14 11:18:32,087][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 11:18:32,092][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 11:18:32,094][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 11:18:32,095][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 11:18:32,095][__main__][INFO] - Instantiating loggers...
[2023-12-14 11:18:32,096][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 11:18:41,282][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 11:18:41,349][__main__][INFO] - Logging hyperparameters!
[2023-12-14 11:18:41,379][__main__][INFO] - Starting training!
[2023-12-14 11:19:02,606][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat, _, _, _, _, _  = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
ValueError: too many values to unpack (expected 6)
[2023-12-14 11:19:02,610][utiles.utils][INFO] - Closing loggers...
[2023-12-14 11:19:02,610][utiles.utils][INFO] - Closing wandb!
[2023-12-14 11:20:23,145][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 11:20:23,145][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 11:20:23,157][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 11:20:23,157][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 11:20:23,388][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 11:20:23,727][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 11:20:23,976][__main__][INFO] - Instantiating callbacks...
[2023-12-14 11:20:23,977][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 11:20:23,982][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 11:20:23,984][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 11:20:23,985][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 11:20:23,986][__main__][INFO] - Instantiating loggers...
[2023-12-14 11:20:23,986][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 11:20:33,362][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 11:20:33,431][__main__][INFO] - Logging hyperparameters!
[2023-12-14 11:20:33,459][__main__][INFO] - Starting training!
[2023-12-14 11:20:55,090][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 79, in validation_step
    loss = self.criterion(y_hat, y_ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\loss.py", line 536, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 3291, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 74, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (8) must match the size of tensor b (24) at non-singleton dimension 1
[2023-12-14 11:20:55,094][utiles.utils][INFO] - Closing loggers...
[2023-12-14 11:20:55,094][utiles.utils][INFO] - Closing wandb!
[2023-12-14 11:21:17,328][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 11:21:17,328][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 11:21:17,338][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 11:21:17,339][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 11:21:17,565][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 11:21:17,896][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 11:21:18,134][__main__][INFO] - Instantiating callbacks...
[2023-12-14 11:21:18,134][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 11:21:18,139][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 11:21:18,143][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 11:21:18,144][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 11:21:18,144][__main__][INFO] - Instantiating loggers...
[2023-12-14 11:21:18,145][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 11:21:27,323][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 11:21:27,394][__main__][INFO] - Logging hyperparameters!
[2023-12-14 11:21:27,423][__main__][INFO] - Starting training!
[2023-12-14 11:21:49,075][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 79, in validation_step
    loss = self.criterion(y_hat, y_ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\loss.py", line 536, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 3291, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 74, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (8) must match the size of tensor b (24) at non-singleton dimension 1
[2023-12-14 11:21:49,080][utiles.utils][INFO] - Closing loggers...
[2023-12-14 11:21:49,080][utiles.utils][INFO] - Closing wandb!
[2023-12-14 11:22:41,708][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 11:22:41,708][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 11:22:41,719][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 11:22:41,719][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 11:22:41,954][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 11:22:42,301][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 11:22:42,548][__main__][INFO] - Instantiating callbacks...
[2023-12-14 11:22:42,549][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 11:22:42,554][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 11:22:42,556][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 11:22:42,557][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 11:22:42,558][__main__][INFO] - Instantiating loggers...
[2023-12-14 11:22:42,558][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 11:22:52,285][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 11:22:52,359][__main__][INFO] - Logging hyperparameters!
[2023-12-14 11:22:52,389][__main__][INFO] - Starting training!
[2023-12-14 11:39:11,092][__main__][INFO] - Best model ckpt at 
[2023-12-14 11:39:11,094][__main__][INFO] - Starting testing!
[2023-12-14 11:39:11,094][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-14 11:39:11,295][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-12-14 11:39:11,297][utiles.utils][INFO] - Closing loggers...
[2023-12-14 11:39:11,298][utiles.utils][INFO] - Closing wandb!
[2023-12-14 11:41:19,108][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 11:41:19,108][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 11:41:19,111][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 11:41:19,112][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 11:41:19,172][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 11:41:19,352][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 11:41:19,442][__main__][INFO] - Instantiating callbacks...
[2023-12-14 11:41:19,442][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 11:41:19,444][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 11:41:19,444][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 11:41:19,445][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 11:41:19,445][__main__][INFO] - Instantiating loggers...
[2023-12-14 11:41:19,445][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 11:41:28,300][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 11:41:28,341][__main__][INFO] - Logging hyperparameters!
[2023-12-14 11:41:28,349][__main__][INFO] - Starting training!
[2023-12-14 11:41:55,038][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1200, in _run_train
    self.fit_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\training_epoch_loop.py", line 214, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\batch\training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 200, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 247, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 357, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\module.py", line 1661, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 121, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\lr_scheduler.py", line 68, in wrapper
    return wrapped(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\autograd\grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\adamw.py", line 120, in step
    loss = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 107, in _wrap_closure
    closure_result = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 147, in __call__
    self._result = self.closure(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 133, in closure
    step_output = self._step_fn()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 406, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 43, in training_step
    loss = self.criterion(y_hat, y_ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\loss.py", line 536, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 3291, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 74, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (8) must match the size of tensor b (24) at non-singleton dimension 1
[2023-12-14 11:41:55,101][utiles.utils][INFO] - Closing loggers...
[2023-12-14 11:41:55,101][utiles.utils][INFO] - Closing wandb!
[2023-12-14 11:42:13,367][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 11:42:13,367][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 11:42:13,371][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 11:42:13,371][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 11:42:13,441][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 11:42:13,633][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 11:42:13,716][__main__][INFO] - Instantiating callbacks...
[2023-12-14 11:42:13,716][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 11:42:13,718][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 11:42:13,718][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 11:42:13,719][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 11:42:13,719][__main__][INFO] - Instantiating loggers...
[2023-12-14 11:42:13,719][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 11:42:15,214][utiles.utils][INFO] - Closing loggers...
[2023-12-14 11:42:30,107][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 11:42:30,107][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 11:42:30,110][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 11:42:30,110][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 11:42:30,173][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 11:42:30,368][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 11:42:30,452][__main__][INFO] - Instantiating callbacks...
[2023-12-14 11:42:30,452][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 11:42:30,454][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 11:42:30,455][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 11:42:30,455][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 11:42:30,456][__main__][INFO] - Instantiating loggers...
[2023-12-14 11:42:30,456][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 11:42:39,044][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 11:42:39,088][__main__][INFO] - Logging hyperparameters!
[2023-12-14 11:42:39,097][__main__][INFO] - Starting training!
[2023-12-14 13:30:06,473][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=001-v1.ckpt
[2023-12-14 13:30:06,473][__main__][INFO] - Starting testing!
[2023-12-14 13:30:06,651][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 93, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1024, in _run
    verify_loop_configurations(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 47, in verify_loop_configurations
    __verify_eval_loop_configuration(trainer, model, "test")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\configuration_validator.py", line 131, in __verify_eval_loop_configuration
    raise MisconfigurationException(f"No `{step_name}()` method defined to run `Trainer.{trainer_method}`.")
lightning_lite.utilities.exceptions.MisconfigurationException: No `test_step()` method defined to run `Trainer.test`.
[2023-12-14 13:30:06,676][utiles.utils][INFO] - Closing loggers...
[2023-12-14 13:30:06,676][utiles.utils][INFO] - Closing wandb!
[2023-12-14 14:03:02,150][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 14:03:02,150][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 14:03:02,154][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 14:03:02,154][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 14:03:02,260][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 14:03:02,468][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 14:03:02,549][__main__][INFO] - Instantiating callbacks...
[2023-12-14 14:03:02,549][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 14:03:02,551][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 14:03:02,552][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 14:03:02,552][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 14:03:02,553][__main__][INFO] - Instantiating loggers...
[2023-12-14 14:03:02,553][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 14:03:15,298][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 14:03:15,346][__main__][INFO] - Logging hyperparameters!
[2023-12-14 14:03:15,355][__main__][INFO] - Starting testing!
[2023-12-14 14:03:15,355][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-14 14:03:57,850][__main__][INFO] - Best ckpt path: None
[2023-12-14 14:03:57,852][utiles.utils][INFO] - Closing loggers...
[2023-12-14 14:03:57,852][utiles.utils][INFO] - Closing wandb!
[2023-12-14 14:04:05,708][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-14 14:04:05,708][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-12-14 14:12:01,549][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 14:12:01,549][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 14:12:01,552][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 14:12:01,552][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 14:12:01,619][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 14:12:01,805][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 14:12:01,884][__main__][INFO] - Instantiating callbacks...
[2023-12-14 14:12:01,884][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 14:12:01,886][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 14:12:01,887][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 14:12:01,887][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 14:12:01,888][__main__][INFO] - Instantiating loggers...
[2023-12-14 14:12:01,888][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 14:12:10,358][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 14:12:10,400][__main__][INFO] - Logging hyperparameters!
[2023-12-14 14:12:10,407][__main__][INFO] - Starting testing!
[2023-12-14 14:12:10,408][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-14 14:12:41,846][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 93, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 206, in run
    output = self.on_run_end()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 180, in on_run_end
    self._evaluation_epoch_end(self._outputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 288, in _evaluation_epoch_end
    self.trainer._call_lightning_module_hook(hook_name, output_or_outputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 165, in test_epoch_end
    np.save(os.path.join(save_dir, 'all_attns.npy'), np.concatenate(all_attns, axis=0))
ValueError: all the input array dimensions except for the concatenation axis must match exactly, but along dimension 3, the array at index 0 has size 58 and the array at index 1 has size 59
[2023-12-14 14:12:41,858][utiles.utils][INFO] - Closing loggers...
[2023-12-14 14:12:41,860][utiles.utils][INFO] - Closing wandb!
[2023-12-14 14:19:42,519][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 14:19:42,521][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 14:19:42,524][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 14:19:42,524][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 14:19:42,594][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 14:19:42,784][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 14:19:42,866][__main__][INFO] - Instantiating callbacks...
[2023-12-14 14:19:42,867][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 14:19:42,869][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 14:19:42,870][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 14:19:42,870][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 14:19:42,870][__main__][INFO] - Instantiating loggers...
[2023-12-14 14:19:42,870][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 14:19:51,346][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 14:19:51,391][__main__][INFO] - Logging hyperparameters!
[2023-12-14 14:19:51,400][__main__][INFO] - Starting testing!
[2023-12-14 14:19:51,400][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-14 14:20:26,555][__main__][INFO] - Best ckpt path: None
[2023-12-14 14:20:26,557][utiles.utils][INFO] - Closing loggers...
[2023-12-14 14:20:26,557][utiles.utils][INFO] - Closing wandb!
[2023-12-14 14:20:31,670][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-14 14:20:31,671][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-12-14 15:08:46,928][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 15:08:46,929][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 15:08:46,933][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 15:08:46,933][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 15:08:46,996][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 15:08:47,192][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 15:08:47,272][__main__][INFO] - Instantiating callbacks...
[2023-12-14 15:08:47,272][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 15:08:47,274][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 15:08:47,275][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 15:08:47,275][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 15:08:47,275][__main__][INFO] - Instantiating loggers...
[2023-12-14 15:08:47,276][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 15:08:53,057][utiles.utils][INFO] - Closing loggers...
[2023-12-14 15:09:22,214][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 15:09:22,214][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 15:09:22,218][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 15:09:22,218][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 15:09:22,292][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 15:09:22,511][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 15:09:22,592][__main__][INFO] - Instantiating callbacks...
[2023-12-14 15:09:22,592][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 15:09:22,594][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 15:09:22,595][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 15:09:22,595][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 15:09:22,595][__main__][INFO] - Instantiating loggers...
[2023-12-14 15:09:22,596][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 15:09:31,039][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 15:09:31,085][__main__][INFO] - Logging hyperparameters!
[2023-12-14 15:09:31,093][__main__][INFO] - Starting testing!
[2023-12-14 15:09:31,093][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-14 15:10:57,196][__main__][INFO] - Best ckpt path: None
[2023-12-14 15:10:57,197][utiles.utils][INFO] - Closing loggers...
[2023-12-14 15:10:57,198][utiles.utils][INFO] - Closing wandb!
[2023-12-14 15:11:05,799][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-14 15:11:05,800][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-12-14 16:45:22,383][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 16:45:22,383][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 16:45:22,386][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 16:45:22,387][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 16:45:22,449][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 16:45:22,649][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 16:45:22,744][__main__][INFO] - Instantiating callbacks...
[2023-12-14 16:45:22,744][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 16:45:22,746][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 16:45:22,747][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 16:45:22,747][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 16:45:22,748][__main__][INFO] - Instantiating loggers...
[2023-12-14 16:45:22,748][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 16:45:31,393][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 16:45:31,434][__main__][INFO] - Logging hyperparameters!
[2023-12-14 16:45:31,442][__main__][INFO] - Starting training!
[2023-12-14 17:12:52,900][__main__][INFO] - Best model ckpt at 
[2023-12-14 17:12:52,900][__main__][INFO] - Starting testing!
[2023-12-14 17:12:52,901][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-14 17:15:28,936][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 17:15:28,936][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 17:15:28,939][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 17:15:28,939][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 17:15:29,051][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 17:15:29,566][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 17:15:29,759][__main__][INFO] - Instantiating callbacks...
[2023-12-14 17:15:29,759][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 17:15:29,764][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 17:15:29,765][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 17:15:29,766][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 17:15:29,767][__main__][INFO] - Instantiating loggers...
[2023-12-14 17:15:29,767][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 17:15:43,347][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 17:15:43,392][__main__][INFO] - Logging hyperparameters!
[2023-12-14 17:15:43,400][__main__][INFO] - Starting training!
[2023-12-14 17:15:58,467][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 182, in forward
    satellite_output, satellite_weights = self.satellite_attention(satellite=Convlstm_output_decoder, satellite_pos_embedding=satellite_pos_emb)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 169, in forward
    sin_satellite = self.satellite_layers[i](satellite_pos_embedding[0])
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (11136x64 and 256x32)
[2023-12-14 17:15:58,558][utiles.utils][INFO] - Closing loggers...
[2023-12-14 17:15:58,558][utiles.utils][INFO] - Closing wandb!
[2023-12-14 17:16:43,302][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 17:16:43,303][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 17:16:43,306][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 17:16:43,306][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 17:16:43,369][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 17:16:43,559][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 17:16:43,689][__main__][INFO] - Instantiating callbacks...
[2023-12-14 17:16:43,689][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 17:16:43,691][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 17:16:43,692][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 17:16:43,692][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 17:16:43,692][__main__][INFO] - Instantiating loggers...
[2023-12-14 17:16:43,692][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 17:16:52,175][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 17:16:52,220][__main__][INFO] - Logging hyperparameters!
[2023-12-14 17:16:52,229][__main__][INFO] - Starting training!
[2023-12-14 17:35:16,865][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 17:35:16,865][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 17:35:16,868][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 17:35:16,869][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 17:35:16,943][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 17:35:17,165][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 17:35:17,259][__main__][INFO] - Instantiating callbacks...
[2023-12-14 17:35:17,259][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 17:35:17,261][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 17:35:17,262][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 17:35:17,262][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 17:35:17,262][__main__][INFO] - Instantiating loggers...
[2023-12-14 17:35:17,263][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 17:35:25,866][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 17:35:25,910][__main__][INFO] - Logging hyperparameters!
[2023-12-14 17:35:25,918][__main__][INFO] - Starting training!
[2023-12-14 22:27:50,988][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=003-v1.ckpt
[2023-12-14 22:27:50,989][__main__][INFO] - Starting testing!
[2023-12-14 22:32:20,465][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 22:32:20,465][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 22:32:20,469][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 22:32:20,469][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 22:32:20,539][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 22:32:20,745][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 22:32:21,052][__main__][INFO] - Instantiating callbacks...
[2023-12-14 22:32:21,052][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 22:32:21,054][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 22:32:21,055][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 22:32:21,055][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 22:32:21,056][__main__][INFO] - Instantiating loggers...
[2023-12-14 22:32:21,056][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 22:32:30,313][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 22:32:30,365][__main__][INFO] - Logging hyperparameters!
[2023-12-14 22:32:30,373][__main__][INFO] - Starting training!
[2023-12-14 22:32:44,487][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 152, in forward
    ctx_output, bands_weights = self.Spectral_Selection_Unit(ctx_dict) #ctx_output.shape : B, T, H, W  satellite_weights : B, 1, H, W, bands_number
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 295, in forward
    var_outputs.append(self.single_variable_grns[name](variable_embedding))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CVselection_network.py", line 219, in forward
    x = self.conv1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [48, 48, 3, 3], expected input[8, 24, 64, 64] to have 48 channels, but got 24 channels instead
[2023-12-14 22:32:44,562][utiles.utils][INFO] - Closing loggers...
[2023-12-14 22:32:44,562][utiles.utils][INFO] - Closing wandb!
[2023-12-14 22:34:08,733][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 22:34:08,733][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 22:34:08,737][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 22:34:08,737][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 22:34:08,801][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 22:34:09,003][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 22:34:09,308][__main__][INFO] - Instantiating callbacks...
[2023-12-14 22:34:09,308][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 22:34:09,310][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 22:34:09,311][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 22:34:09,311][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 22:34:09,312][__main__][INFO] - Instantiating loggers...
[2023-12-14 22:34:09,312][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 22:34:18,193][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 22:34:18,246][__main__][INFO] - Logging hyperparameters!
[2023-12-14 22:34:18,255][__main__][INFO] - Starting training!
[2023-12-14 22:35:17,872][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 182, in forward
    satellite_output, satellite_weights = self.satellite_attention(satellite=Convlstm_output_decoder, satellite_pos_embedding=satellite_pos_emb)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 169, in forward
    sin_satellite = self.satellite_layers[i](satellite_pos_embedding[0])
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (24192x64 and 512x64)
[2023-12-14 22:35:17,890][utiles.utils][INFO] - Closing loggers...
[2023-12-14 22:35:17,890][utiles.utils][INFO] - Closing wandb!
[2023-12-14 22:37:39,325][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 22:37:39,325][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 22:37:39,328][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 22:37:39,328][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 22:37:39,396][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 22:37:39,608][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 22:37:39,745][__main__][INFO] - Instantiating callbacks...
[2023-12-14 22:37:39,745][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 22:37:39,747][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 22:37:39,748][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 22:37:39,748][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 22:37:39,748][__main__][INFO] - Instantiating loggers...
[2023-12-14 22:37:39,749][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 22:37:48,506][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 22:37:48,550][__main__][INFO] - Logging hyperparameters!
[2023-12-14 22:37:48,559][__main__][INFO] - Starting training!
[2023-12-14 22:38:03,429][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 182, in forward
    satellite_output, satellite_weights = self.satellite_attention(satellite=Convlstm_output_decoder, satellite_pos_embedding=satellite_pos_emb)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\Attention.py", line 170, in forward
    sin_satellite = self.satellite_layers[i](satellite_pos_embedding[0])
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (24192x64 and 128x16)
[2023-12-14 22:38:03,434][utiles.utils][INFO] - Closing loggers...
[2023-12-14 22:38:03,434][utiles.utils][INFO] - Closing wandb!
[2023-12-14 22:38:32,248][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 22:38:32,250][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 22:38:32,254][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 22:38:32,254][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 22:38:32,319][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 22:38:32,538][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 22:38:32,664][__main__][INFO] - Instantiating callbacks...
[2023-12-14 22:38:32,664][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 22:38:32,666][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 22:38:32,667][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 22:38:32,667][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 22:38:32,667][__main__][INFO] - Instantiating loggers...
[2023-12-14 22:38:32,667][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 22:38:41,372][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 22:38:41,416][__main__][INFO] - Logging hyperparameters!
[2023-12-14 22:38:41,425][__main__][INFO] - Starting training!
[2023-12-14 22:48:04,941][__main__][INFO] - Best model ckpt at 
[2023-12-14 22:48:27,365][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 22:48:27,365][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 22:48:27,368][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 22:48:27,369][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 22:48:27,435][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 22:48:27,629][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 22:48:27,754][__main__][INFO] - Instantiating callbacks...
[2023-12-14 22:48:27,754][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 22:48:27,756][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 22:48:27,757][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 22:48:27,757][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 22:48:27,757][__main__][INFO] - Instantiating loggers...
[2023-12-14 22:48:27,758][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 22:48:36,159][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 22:48:36,206][__main__][INFO] - Logging hyperparameters!
[2023-12-14 22:48:36,214][__main__][INFO] - Starting training!
[2023-12-14 22:50:51,094][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1200, in _run_train
    self.fit_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\fit_loop.py", line 267, in advance
    self._outputs = self.epoch_loop.run(self._data_fetcher)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\training_epoch_loop.py", line 214, in advance
    batch_output = self.batch_loop.run(kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\batch\training_batch_loop.py", line 88, in advance
    outputs = self.optimizer_loop.run(optimizers, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 200, in advance
    result = self._run_optimization(kwargs, self._optimizers[self.optim_progress.optimizer_position])
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 247, in _run_optimization
    self._optimizer_step(optimizer, opt_idx, kwargs.get("batch_idx", 0), closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 357, in _optimizer_step
    self.trainer._call_lightning_module_hook(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\module.py", line 1661, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\core\optimizer.py", line 169, in step
    step_output = self._strategy.optimizer_step(self._optimizer, self._optimizer_idx, closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 234, in optimizer_step
    return self.precision_plugin.optimizer_step(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 121, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\lr_scheduler.py", line 68, in wrapper
    return wrapped(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\autograd\grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\optim\adamw.py", line 120, in step
    loss = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\plugins\precision\precision_plugin.py", line 107, in _wrap_closure
    closure_result = closure()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 147, in __call__
    self._result = self.closure(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 133, in closure
    step_output = self._step_fn()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\optimization\optimizer_loop.py", line 406, in _training_step
    training_step_output = self.trainer._call_strategy_hook("training_step", *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 378, in training_step
    return self.model.training_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 40, in training_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=True)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 160, in forward
    Convlstm_output_decoder, (ctx_hidden, ctx_cell) = self.Conv_lstm_encoder(Convlstm_output_encoder,(ctx_hidden, ctx_cell))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 48, in forward
    h = o*torch.tanh(c)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 11.99 GiB total capacity; 40.14 GiB already allocated; 0 bytes free; 41.25 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2023-12-14 22:50:51,178][utiles.utils][INFO] - Closing loggers...
[2023-12-14 22:50:51,179][utiles.utils][INFO] - Closing wandb!
[2023-12-14 22:51:19,849][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-14 22:51:19,849][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-14 22:51:19,853][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-14 22:51:19,853][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-14 22:51:19,921][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-14 22:51:20,182][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-14 22:51:20,308][__main__][INFO] - Instantiating callbacks...
[2023-12-14 22:51:20,308][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-14 22:51:20,310][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-14 22:51:20,311][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-14 22:51:20,311][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-14 22:51:20,312][__main__][INFO] - Instantiating loggers...
[2023-12-14 22:51:20,312][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-14 22:51:29,163][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-14 22:51:29,209][__main__][INFO] - Logging hyperparameters!
[2023-12-14 22:51:29,219][__main__][INFO] - Starting training!
[2023-12-15 09:17:36,384][__main__][INFO] - Best model ckpt at 
[2023-12-15 09:18:21,537][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 09:18:21,537][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 09:18:21,541][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 09:18:21,541][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 09:18:21,655][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 09:18:22,119][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 09:18:22,259][__main__][INFO] - Instantiating callbacks...
[2023-12-15 09:18:22,260][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 09:18:22,262][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 09:18:22,263][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 09:18:22,263][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 09:18:22,264][__main__][INFO] - Instantiating loggers...
[2023-12-15 09:18:22,264][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 09:18:34,794][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 09:18:34,873][__main__][INFO] - Logging hyperparameters!
[2023-12-15 09:18:34,881][__main__][INFO] - Starting training!
[2023-12-15 09:22:00,007][__main__][INFO] - Best model ckpt at 
[2023-12-15 09:22:00,008][__main__][INFO] - Starting testing!
[2023-12-15 09:22:00,009][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 09:23:06,856][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 09:23:06,856][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 09:23:06,859][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 09:23:06,859][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 09:23:06,926][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 09:23:07,117][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 09:23:07,242][__main__][INFO] - Instantiating callbacks...
[2023-12-15 09:23:07,242][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 09:23:07,244][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 09:23:07,245][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 09:23:07,245][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 09:23:07,245][__main__][INFO] - Instantiating loggers...
[2023-12-15 09:23:07,245][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 09:23:15,747][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 09:23:15,793][__main__][INFO] - Logging hyperparameters!
[2023-12-15 09:23:15,802][__main__][INFO] - Starting training!
[2023-12-15 09:35:17,312][__main__][INFO] - Best model ckpt at 
[2023-12-15 09:35:17,411][__main__][INFO] - Starting testing!
[2023-12-15 09:35:17,411][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 09:41:38,256][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 09:41:38,256][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 09:41:38,259][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 09:41:38,259][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 09:41:38,326][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 09:41:38,537][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 09:41:38,655][__main__][INFO] - Instantiating callbacks...
[2023-12-15 09:41:38,655][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 09:41:38,657][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 09:41:38,658][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 09:41:38,658][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 09:41:38,658][__main__][INFO] - Instantiating loggers...
[2023-12-15 09:41:38,658][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 09:41:47,310][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 09:41:47,352][__main__][INFO] - Logging hyperparameters!
[2023-12-15 09:41:47,361][__main__][INFO] - Starting training!
[2023-12-15 09:42:14,778][__main__][INFO] - Best model ckpt at 
[2023-12-15 09:42:14,778][__main__][INFO] - Starting testing!
[2023-12-15 09:42:14,779][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 09:43:17,485][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 09:43:17,485][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 09:43:17,488][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 09:43:17,489][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 09:43:17,557][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 09:43:17,765][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 09:43:17,891][__main__][INFO] - Instantiating callbacks...
[2023-12-15 09:43:17,891][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 09:43:17,893][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 09:43:17,894][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 09:43:17,894][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 09:43:17,895][__main__][INFO] - Instantiating loggers...
[2023-12-15 09:43:17,895][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 09:43:26,513][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 09:43:26,554][__main__][INFO] - Logging hyperparameters!
[2023-12-15 09:43:26,562][__main__][INFO] - Starting training!
[2023-12-15 09:45:45,166][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 09:45:45,166][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 09:45:45,170][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 09:45:45,170][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 09:45:45,234][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 09:45:45,437][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 09:45:45,519][__main__][INFO] - Instantiating callbacks...
[2023-12-15 09:45:45,520][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 09:45:45,522][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 09:45:45,523][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 09:45:45,523][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 09:45:45,524][__main__][INFO] - Instantiating loggers...
[2023-12-15 09:45:45,524][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 09:45:53,951][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 09:45:53,992][__main__][INFO] - Logging hyperparameters!
[2023-12-15 09:45:54,001][__main__][INFO] - Starting training!
[2023-12-15 09:46:08,016][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 75, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 24, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 198, in forward
    embeddings_varying_encoder, feature_weights = self.Weather_feather_Selection_Unit(ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 331, in forward
    sparse_weights = self.flattened_grn(flat_embedding, context)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (192x176 and 360x15)
[2023-12-15 09:46:08,073][utiles.utils][INFO] - Closing loggers...
[2023-12-15 09:46:08,073][utiles.utils][INFO] - Closing wandb!
[2023-12-15 09:48:27,056][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 09:48:27,056][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 09:48:27,059][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 09:48:27,059][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 09:48:27,121][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 09:48:27,313][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 09:48:27,397][__main__][INFO] - Instantiating callbacks...
[2023-12-15 09:48:27,398][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 09:48:27,399][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 09:48:27,400][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 09:48:27,400][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 09:48:27,401][__main__][INFO] - Instantiating loggers...
[2023-12-15 09:48:27,401][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 09:48:36,032][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 09:48:36,075][__main__][INFO] - Logging hyperparameters!
[2023-12-15 09:48:36,083][__main__][INFO] - Starting training!
[2023-12-15 09:49:18,106][__main__][INFO] - Best model ckpt at 
[2023-12-15 09:49:18,131][__main__][INFO] - Starting testing!
[2023-12-15 09:49:18,132][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 09:50:30,626][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 09:50:30,626][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 09:50:30,629][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 09:50:30,630][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 09:50:30,696][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 09:50:30,891][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 09:50:30,977][__main__][INFO] - Instantiating callbacks...
[2023-12-15 09:50:30,977][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 09:50:30,979][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 09:50:30,980][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 09:50:30,980][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 09:50:30,980][__main__][INFO] - Instantiating loggers...
[2023-12-15 09:50:30,980][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 09:50:39,584][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 09:50:39,624][__main__][INFO] - Logging hyperparameters!
[2023-12-15 09:50:39,633][__main__][INFO] - Starting training!
[2023-12-15 10:52:09,795][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=001-v2.ckpt
[2023-12-15 10:52:09,795][__main__][INFO] - Starting testing!
[2023-12-15 10:52:41,796][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=001-v2.ckpt
[2023-12-15 10:52:41,797][utiles.utils][INFO] - Closing loggers...
[2023-12-15 10:52:41,797][utiles.utils][INFO] - Closing wandb!
[2023-12-15 10:52:48,229][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-15 10:52:48,230][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-12-15 15:00:35,706][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 15:00:35,706][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 15:00:35,710][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 15:00:35,710][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 15:00:35,828][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 15:00:36,451][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 15:00:36,545][__main__][INFO] - Instantiating callbacks...
[2023-12-15 15:00:36,545][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 15:00:36,547][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 15:00:36,548][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 15:00:36,548][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 15:00:36,549][__main__][INFO] - Instantiating loggers...
[2023-12-15 15:00:36,549][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 15:00:49,228][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 15:00:49,271][__main__][INFO] - Logging hyperparameters!
[2023-12-15 15:00:49,279][__main__][INFO] - Starting testing!
[2023-12-15 15:00:49,279][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 15:01:47,540][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 15:01:47,540][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 15:01:47,544][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 15:01:47,544][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 15:01:47,612][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 15:01:47,808][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 15:01:47,891][__main__][INFO] - Instantiating callbacks...
[2023-12-15 15:01:47,891][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 15:01:47,892][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 15:01:47,893][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 15:01:47,893][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 15:01:47,894][__main__][INFO] - Instantiating loggers...
[2023-12-15 15:01:47,894][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 15:01:56,476][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 15:01:56,518][__main__][INFO] - Logging hyperparameters!
[2023-12-15 15:01:56,527][__main__][INFO] - Starting testing!
[2023-12-15 15:01:56,527][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 15:05:39,693][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 15:05:39,693][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 15:05:39,696][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 15:05:39,696][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 15:05:39,757][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 15:05:39,939][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 15:05:40,023][__main__][INFO] - Instantiating callbacks...
[2023-12-15 15:05:40,023][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 15:05:40,025][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 15:05:40,025][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 15:05:40,026][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 15:05:40,026][__main__][INFO] - Instantiating loggers...
[2023-12-15 15:05:40,026][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 15:05:48,409][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 15:05:48,448][__main__][INFO] - Logging hyperparameters!
[2023-12-15 15:05:48,456][__main__][INFO] - Starting testing!
[2023-12-15 15:05:48,456][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 15:15:46,639][__main__][INFO] - Best ckpt path: None
[2023-12-15 15:15:46,641][utiles.utils][INFO] - Closing loggers...
[2023-12-15 15:15:46,641][utiles.utils][INFO] - Closing wandb!
[2023-12-15 15:15:54,209][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-15 15:15:54,209][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-12-15 15:20:45,549][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 15:20:45,549][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 15:20:45,552][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 15:20:45,552][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 15:20:45,621][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 15:20:45,835][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 15:20:45,941][__main__][INFO] - Instantiating callbacks...
[2023-12-15 15:20:45,941][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 15:20:45,943][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 15:20:45,944][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 15:20:45,945][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 15:20:45,945][__main__][INFO] - Instantiating loggers...
[2023-12-15 15:20:45,945][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 15:20:54,596][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 15:20:54,638][__main__][INFO] - Logging hyperparameters!
[2023-12-15 15:20:54,646][__main__][INFO] - Starting testing!
[2023-12-15 15:20:54,646][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 15:20:58,372][__main__][INFO] - Best ckpt path: None
[2023-12-15 15:20:58,373][utiles.utils][INFO] - Closing loggers...
[2023-12-15 15:20:58,373][utiles.utils][INFO] - Closing wandb!
[2023-12-15 15:21:05,523][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-15 15:21:05,523][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-12-15 15:21:28,716][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 15:21:28,717][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 15:21:28,720][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 15:21:28,720][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 15:21:28,789][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 15:21:29,012][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 15:21:29,115][__main__][INFO] - Instantiating callbacks...
[2023-12-15 15:21:29,116][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 15:21:29,118][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 15:21:29,118][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 15:21:29,119][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 15:21:29,119][__main__][INFO] - Instantiating loggers...
[2023-12-15 15:21:29,119][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 15:21:37,737][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 15:21:37,779][__main__][INFO] - Logging hyperparameters!
[2023-12-15 15:21:37,790][__main__][INFO] - Starting testing!
[2023-12-15 15:21:37,790][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 15:21:54,134][__main__][INFO] - Best ckpt path: None
[2023-12-15 15:21:54,136][utiles.utils][INFO] - Closing loggers...
[2023-12-15 15:21:54,136][utiles.utils][INFO] - Closing wandb!
[2023-12-15 16:07:34,767][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 16:07:34,767][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 16:07:34,770][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 16:07:34,770][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 16:07:34,868][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 16:07:35,206][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 16:07:35,294][__main__][INFO] - Instantiating callbacks...
[2023-12-15 16:07:35,294][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 16:07:35,296][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 16:07:35,297][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 16:07:35,297][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 16:07:35,297][__main__][INFO] - Instantiating loggers...
[2023-12-15 16:07:35,297][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 16:07:47,329][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 16:07:47,370][__main__][INFO] - Logging hyperparameters!
[2023-12-15 16:07:47,379][__main__][INFO] - Starting testing!
[2023-12-15 16:07:47,379][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 16:08:25,424][__main__][INFO] - Best ckpt path: None
[2023-12-15 16:08:25,426][utiles.utils][INFO] - Closing loggers...
[2023-12-15 16:08:25,426][utiles.utils][INFO] - Closing wandb!
[2023-12-15 16:08:32,151][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-15 16:08:32,151][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-12-15 16:09:00,764][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 16:09:00,764][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 16:09:00,768][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 16:09:00,768][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 16:09:00,832][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 16:09:01,015][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 16:09:01,101][__main__][INFO] - Instantiating callbacks...
[2023-12-15 16:09:01,101][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 16:09:01,103][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 16:09:01,104][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 16:09:01,104][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 16:09:01,104][__main__][INFO] - Instantiating loggers...
[2023-12-15 16:09:01,104][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 16:09:09,482][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 16:09:09,521][__main__][INFO] - Logging hyperparameters!
[2023-12-15 16:09:09,528][__main__][INFO] - Starting testing!
[2023-12-15 16:09:09,528][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 16:09:47,383][__main__][INFO] - Best ckpt path: None
[2023-12-15 16:09:47,384][utiles.utils][INFO] - Closing loggers...
[2023-12-15 16:09:47,384][utiles.utils][INFO] - Closing wandb!
[2023-12-15 16:09:53,202][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-15 16:09:53,202][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-12-15 16:13:34,715][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 16:13:34,715][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 16:13:34,718][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 16:13:34,718][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 16:13:34,781][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 16:13:34,965][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 16:13:35,049][__main__][INFO] - Instantiating callbacks...
[2023-12-15 16:13:35,049][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 16:13:35,051][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 16:13:35,052][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 16:13:35,052][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 16:13:35,052][__main__][INFO] - Instantiating loggers...
[2023-12-15 16:13:35,053][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 16:13:43,489][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 16:13:43,533][__main__][INFO] - Logging hyperparameters!
[2023-12-15 16:13:43,541][__main__][INFO] - Starting testing!
[2023-12-15 16:13:43,541][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 16:14:20,275][__main__][INFO] - Best ckpt path: None
[2023-12-15 16:14:20,276][utiles.utils][INFO] - Closing loggers...
[2023-12-15 16:14:20,276][utiles.utils][INFO] - Closing wandb!
[2023-12-15 16:14:28,610][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-15 16:14:28,611][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-12-15 16:15:51,527][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 16:15:51,527][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 16:15:51,530][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 16:15:51,530][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 16:15:51,596][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 16:15:51,782][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 16:15:51,866][__main__][INFO] - Instantiating callbacks...
[2023-12-15 16:15:51,866][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 16:15:51,868][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 16:15:51,869][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 16:15:51,869][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 16:15:51,869][__main__][INFO] - Instantiating loggers...
[2023-12-15 16:15:51,870][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 16:16:00,245][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 16:16:00,288][__main__][INFO] - Logging hyperparameters!
[2023-12-15 16:16:00,296][__main__][INFO] - Starting testing!
[2023-12-15 16:16:00,296][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 16:16:16,443][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 93, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 123, in test_step
    self.log("test/loss", self.test_loss, on_step=True, prog_bar=True)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1269, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'FusionFormer' object has no attribute 'test_loss'
[2023-12-15 16:16:16,481][utiles.utils][INFO] - Closing loggers...
[2023-12-15 16:16:16,481][utiles.utils][INFO] - Closing wandb!
[2023-12-15 16:17:09,086][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 16:17:09,086][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 16:17:09,090][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 16:17:09,090][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 16:17:09,153][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 16:17:09,334][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 16:17:09,418][__main__][INFO] - Instantiating callbacks...
[2023-12-15 16:17:09,418][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 16:17:09,420][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 16:17:09,421][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 16:17:09,421][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 16:17:09,421][__main__][INFO] - Instantiating loggers...
[2023-12-15 16:17:09,422][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 16:17:18,114][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 16:17:18,154][__main__][INFO] - Logging hyperparameters!
[2023-12-15 16:17:18,162][__main__][INFO] - Starting testing!
[2023-12-15 16:17:18,162][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 16:17:34,734][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 93, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 127, in test_step
    metric = getattr(self, f"test_{key}")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1269, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'FusionFormer' object has no attribute 'test_rmse'
[2023-12-15 16:17:34,736][utiles.utils][INFO] - Closing loggers...
[2023-12-15 16:17:34,736][utiles.utils][INFO] - Closing wandb!
[2023-12-15 16:18:27,896][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 16:18:27,896][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 16:18:27,899][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 16:18:27,899][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 16:18:27,963][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 16:18:28,147][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 16:18:28,234][__main__][INFO] - Instantiating callbacks...
[2023-12-15 16:18:28,234][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 16:18:28,236][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 16:18:28,237][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 16:18:28,237][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 16:18:28,237][__main__][INFO] - Instantiating loggers...
[2023-12-15 16:18:28,237][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 16:18:36,687][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 16:18:36,727][__main__][INFO] - Logging hyperparameters!
[2023-12-15 16:18:36,735][__main__][INFO] - Starting testing!
[2023-12-15 16:18:36,735][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 16:18:52,855][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 93, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 127, in test_step
    metric = getattr(self, f"test_{key}")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1269, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'FusionFormer' object has no attribute 'test_rmse'
[2023-12-15 16:18:52,857][utiles.utils][INFO] - Closing loggers...
[2023-12-15 16:18:52,858][utiles.utils][INFO] - Closing wandb!
[2023-12-15 16:19:54,562][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 16:19:54,562][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 16:19:54,565][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 16:19:54,566][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 16:19:54,630][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 16:19:54,815][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 16:19:54,911][__main__][INFO] - Instantiating callbacks...
[2023-12-15 16:19:54,911][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 16:19:54,913][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 16:19:54,914][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 16:19:54,914][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 16:19:54,915][__main__][INFO] - Instantiating loggers...
[2023-12-15 16:19:54,915][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 16:20:03,323][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 16:20:03,366][__main__][INFO] - Logging hyperparameters!
[2023-12-15 16:20:03,374][__main__][INFO] - Starting testing!
[2023-12-15 16:20:03,375][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 16:20:19,684][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 93, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 127, in test_step
    metric = getattr(self, f"test_{key}")
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1269, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'FusionFormer' object has no attribute 'test_rmse'
[2023-12-15 16:20:19,687][utiles.utils][INFO] - Closing loggers...
[2023-12-15 16:20:19,687][utiles.utils][INFO] - Closing wandb!
[2023-12-15 16:20:50,197][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 16:20:50,197][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 16:20:50,200][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 16:20:50,200][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 16:20:50,266][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 16:20:50,448][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 16:20:50,532][__main__][INFO] - Instantiating callbacks...
[2023-12-15 16:20:50,532][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 16:20:50,534][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 16:20:50,535][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 16:20:50,535][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 16:20:50,535][__main__][INFO] - Instantiating loggers...
[2023-12-15 16:20:50,535][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 16:20:58,895][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 16:20:58,933][__main__][INFO] - Logging hyperparameters!
[2023-12-15 16:20:58,942][__main__][INFO] - Starting testing!
[2023-12-15 16:20:58,942][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 16:21:36,004][__main__][INFO] - Best ckpt path: None
[2023-12-15 16:21:36,005][utiles.utils][INFO] - Closing loggers...
[2023-12-15 16:21:36,005][utiles.utils][INFO] - Closing wandb!
[2023-12-15 16:21:41,536][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-15 16:21:41,536][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-12-15 23:23:22,918][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 23:23:22,918][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 23:23:22,921][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 23:23:22,921][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 23:23:22,984][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 23:23:23,196][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 23:23:23,280][__main__][INFO] - Instantiating callbacks...
[2023-12-15 23:23:23,280][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 23:23:23,282][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 23:23:23,283][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 23:23:23,283][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 23:23:23,284][__main__][INFO] - Instantiating loggers...
[2023-12-15 23:23:23,284][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 23:23:31,851][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 23:23:31,892][__main__][INFO] - Logging hyperparameters!
[2023-12-15 23:23:31,900][__main__][INFO] - Starting testing!
[2023-12-15 23:23:31,900][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-12-15 23:24:19,579][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-15 23:24:19,579][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-15 23:24:19,582][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-15 23:24:19,583][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-15 23:24:19,645][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-15 23:24:19,829][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-15 23:24:19,913][__main__][INFO] - Instantiating callbacks...
[2023-12-15 23:24:19,913][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-15 23:24:19,915][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-15 23:24:19,916][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-15 23:24:19,916][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-15 23:24:19,916][__main__][INFO] - Instantiating loggers...
[2023-12-15 23:24:19,916][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-15 23:24:28,484][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-15 23:24:28,525][__main__][INFO] - Logging hyperparameters!
[2023-12-15 23:24:28,533][__main__][INFO] - Starting training!
[2023-12-16 00:25:45,711][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=001-v3.ckpt
[2023-12-16 00:25:45,711][__main__][INFO] - Starting testing!
[2023-12-16 00:26:15,781][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=001-v3.ckpt
[2023-12-16 00:26:15,783][utiles.utils][INFO] - Closing loggers...
[2023-12-16 00:26:15,783][utiles.utils][INFO] - Closing wandb!
[2023-12-16 00:26:23,117][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-16 00:26:23,117][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-12-18 22:39:30,816][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2023-12-18 22:39:30,816][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-12-18 22:39:30,820][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-12-18 22:39:30,820][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2023-12-18 22:39:30,927][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2023-12-18 22:39:31,616][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2023-12-18 22:39:31,743][__main__][INFO] - Instantiating callbacks...
[2023-12-18 22:39:31,743][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-12-18 22:39:31,745][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-12-18 22:39:31,746][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-12-18 22:39:31,746][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-12-18 22:39:31,746][__main__][INFO] - Instantiating loggers...
[2023-12-18 22:39:31,747][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-12-18 22:39:44,683][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2023-12-18 22:39:44,723][__main__][INFO] - Logging hyperparameters!
[2023-12-18 22:39:44,732][__main__][INFO] - Starting training!
[2023-12-19 23:17:13,060][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=004.ckpt
[2023-12-19 23:17:13,061][__main__][INFO] - Starting testing!
[2023-12-19 23:17:34,191][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=004.ckpt
[2023-12-19 23:17:34,194][utiles.utils][INFO] - Closing loggers...
[2023-12-19 23:17:34,194][utiles.utils][INFO] - Closing wandb!
[2023-12-19 23:17:43,374][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2023-12-19 23:17:43,375][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-01-03 14:43:28,952][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-03 14:43:28,952][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-03 14:43:28,956][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-03 14:43:28,956][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-03 14:43:29,058][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-03 14:43:29,755][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-03 14:43:29,919][__main__][INFO] - Instantiating callbacks...
[2024-01-03 14:43:29,919][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-03 14:43:29,921][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-03 14:43:29,922][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-03 14:43:29,922][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-03 14:43:29,922][__main__][INFO] - Instantiating loggers...
[2024-01-03 14:43:29,923][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-03 14:43:42,752][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-03 14:43:42,795][__main__][INFO] - Logging hyperparameters!
[2024-01-03 14:43:42,803][__main__][INFO] - Starting training!
[2024-01-03 14:46:25,212][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-03 14:46:25,213][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-03 14:46:25,215][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-03 14:46:25,215][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-03 14:46:25,278][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-03 14:46:25,464][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-03 14:46:25,577][__main__][INFO] - Instantiating callbacks...
[2024-01-03 14:46:25,577][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-03 14:46:25,579][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-03 14:46:25,580][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-03 14:46:25,580][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-03 14:46:25,581][__main__][INFO] - Instantiating loggers...
[2024-01-03 14:46:25,581][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-03 14:46:33,987][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-03 14:46:34,026][__main__][INFO] - Logging hyperparameters!
[2024-01-03 14:46:34,035][__main__][INFO] - Starting training!
[2024-01-03 22:18:25,112][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-03 22:18:25,112][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-03 22:18:25,116][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-03 22:18:25,116][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-03 22:18:25,224][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-03 22:18:25,774][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-03 22:18:25,882][__main__][INFO] - Instantiating callbacks...
[2024-01-03 22:18:25,883][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-03 22:18:25,886][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-03 22:18:25,887][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-03 22:18:25,887][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-03 22:18:25,888][__main__][INFO] - Instantiating loggers...
[2024-01-03 22:18:25,888][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-03 22:18:39,752][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-03 22:18:39,817][__main__][INFO] - Logging hyperparameters!
[2024-01-03 22:18:39,827][__main__][INFO] - Starting training!
[2024-01-03 22:19:26,857][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-03 22:19:26,857][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-03 22:19:26,860][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-03 22:19:26,861][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-03 22:19:26,926][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-03 22:19:27,118][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-03 22:19:27,201][__main__][INFO] - Instantiating callbacks...
[2024-01-03 22:19:27,201][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-03 22:19:27,203][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-03 22:19:27,204][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-03 22:19:27,205][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-03 22:19:27,205][__main__][INFO] - Instantiating loggers...
[2024-01-03 22:19:27,205][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-03 22:19:35,873][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-03 22:19:35,911][__main__][INFO] - Logging hyperparameters!
[2024-01-03 22:19:35,920][__main__][INFO] - Starting training!
[2024-01-04 00:06:26,942][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=002.ckpt
[2024-01-04 00:06:26,943][__main__][INFO] - Starting testing!
[2024-01-04 00:07:07,983][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=002.ckpt
[2024-01-04 00:07:07,984][utiles.utils][INFO] - Closing loggers...
[2024-01-04 00:07:07,984][utiles.utils][INFO] - Closing wandb!
[2024-01-04 00:07:14,653][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2024-01-04 00:07:14,653][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-01-04 10:35:42,645][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 10:35:42,645][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 10:35:42,649][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 10:35:42,649][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 10:35:42,768][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 10:35:43,268][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-04 10:35:43,404][__main__][INFO] - Instantiating callbacks...
[2024-01-04 10:35:43,405][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 10:35:43,411][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 10:35:43,413][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 10:35:43,413][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 10:35:43,414][__main__][INFO] - Instantiating loggers...
[2024-01-04 10:35:43,414][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 10:35:58,738][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 10:35:58,822][__main__][INFO] - Logging hyperparameters!
[2024-01-04 10:35:58,831][__main__][INFO] - Starting testing!
[2024-01-04 10:35:58,832][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 10:36:48,467][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 93, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 206, in run
    output = self.on_run_end()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 180, in on_run_end
    self._evaluation_epoch_end(self._outputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 288, in _evaluation_epoch_end
    self.trainer._call_lightning_module_hook(hook_name, output_or_outputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 200, in test_epoch_end
    predictions = window_output['predictions'].cpu().numpy()
TypeError: string indices must be integers
[2024-01-04 10:36:48,497][utiles.utils][INFO] - Closing loggers...
[2024-01-04 10:36:48,498][utiles.utils][INFO] - Closing wandb!
[2024-01-04 10:38:21,069][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 10:38:21,070][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 10:38:21,074][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 10:38:21,074][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 10:38:21,265][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 10:38:22,014][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-04 10:38:22,105][__main__][INFO] - Instantiating callbacks...
[2024-01-04 10:38:22,105][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 10:38:22,108][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 10:38:22,109][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 10:38:22,110][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 10:38:22,110][__main__][INFO] - Instantiating loggers...
[2024-01-04 10:38:22,111][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 10:38:33,473][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 10:38:33,545][__main__][INFO] - Logging hyperparameters!
[2024-01-04 10:38:33,562][__main__][INFO] - Starting testing!
[2024-01-04 10:38:33,563][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 10:39:19,078][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 93, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 206, in run
    output = self.on_run_end()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 180, in on_run_end
    self._evaluation_epoch_end(self._outputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 288, in _evaluation_epoch_end
    self.trainer._call_lightning_module_hook(hook_name, output_or_outputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 202, in test_epoch_end
    predictions = window_output['predictions'].cpu().numpy()
TypeError: string indices must be integers
[2024-01-04 10:39:19,080][utiles.utils][INFO] - Closing loggers...
[2024-01-04 10:39:19,081][utiles.utils][INFO] - Closing wandb!
[2024-01-04 10:41:19,336][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 10:41:19,336][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 10:41:19,340][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 10:41:19,341][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 10:41:19,433][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 10:41:19,747][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-04 10:41:19,842][__main__][INFO] - Instantiating callbacks...
[2024-01-04 10:41:19,842][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 10:41:19,844][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 10:41:19,845][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 10:41:19,845][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 10:41:19,845][__main__][INFO] - Instantiating loggers...
[2024-01-04 10:41:19,845][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 10:41:32,004][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 10:41:32,068][__main__][INFO] - Logging hyperparameters!
[2024-01-04 10:41:32,084][__main__][INFO] - Starting testing!
[2024-01-04 10:41:32,085][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 10:42:20,849][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 93, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 206, in run
    output = self.on_run_end()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 180, in on_run_end
    self._evaluation_epoch_end(self._outputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 288, in _evaluation_epoch_end
    self.trainer._call_lightning_module_hook(hook_name, output_or_outputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 203, in test_epoch_end
    predictions = window_output['predictions'].cpu().numpy()
TypeError: string indices must be integers
[2024-01-04 10:42:20,853][utiles.utils][INFO] - Closing loggers...
[2024-01-04 10:42:20,853][utiles.utils][INFO] - Closing wandb!
[2024-01-04 11:07:41,088][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 11:07:41,088][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 11:07:41,092][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 11:07:41,092][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 11:07:41,160][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 11:07:41,478][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-04 11:07:41,602][__main__][INFO] - Instantiating callbacks...
[2024-01-04 11:07:41,602][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 11:07:41,604][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 11:07:41,605][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 11:07:41,605][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 11:07:41,606][__main__][INFO] - Instantiating loggers...
[2024-01-04 11:07:41,606][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 11:07:51,645][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 11:07:51,690][__main__][INFO] - Logging hyperparameters!
[2024-01-04 11:07:51,697][__main__][INFO] - Starting testing!
[2024-01-04 11:07:51,697][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 11:08:38,079][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 11:08:38,079][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 11:08:38,083][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 11:08:38,083][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 11:08:38,175][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 11:08:38,497][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 11:08:38,512][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.my_model' has no attribute 'CrossVivit'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 984, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'models.my_model.CrossVivit'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'models.my_model.CrossVivit.RoCrossViViT':
ModuleNotFoundError("No module named 'models.my_model.CrossVivit'")
Are you sure that 'CrossVivit' is importable from module 'models.my_model'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.my_model.CrossVivit.RoCrossViViT', see chained exception above.
full_key: pl_module.model
[2024-01-04 11:08:38,527][utiles.utils][INFO] - Closing loggers...
[2024-01-04 11:10:05,795][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 11:10:05,795][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 11:10:05,798][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 11:10:05,798][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 11:10:05,857][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 11:10:06,071][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossVIViT>
[2024-01-04 11:10:06,079][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 981, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'pl_models.Crossvit.CrossVIViT'; 'pl_models.Crossvit' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 648, in _locate
    raise ImportError(
ImportError: Error loading 'pl_models.Crossvit.CrossVIViT':
ModuleNotFoundError("No module named 'pl_models.Crossvit.CrossVIViT'; 'pl_models.Crossvit' is not a package")
Are you sure that 'CrossVIViT' is importable from module 'pl_models.Crossvit'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'pl_models.Crossvit.CrossVIViT', see chained exception above.
full_key: pl_module
[2024-01-04 11:10:06,080][utiles.utils][INFO] - Closing loggers...
[2024-01-04 11:11:55,657][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 11:11:55,657][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 11:11:55,661][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 11:11:55,661][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 11:11:55,735][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 11:11:56,107][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 11:11:56,320][__main__][INFO] - Instantiating callbacks...
[2024-01-04 11:11:56,320][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 11:11:56,323][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 11:11:56,324][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 11:11:56,324][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 11:11:56,324][__main__][INFO] - Instantiating loggers...
[2024-01-04 11:11:56,325][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 11:12:07,040][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 11:12:07,097][__main__][INFO] - Logging hyperparameters!
[2024-01-04 11:12:07,106][__main__][INFO] - Starting training!
[2024-01-04 11:12:24,478][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 73, in validation_step
    ) = self.prepare_batch(val_batch)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Context.py", line 83, in prepare_batch
    x_opt = batch["optical_flow"].float()
KeyError: 'optical_flow'
[2024-01-04 11:12:24,491][utiles.utils][INFO] - Closing loggers...
[2024-01-04 11:12:24,491][utiles.utils][INFO] - Closing wandb!
[2024-01-04 11:19:01,416][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 11:19:01,416][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 11:19:01,421][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 11:19:01,421][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 11:19:01,514][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 11:19:01,842][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 11:19:01,941][__main__][INFO] - Instantiating callbacks...
[2024-01-04 11:19:01,941][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 11:19:01,944][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 11:19:01,945][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 11:19:01,946][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 11:19:01,947][__main__][INFO] - Instantiating loggers...
[2024-01-04 11:19:01,947][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 11:19:12,049][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 11:19:12,090][__main__][INFO] - Logging hyperparameters!
[2024-01-04 11:19:12,096][__main__][INFO] - Starting training!
[2024-01-04 11:19:27,917][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CrossVIvit.py", line 476, in forward
    ctx = self.to_patch_embedding(ctx)  # BT, N, D
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (12288x1216 and 1024x64)
[2024-01-04 11:19:27,945][utiles.utils][INFO] - Closing loggers...
[2024-01-04 11:19:27,947][utiles.utils][INFO] - Closing wandb!
[2024-01-04 11:43:56,702][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 11:43:56,702][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 11:43:56,707][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 11:43:56,707][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 11:43:56,770][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 11:43:57,045][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 11:43:57,115][__main__][INFO] - Instantiating callbacks...
[2024-01-04 11:43:57,115][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 11:43:57,118][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 11:43:57,119][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 11:43:57,119][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 11:43:57,119][__main__][INFO] - Instantiating loggers...
[2024-01-04 11:43:57,119][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 11:44:08,448][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 11:44:08,494][__main__][INFO] - Logging hyperparameters!
[2024-01-04 11:44:08,502][__main__][INFO] - Starting training!
[2024-01-04 11:44:27,888][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CrossVIvit.py", line 482, in forward
    ctx = self.to_patch_embedding(ctx)  # BT, N, D
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (12288x1216 and 1024x64)
[2024-01-04 11:44:27,894][utiles.utils][INFO] - Closing loggers...
[2024-01-04 11:44:27,895][utiles.utils][INFO] - Closing wandb!
[2024-01-04 11:46:53,897][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 11:46:53,897][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 11:46:53,907][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 11:46:53,907][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 11:46:54,013][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 11:46:54,719][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 11:46:54,784][__main__][INFO] - Instantiating callbacks...
[2024-01-04 11:46:54,784][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 11:46:54,786][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 11:46:54,787][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 11:46:54,787][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 11:46:54,787][__main__][INFO] - Instantiating loggers...
[2024-01-04 11:46:54,787][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 11:47:06,048][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 11:47:06,106][__main__][INFO] - Logging hyperparameters!
[2024-01-04 11:47:06,117][__main__][INFO] - Starting training!
[2024-01-04 11:47:25,970][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CrossVIvit.py", line 502, in forward
    ts = self.ts_embedding(ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (192x15 and 23x64)
[2024-01-04 11:47:25,974][utiles.utils][INFO] - Closing loggers...
[2024-01-04 11:47:25,974][utiles.utils][INFO] - Closing wandb!
[2024-01-04 11:48:53,406][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 11:48:53,406][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 11:48:53,410][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 11:48:53,410][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 11:48:53,476][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 11:48:53,782][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 11:48:53,880][__main__][INFO] - Instantiating callbacks...
[2024-01-04 11:48:53,881][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 11:48:53,883][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 11:48:53,886][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 11:48:53,886][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 11:48:53,887][__main__][INFO] - Instantiating loggers...
[2024-01-04 11:48:53,887][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 11:49:04,947][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 11:49:05,028][__main__][INFO] - Logging hyperparameters!
[2024-01-04 11:49:05,042][__main__][INFO] - Starting training!
[2024-01-04 11:49:29,378][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CrossVIvit.py", line 503, in forward
    ts = self.ts_embedding(ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (192x15 and 23x64)
[2024-01-04 11:49:29,385][utiles.utils][INFO] - Closing loggers...
[2024-01-04 11:49:29,385][utiles.utils][INFO] - Closing wandb!
[2024-01-04 11:51:15,035][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 11:51:15,035][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 11:51:15,041][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 11:51:15,041][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 11:51:15,108][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 11:51:15,370][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 11:51:15,452][__main__][INFO] - Instantiating callbacks...
[2024-01-04 11:51:15,452][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 11:51:15,455][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 11:51:15,457][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 11:51:15,457][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 11:51:15,458][__main__][INFO] - Instantiating loggers...
[2024-01-04 11:51:15,458][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 11:51:26,847][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 11:51:26,908][__main__][INFO] - Logging hyperparameters!
[2024-01-04 11:51:26,918][__main__][INFO] - Starting training!
[2024-01-04 11:51:50,050][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 75, in validation_step
    y_hat = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 24, in forward
    out, _, self_attention_scores, cross_attention_scores = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\CrossVIvit.py", line 503, in forward
    ts = self.ts_embedding(ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (192x15 and 23x64)
[2024-01-04 11:51:50,060][utiles.utils][INFO] - Closing loggers...
[2024-01-04 11:51:50,060][utiles.utils][INFO] - Closing wandb!
[2024-01-04 11:54:48,031][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 11:54:48,031][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 11:54:48,035][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 11:54:48,035][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 11:54:48,102][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 11:54:48,352][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 11:54:48,422][__main__][INFO] - Instantiating callbacks...
[2024-01-04 11:54:48,422][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 11:54:48,425][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 11:54:48,426][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 11:54:48,426][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 11:54:48,426][__main__][INFO] - Instantiating loggers...
[2024-01-04 11:54:48,426][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 11:55:00,741][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 11:55:00,825][__main__][INFO] - Logging hyperparameters!
[2024-01-04 11:55:00,839][__main__][INFO] - Starting training!
[2024-01-04 11:55:45,523][__main__][INFO] - Best model ckpt at 
[2024-01-04 11:55:45,525][utiles.utils][INFO] - Closing loggers...
[2024-01-04 11:55:45,526][utiles.utils][INFO] - Closing wandb!
[2024-01-04 11:56:29,012][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 11:56:29,013][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 11:56:29,017][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 11:56:29,017][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 11:56:29,096][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 11:56:29,462][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 11:56:29,559][__main__][INFO] - Instantiating callbacks...
[2024-01-04 11:56:29,559][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 11:56:29,562][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 11:56:29,563][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 11:56:29,564][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 11:56:29,564][__main__][INFO] - Instantiating loggers...
[2024-01-04 11:56:29,564][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 11:56:42,202][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 11:56:42,260][__main__][INFO] - Logging hyperparameters!
[2024-01-04 11:56:42,273][__main__][INFO] - Starting training!
[2024-01-04 12:53:49,252][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=001-v4.ckpt
[2024-01-04 12:53:49,253][utiles.utils][INFO] - Closing loggers...
[2024-01-04 12:53:49,254][utiles.utils][INFO] - Closing wandb!
[2024-01-04 12:53:57,542][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2024-01-04 12:53:57,543][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-01-04 12:58:46,273][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 12:58:46,274][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 12:58:46,279][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 12:58:46,280][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 12:58:46,350][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 12:58:46,578][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 12:58:46,655][__main__][INFO] - Instantiating callbacks...
[2024-01-04 12:58:46,656][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 12:58:46,658][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 12:58:46,658][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 12:58:46,659][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 12:58:46,659][__main__][INFO] - Instantiating loggers...
[2024-01-04 12:58:46,659][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 12:58:58,865][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 12:58:58,924][__main__][INFO] - Logging hyperparameters!
[2024-01-04 12:58:58,932][__main__][INFO] - Starting testing!
[2024-01-04 12:58:58,932][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 12:59:31,969][__main__][INFO] - Best ckpt path: None
[2024-01-04 12:59:31,971][utiles.utils][INFO] - Closing loggers...
[2024-01-04 12:59:31,971][utiles.utils][INFO] - Closing wandb!
[2024-01-04 12:59:39,532][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2024-01-04 12:59:39,532][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-01-04 13:02:35,950][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 13:02:35,951][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 13:02:35,957][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 13:02:35,958][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 13:02:36,217][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 13:02:36,781][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 13:02:36,847][__main__][INFO] - Instantiating callbacks...
[2024-01-04 13:02:36,847][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 13:02:36,850][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 13:02:36,850][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 13:02:36,851][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 13:02:36,851][__main__][INFO] - Instantiating loggers...
[2024-01-04 13:02:36,851][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 13:02:49,305][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 13:02:49,386][__main__][INFO] - Logging hyperparameters!
[2024-01-04 13:02:49,397][__main__][INFO] - Starting testing!
[2024-01-04 13:02:49,398][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 13:03:11,208][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 93, in train
    trainer.test(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 399, in test_step
    return self.model.test_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\Crossvit.py", line 112, in test_step
    loss = self.criterion(y_hat, y_ts)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\loss.py", line 536, in forward
    return F.mse_loss(input, target, reduction=self.reduction)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\functional.py", line 3291, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\functional.py", line 74, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (9) must match the size of tensor b (24) at non-singleton dimension 2
[2024-01-04 13:03:11,225][utiles.utils][INFO] - Closing loggers...
[2024-01-04 13:03:11,225][utiles.utils][INFO] - Closing wandb!
[2024-01-04 13:03:26,431][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 13:03:26,431][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 13:03:26,435][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 13:03:26,435][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 13:03:26,503][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 13:03:26,804][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 13:03:26,893][__main__][INFO] - Instantiating callbacks...
[2024-01-04 13:03:26,893][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 13:03:26,896][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 13:03:26,897][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 13:03:26,898][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 13:03:26,898][__main__][INFO] - Instantiating loggers...
[2024-01-04 13:03:26,898][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 13:03:38,231][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 13:03:38,301][__main__][INFO] - Logging hyperparameters!
[2024-01-04 13:03:38,314][__main__][INFO] - Starting testing!
[2024-01-04 13:03:38,314][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 13:04:11,548][__main__][INFO] - Best ckpt path: None
[2024-01-04 13:04:11,550][utiles.utils][INFO] - Closing loggers...
[2024-01-04 13:04:11,550][utiles.utils][INFO] - Closing wandb!
[2024-01-04 13:04:19,371][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2024-01-04 13:04:19,371][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-01-04 13:05:32,996][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 13:05:32,996][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 13:05:33,000][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 13:05:33,000][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 13:05:33,070][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 13:05:33,381][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 13:05:33,460][__main__][INFO] - Instantiating callbacks...
[2024-01-04 13:05:33,461][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 13:05:33,463][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 13:05:33,464][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 13:05:33,464][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 13:05:33,464][__main__][INFO] - Instantiating loggers...
[2024-01-04 13:05:33,464][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 13:05:45,051][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 13:05:45,118][__main__][INFO] - Logging hyperparameters!
[2024-01-04 13:05:45,129][__main__][INFO] - Starting testing!
[2024-01-04 13:05:45,130][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 13:07:57,093][__main__][INFO] - Best ckpt path: None
[2024-01-04 13:07:57,095][utiles.utils][INFO] - Closing loggers...
[2024-01-04 13:07:57,095][utiles.utils][INFO] - Closing wandb!
[2024-01-04 13:08:04,377][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2024-01-04 13:08:04,378][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-01-04 13:14:05,130][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 13:14:05,130][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 13:14:05,136][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 13:14:05,137][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 13:14:05,315][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 13:14:05,951][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 13:14:06,040][__main__][INFO] - Instantiating callbacks...
[2024-01-04 13:14:06,040][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 13:14:06,043][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 13:14:06,044][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 13:14:06,044][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 13:14:06,044][__main__][INFO] - Instantiating loggers...
[2024-01-04 13:14:06,044][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 13:14:18,711][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 13:14:18,806][__main__][INFO] - Logging hyperparameters!
[2024-01-04 13:14:18,818][__main__][INFO] - Starting testing!
[2024-01-04 13:14:18,819][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 13:15:25,356][__main__][INFO] - Best ckpt path: None
[2024-01-04 13:15:25,358][utiles.utils][INFO] - Closing loggers...
[2024-01-04 13:15:25,358][utiles.utils][INFO] - Closing wandb!
[2024-01-04 13:15:33,517][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2024-01-04 13:15:33,517][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-01-04 13:16:44,664][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 13:16:44,666][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 13:16:44,671][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 13:16:44,671][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 13:16:44,757][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 13:16:45,051][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 13:16:45,138][__main__][INFO] - Instantiating callbacks...
[2024-01-04 13:16:45,139][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 13:16:45,141][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 13:16:45,142][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 13:16:45,142][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 13:16:45,143][__main__][INFO] - Instantiating loggers...
[2024-01-04 13:16:45,143][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 13:16:56,443][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 13:16:56,526][__main__][INFO] - Logging hyperparameters!
[2024-01-04 13:16:56,540][__main__][INFO] - Starting testing!
[2024-01-04 13:16:56,541][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 13:20:37,845][__main__][INFO] - Best ckpt path: None
[2024-01-04 13:20:37,847][utiles.utils][INFO] - Closing loggers...
[2024-01-04 13:20:37,848][utiles.utils][INFO] - Closing wandb!
[2024-01-04 13:20:44,223][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2024-01-04 13:20:44,223][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-01-04 13:30:11,603][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 13:30:11,604][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 13:30:11,608][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 13:30:11,608][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 13:30:11,674][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 13:30:11,918][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-04 13:30:11,982][__main__][INFO] - Instantiating callbacks...
[2024-01-04 13:30:11,982][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 13:30:11,984][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 13:30:11,984][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 13:30:11,986][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 13:30:11,986][__main__][INFO] - Instantiating loggers...
[2024-01-04 13:30:11,986][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 13:30:22,764][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 13:30:22,812][__main__][INFO] - Logging hyperparameters!
[2024-01-04 13:30:22,821][__main__][INFO] - Starting testing!
[2024-01-04 13:30:22,821][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 13:30:46,982][__main__][INFO] - Best ckpt path: None
[2024-01-04 13:30:46,983][utiles.utils][INFO] - Closing loggers...
[2024-01-04 13:30:46,983][utiles.utils][INFO] - Closing wandb!
[2024-01-04 13:30:54,968][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2024-01-04 13:30:54,968][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-01-04 16:12:09,394][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 16:12:09,394][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 16:12:09,403][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 16:12:09,403][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 16:12:09,514][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 16:12:10,486][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-04 16:12:10,609][__main__][INFO] - Instantiating callbacks...
[2024-01-04 16:12:10,609][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 16:12:10,612][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 16:12:10,613][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 16:12:10,614][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 16:12:10,614][__main__][INFO] - Instantiating loggers...
[2024-01-04 16:12:10,614][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 16:12:21,509][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 16:12:21,626][__main__][INFO] - Logging hyperparameters!
[2024-01-04 16:12:21,644][__main__][INFO] - Starting testing!
[2024-01-04 16:12:21,644][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 16:13:23,270][__main__][INFO] - Best ckpt path: None
[2024-01-04 16:13:23,272][utiles.utils][INFO] - Closing loggers...
[2024-01-04 16:13:23,273][utiles.utils][INFO] - Closing wandb!
[2024-01-04 16:15:21,880][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 16:15:21,880][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 16:15:21,887][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 16:15:21,887][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 16:15:22,080][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 16:15:22,553][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-04 16:15:22,668][__main__][INFO] - Instantiating callbacks...
[2024-01-04 16:15:22,669][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 16:15:22,671][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 16:15:22,672][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 16:15:22,673][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 16:15:22,673][__main__][INFO] - Instantiating loggers...
[2024-01-04 16:15:22,673][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 16:15:34,198][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 16:15:34,242][__main__][INFO] - Logging hyperparameters!
[2024-01-04 16:15:34,251][__main__][INFO] - Starting training!
[2024-01-04 16:17:19,866][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 16:17:19,866][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 16:17:19,872][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 16:17:19,873][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 16:17:19,980][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 16:17:20,385][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-04 16:17:20,514][__main__][INFO] - Instantiating callbacks...
[2024-01-04 16:17:20,514][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 16:17:20,517][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 16:17:20,518][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 16:17:20,519][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 16:17:20,519][__main__][INFO] - Instantiating loggers...
[2024-01-04 16:17:20,519][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 16:17:31,783][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 16:17:31,830][__main__][INFO] - Logging hyperparameters!
[2024-01-04 16:17:31,842][__main__][INFO] - Starting training!
[2024-01-04 16:45:57,575][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 16:45:57,575][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 16:45:57,580][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 16:45:57,581][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 16:45:57,680][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 16:45:58,022][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-04 16:45:58,124][__main__][INFO] - Instantiating callbacks...
[2024-01-04 16:45:58,124][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 16:45:58,126][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 16:45:58,127][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 16:45:58,127][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 16:45:58,127][__main__][INFO] - Instantiating loggers...
[2024-01-04 16:45:58,128][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 16:46:08,912][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 16:46:08,984][__main__][INFO] - Logging hyperparameters!
[2024-01-04 16:46:09,001][__main__][INFO] - Starting training!
[2024-01-04 16:47:20,791][__main__][INFO] - Best model ckpt at 
[2024-01-04 16:47:20,792][__main__][INFO] - Starting testing!
[2024-01-04 16:47:20,792][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-04 16:48:32,041][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-04 16:48:32,041][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-04 16:48:32,045][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-04 16:48:32,045][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-04 16:48:32,126][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-04 16:48:32,468][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-04 16:48:32,622][__main__][INFO] - Instantiating callbacks...
[2024-01-04 16:48:32,623][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-04 16:48:32,627][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-04 16:48:32,631][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-04 16:48:32,632][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-04 16:48:32,633][__main__][INFO] - Instantiating loggers...
[2024-01-04 16:48:32,633][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-04 16:48:44,559][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-04 16:48:44,603][__main__][INFO] - Logging hyperparameters!
[2024-01-04 16:48:44,613][__main__][INFO] - Starting training!
[2024-01-04 18:00:51,193][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=002-v1.ckpt
[2024-01-04 18:00:51,194][__main__][INFO] - Starting testing!
[2024-01-04 18:01:29,597][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=002-v1.ckpt
[2024-01-04 18:01:29,599][utiles.utils][INFO] - Closing loggers...
[2024-01-04 18:01:29,599][utiles.utils][INFO] - Closing wandb!
[2024-01-04 18:01:36,416][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2024-01-04 18:01:36,416][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-01-05 16:14:30,224][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-05 16:14:30,224][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-05 16:14:30,228][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-05 16:14:30,229][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-05 16:14:30,342][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-05 16:14:31,226][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-05 16:14:31,338][__main__][INFO] - Instantiating callbacks...
[2024-01-05 16:14:31,339][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-05 16:14:31,345][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-05 16:14:31,346][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-05 16:14:31,347][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-05 16:14:31,347][__main__][INFO] - Instantiating loggers...
[2024-01-05 16:14:31,348][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-05 16:14:41,757][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-05 16:14:41,853][__main__][INFO] - Logging hyperparameters!
[2024-01-05 16:14:41,867][__main__][INFO] - Starting training!
[2024-01-05 16:16:16,714][__main__][INFO] - Best model ckpt at 
[2024-01-05 16:16:16,716][__main__][INFO] - Starting testing!
[2024-01-05 16:16:16,717][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-05 16:17:57,781][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-05 16:17:57,781][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-05 16:17:57,785][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-05 16:17:57,785][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-05 16:17:57,851][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-05 16:17:58,101][__main__][INFO] - Instantiating model <pl_models.Crossvit.CrossViViT>
[2024-01-05 16:17:58,161][__main__][INFO] - Instantiating callbacks...
[2024-01-05 16:17:58,161][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-05 16:17:58,163][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-05 16:17:58,164][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-05 16:17:58,164][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-05 16:17:58,164][__main__][INFO] - Instantiating loggers...
[2024-01-05 16:17:58,165][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-05 16:18:07,204][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-05 16:18:07,248][__main__][INFO] - Logging hyperparameters!
[2024-01-05 16:18:07,255][__main__][INFO] - Starting training!
[2024-01-05 19:03:52,361][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=007.ckpt
[2024-01-05 19:03:52,362][__main__][INFO] - Starting testing!
[2024-01-05 19:06:16,471][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=007.ckpt
[2024-01-05 19:06:16,475][utiles.utils][INFO] - Closing loggers...
[2024-01-05 19:06:16,475][utiles.utils][INFO] - Closing wandb!
[2024-01-05 19:06:24,165][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2024-01-05 19:06:24,166][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-01-15 14:50:01,780][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 14:50:01,780][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 14:50:01,784][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 14:50:01,784][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 14:50:01,880][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 14:50:02,615][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 14:50:02,742][__main__][INFO] - Instantiating callbacks...
[2024-01-15 14:50:02,742][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 14:50:02,746][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 14:50:02,747][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 14:50:02,747][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 14:50:02,747][__main__][INFO] - Instantiating loggers...
[2024-01-15 14:50:02,748][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 14:50:12,028][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 14:50:12,128][__main__][INFO] - Logging hyperparameters!
[2024-01-15 14:50:12,141][__main__][INFO] - Starting training!
[2024-01-15 14:52:24,263][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 14:52:24,263][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 14:52:24,266][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 14:52:24,266][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 14:52:24,341][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 14:52:24,563][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 14:52:24,664][__main__][INFO] - Instantiating callbacks...
[2024-01-15 14:52:24,664][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 14:52:24,666][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 14:52:24,667][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 14:52:24,668][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 14:52:24,668][__main__][INFO] - Instantiating loggers...
[2024-01-15 14:52:24,668][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 14:52:33,751][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 14:52:33,853][__main__][INFO] - Logging hyperparameters!
[2024-01-15 14:52:33,871][__main__][INFO] - Starting training!
[2024-01-15 14:53:43,924][__main__][INFO] - Best model ckpt at 
[2024-01-15 14:53:43,925][__main__][INFO] - Starting testing!
[2024-01-15 14:53:43,925][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-15 14:59:08,216][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 14:59:08,216][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 14:59:08,220][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 14:59:08,221][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 14:59:08,297][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 14:59:08,548][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 14:59:08,654][__main__][INFO] - Instantiating callbacks...
[2024-01-15 14:59:08,654][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 14:59:08,656][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 14:59:08,657][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 14:59:08,657][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 14:59:08,658][__main__][INFO] - Instantiating loggers...
[2024-01-15 14:59:08,658][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 14:59:18,186][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 14:59:18,267][__main__][INFO] - Logging hyperparameters!
[2024-01-15 14:59:18,286][__main__][INFO] - Starting training!
[2024-01-15 17:05:58,627][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 17:05:58,628][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 17:05:58,632][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 17:05:58,632][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 17:05:58,707][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 17:05:58,929][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 17:05:59,073][__main__][INFO] - Instantiating callbacks...
[2024-01-15 17:05:59,073][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 17:05:59,075][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 17:05:59,075][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 17:05:59,076][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 17:05:59,076][__main__][INFO] - Instantiating loggers...
[2024-01-15 17:05:59,076][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 17:06:09,599][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 17:06:09,687][__main__][INFO] - Logging hyperparameters!
[2024-01-15 17:06:09,710][__main__][INFO] - Starting training!
[2024-01-15 17:10:06,536][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 17:10:06,536][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 17:10:06,540][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 17:10:06,540][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 17:10:06,612][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 17:10:06,840][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 17:10:06,942][__main__][INFO] - Instantiating callbacks...
[2024-01-15 17:10:06,943][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 17:10:06,944][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 17:10:06,945][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 17:10:06,945][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 17:10:06,946][__main__][INFO] - Instantiating loggers...
[2024-01-15 17:10:06,946][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 17:10:16,490][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 17:10:16,559][__main__][INFO] - Logging hyperparameters!
[2024-01-15 17:10:16,576][__main__][INFO] - Starting training!
[2024-01-15 17:10:49,123][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 178, in forward
    print("satellite_pos_emb",satellite_pos_emb.shape)
AttributeError: 'tuple' object has no attribute 'shape'
[2024-01-15 17:10:49,187][utiles.utils][INFO] - Closing loggers...
[2024-01-15 17:10:49,188][utiles.utils][INFO] - Closing wandb!
[2024-01-15 17:13:34,070][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 17:13:34,070][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 17:13:34,075][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 17:13:34,075][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 17:13:34,181][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 17:13:34,599][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 17:13:34,727][__main__][INFO] - Instantiating callbacks...
[2024-01-15 17:13:34,727][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 17:13:34,730][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 17:13:34,731][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 17:13:34,731][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 17:13:34,732][__main__][INFO] - Instantiating loggers...
[2024-01-15 17:13:34,732][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 17:13:44,049][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 17:13:44,130][__main__][INFO] - Logging hyperparameters!
[2024-01-15 17:13:44,141][__main__][INFO] - Starting training!
[2024-01-15 17:55:20,209][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 17:55:20,209][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 17:55:20,213][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 17:55:20,213][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 17:55:20,281][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 17:55:20,479][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 17:55:20,689][__main__][INFO] - Instantiating callbacks...
[2024-01-15 17:55:20,690][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 17:55:20,692][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 17:55:20,693][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 17:55:20,693][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 17:55:20,693][__main__][INFO] - Instantiating loggers...
[2024-01-15 17:55:20,693][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 17:55:29,776][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 17:55:29,818][__main__][INFO] - Logging hyperparameters!
[2024-01-15 17:55:29,826][__main__][INFO] - Starting training!
[2024-01-15 17:55:58,160][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 155, in forward
    Convlstm_output_1, (ctx_hidden, ctx_cell) = self.Conv_lstm_encoder_1(ctx_input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 40, in forward
    conv_x = self._conv(cat_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [256, 128, 3, 3], expected input[8, 130, 64, 64] to have 128 channels, but got 130 channels instead
[2024-01-15 17:55:58,180][utiles.utils][INFO] - Closing loggers...
[2024-01-15 17:55:58,180][utiles.utils][INFO] - Closing wandb!
[2024-01-15 18:17:34,957][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 18:17:34,957][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 18:17:34,964][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 18:17:34,965][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 18:17:35,112][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 18:17:35,439][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 18:17:35,793][__main__][INFO] - Instantiating callbacks...
[2024-01-15 18:17:35,793][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 18:17:35,795][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 18:17:35,796][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 18:17:35,796][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 18:17:35,796][__main__][INFO] - Instantiating loggers...
[2024-01-15 18:17:35,796][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 18:17:44,942][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 18:17:44,991][__main__][INFO] - Logging hyperparameters!
[2024-01-15 18:17:45,000][__main__][INFO] - Starting training!
[2024-01-15 18:18:11,716][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 156, in forward
    Convlstm_output_1, (ctx_hidden, ctx_cell) = self.Conv_lstm_encoder_1(ctx_input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 40, in forward
    conv_x = self._conv(cat_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [256, 128, 3, 3], expected input[8, 130, 64, 64] to have 128 channels, but got 130 channels instead
[2024-01-15 18:18:11,720][utiles.utils][INFO] - Closing loggers...
[2024-01-15 18:18:11,721][utiles.utils][INFO] - Closing wandb!
[2024-01-15 21:33:50,493][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 21:33:50,493][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 21:33:50,497][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 21:33:50,497][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 21:33:50,570][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 21:33:50,894][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 21:33:51,164][__main__][INFO] - Instantiating callbacks...
[2024-01-15 21:33:51,164][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 21:33:51,171][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 21:33:51,172][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 21:33:51,173][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 21:33:51,173][__main__][INFO] - Instantiating loggers...
[2024-01-15 21:33:51,173][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 21:34:02,128][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 21:34:02,226][__main__][INFO] - Logging hyperparameters!
[2024-01-15 21:34:02,240][__main__][INFO] - Starting training!
[2024-01-15 21:34:42,303][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    q_1_output = self.LRU_1(Convlstm_output_3)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (786432x64 and 262144x64)
[2024-01-15 21:34:42,339][utiles.utils][INFO] - Closing loggers...
[2024-01-15 21:34:42,339][utiles.utils][INFO] - Closing wandb!
[2024-01-15 21:39:08,228][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 21:39:08,228][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 21:39:08,232][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 21:39:08,232][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 21:39:08,302][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 21:39:08,505][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 21:39:08,611][__main__][INFO] - Instantiating callbacks...
[2024-01-15 21:39:08,611][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 21:39:08,613][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 21:39:08,614][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 21:39:08,614][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 21:39:08,614][__main__][INFO] - Instantiating loggers...
[2024-01-15 21:39:08,615][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 21:39:18,832][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 21:39:18,926][__main__][INFO] - Logging hyperparameters!
[2024-01-15 21:39:18,941][__main__][INFO] - Starting training!
[2024-01-15 21:39:53,889][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 152, in forward
    Convlstm_output_2, (ctx_hidden, ctx_cell) = self.Conv_lstm_encoder_2(Convlstm_output_1,(ctx_hidden, ctx_cell))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 40, in forward
    conv_x = self._conv(cat_x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [128, 96, 3, 3], expected input[8, 128, 64, 64] to have 96 channels, but got 128 channels instead
[2024-01-15 21:39:53,901][utiles.utils][INFO] - Closing loggers...
[2024-01-15 21:39:53,901][utiles.utils][INFO] - Closing wandb!
[2024-01-15 21:58:08,233][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 21:58:08,233][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 21:58:08,237][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 21:58:08,237][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 21:58:08,303][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 21:58:08,507][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 21:58:08,552][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 74, in __init__
    self.convlstm = ConvLSTM(in_chan=self.dim, image_size=64)
TypeError: __init__() missing 1 required positional argument: 'seq_len'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.FusionFormer.FusionFormer':
TypeError("__init__() missing 1 required positional argument: 'seq_len'")
full_key: pl_module.model
[2024-01-15 21:58:08,560][utiles.utils][INFO] - Closing loggers...
[2024-01-15 21:58:33,902][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 21:58:33,902][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 21:58:33,905][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 21:58:33,905][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 21:58:33,981][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 21:58:35,141][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 21:58:35,190][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 74, in __init__
    self.convlstm = ConvLSTM(in_chan=self.dim, image_size=64)
TypeError: __init__() missing 1 required positional argument: 'seq_len'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.FusionFormer.FusionFormer':
TypeError("__init__() missing 1 required positional argument: 'seq_len'")
full_key: pl_module.model
[2024-01-15 21:58:35,191][utiles.utils][INFO] - Closing loggers...
[2024-01-15 21:59:12,669][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 21:59:12,669][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 21:59:12,676][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 21:59:12,676][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 21:59:12,830][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 21:59:13,101][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 21:59:13,202][__main__][INFO] - Instantiating callbacks...
[2024-01-15 21:59:13,202][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 21:59:13,204][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 21:59:13,205][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 21:59:13,205][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 21:59:13,206][__main__][INFO] - Instantiating loggers...
[2024-01-15 21:59:13,206][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 21:59:23,402][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 21:59:23,443][__main__][INFO] - Logging hyperparameters!
[2024-01-15 21:59:23,451][__main__][INFO] - Starting training!
[2024-01-15 21:59:52,176][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 148, in forward
    Convlstm_output_3 = self.convlstm(ctx_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 210, in forward
    print("output",output.shape)
AttributeError: 'tuple' object has no attribute 'shape'
[2024-01-15 21:59:52,185][utiles.utils][INFO] - Closing loggers...
[2024-01-15 21:59:52,185][utiles.utils][INFO] - Closing wandb!
[2024-01-15 22:03:53,652][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-15 22:03:53,652][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-15 22:03:53,655][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-15 22:03:53,656][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-15 22:03:53,723][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-15 22:03:53,913][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-15 22:03:54,017][__main__][INFO] - Instantiating callbacks...
[2024-01-15 22:03:54,018][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-15 22:03:54,019][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-15 22:03:54,021][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-15 22:03:54,021][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-15 22:03:54,021][__main__][INFO] - Instantiating loggers...
[2024-01-15 22:03:54,021][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-15 22:04:03,376][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-15 22:04:03,450][__main__][INFO] - Logging hyperparameters!
[2024-01-15 22:04:03,463][__main__][INFO] - Starting training!
[2024-01-15 22:04:37,135][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 154, in forward
    q_1_output = self.LRU_1(Convlstm_output_3)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (32768x16 and 32768x64)
[2024-01-15 22:04:37,143][utiles.utils][INFO] - Closing loggers...
[2024-01-15 22:04:37,144][utiles.utils][INFO] - Closing wandb!
[2024-01-16 09:43:57,105][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 09:43:57,106][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 09:43:57,111][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 09:43:57,111][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 09:43:57,279][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 09:43:57,821][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 09:43:58,033][__main__][INFO] - Instantiating callbacks...
[2024-01-16 09:43:58,033][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 09:43:58,037][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 09:43:58,038][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 09:43:58,039][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 09:43:58,039][__main__][INFO] - Instantiating loggers...
[2024-01-16 09:43:58,039][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 09:44:13,907][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 09:44:14,013][__main__][INFO] - Logging hyperparameters!
[2024-01-16 09:44:14,032][__main__][INFO] - Starting training!
[2024-01-16 09:44:51,929][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 155, in forward
    q_1_output = self.LRU_1(Convlstm_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (32768x16 and 32768x64)
[2024-01-16 09:44:52,018][utiles.utils][INFO] - Closing loggers...
[2024-01-16 09:44:52,018][utiles.utils][INFO] - Closing wandb!
[2024-01-16 09:51:09,749][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 09:51:09,749][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 09:51:09,753][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 09:51:09,753][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 09:51:09,827][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 09:51:10,179][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 09:51:10,372][__main__][INFO] - Instantiating callbacks...
[2024-01-16 09:51:10,372][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 09:51:10,375][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 09:51:10,376][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 09:51:10,377][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 09:51:10,377][__main__][INFO] - Instantiating loggers...
[2024-01-16 09:51:10,377][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 09:51:21,474][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 09:51:21,532][__main__][INFO] - Logging hyperparameters!
[2024-01-16 09:51:21,543][__main__][INFO] - Starting training!
[2024-01-16 09:52:00,535][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 155, in forward
    q_1_output = self.LRU_1(Convlstm_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (32768x16 and 32768x64)
[2024-01-16 09:52:00,543][utiles.utils][INFO] - Closing loggers...
[2024-01-16 09:52:00,543][utiles.utils][INFO] - Closing wandb!
[2024-01-16 09:53:27,787][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 09:53:27,788][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 09:53:27,792][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 09:53:27,792][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 09:53:27,875][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 09:53:28,182][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 09:53:28,304][__main__][INFO] - Instantiating callbacks...
[2024-01-16 09:53:28,304][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 09:53:28,306][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 09:53:28,307][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 09:53:28,307][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 09:53:28,307][__main__][INFO] - Instantiating loggers...
[2024-01-16 09:53:28,307][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 09:53:28,892][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\wandb_init.py", line 1166, in init
    wi.setup(kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\wandb_init.py", line 191, in setup
    self._wl = wandb_setup.setup(settings=setup_settings)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\wandb_setup.py", line 327, in setup
    ret = _setup(settings=settings)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\wandb_setup.py", line 320, in _setup
    wl = _WandbSetup(settings=settings)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\wandb_setup.py", line 303, in __init__
    _WandbSetup._instance = _WandbSetup__WandbSetup(settings=settings, pid=pid)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\wandb_setup.py", line 114, in __init__
    self._setup()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\wandb_setup.py", line 250, in _setup
    self._setup_manager()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\wandb_setup.py", line 277, in _setup_manager
    self._manager = wandb_manager._Manager(settings=self._settings)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\wandb_manager.py", line 138, in __init__
    self._service.start()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\service\service.py", line 258, in start
    self._launch_server()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\service\service.py", line 250, in _launch_server
    self._wait_for_ports(fname, proc=internal_proc)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\service\service.py", line 126, in _wait_for_ports
    time.sleep(0.2)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 360, in __init__
    _ = self.experiment
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loggers\logger.py", line 53, in experiment
    return get_experiment() or DummyExperiment()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\lightning_utilities\core\rank_zero.py", line 32, in wrapped_fn
    return fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loggers\logger.py", line 51, in get_experiment
    return fn(self)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loggers\wandb.py", line 406, in experiment
    self._experiment = wandb.init(**self._wandb_init)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\wandb\sdk\wandb_init.py", line 1191, in init
    assert logger
AssertionError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 53, in train
    logger: List[LightningLoggerBase] = utiles.instantiate_loggers(cfg.get("logger"))
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 130, in instantiate_loggers
    logger.append(hydra.utils.instantiate(lg_conf))
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'pytorch_lightning.loggers.wandb.WandbLogger':
AssertionError()
full_key: logger.wandb
[2024-01-16 09:53:28,964][utiles.utils][INFO] - Closing loggers...
[2024-01-16 09:53:34,694][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 09:53:34,694][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 09:53:34,697][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 09:53:34,697][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 09:53:34,765][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 09:53:35,035][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 09:53:35,142][__main__][INFO] - Instantiating callbacks...
[2024-01-16 09:53:35,142][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 09:53:35,145][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 09:53:35,146][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 09:53:35,146][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 09:53:35,147][__main__][INFO] - Instantiating loggers...
[2024-01-16 09:53:35,147][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 09:53:46,836][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 09:53:46,884][__main__][INFO] - Logging hyperparameters!
[2024-01-16 09:53:46,892][__main__][INFO] - Starting training!
[2024-01-16 09:54:26,417][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 155, in forward
    q_1_output = self.LRU_1(Convlstm_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (32768x16 and 32768x64)
[2024-01-16 09:54:26,424][utiles.utils][INFO] - Closing loggers...
[2024-01-16 09:54:26,424][utiles.utils][INFO] - Closing wandb!
[2024-01-16 09:56:30,417][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 09:56:30,417][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 09:56:30,421][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 09:56:30,422][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 09:56:30,493][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 09:56:30,835][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 09:56:30,988][__main__][INFO] - Instantiating callbacks...
[2024-01-16 09:56:30,989][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 09:56:30,991][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 09:56:30,992][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 09:56:30,993][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 09:56:30,993][__main__][INFO] - Instantiating loggers...
[2024-01-16 09:56:30,993][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 09:56:41,989][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 09:56:42,039][__main__][INFO] - Logging hyperparameters!
[2024-01-16 09:56:42,056][__main__][INFO] - Starting training!
[2024-01-16 09:57:18,404][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 155, in forward
    q_1_output = self.LRU_1(Convlstm_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (32768x16 and 32768x64)
[2024-01-16 09:57:18,415][utiles.utils][INFO] - Closing loggers...
[2024-01-16 09:57:18,415][utiles.utils][INFO] - Closing wandb!
[2024-01-16 10:01:13,261][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:01:13,261][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:01:13,265][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:01:13,266][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:01:13,365][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:01:13,730][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:01:13,870][__main__][INFO] - Instantiating callbacks...
[2024-01-16 10:01:13,871][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 10:01:13,873][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 10:01:13,873][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 10:01:13,874][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 10:01:13,874][__main__][INFO] - Instantiating loggers...
[2024-01-16 10:01:13,874][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 10:01:24,516][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 10:01:24,558][__main__][INFO] - Logging hyperparameters!
[2024-01-16 10:01:24,566][__main__][INFO] - Starting training!
[2024-01-16 10:02:01,710][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 155, in forward
    q_1_output = self.LRU_1(Convlstm_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (98304x16 and 32768x64)
[2024-01-16 10:02:01,718][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:02:01,719][utiles.utils][INFO] - Closing wandb!
[2024-01-16 10:07:20,893][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:07:20,893][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:07:20,897][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:07:20,898][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:07:20,989][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:07:21,344][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:07:21,613][__main__][INFO] - Instantiating callbacks...
[2024-01-16 10:07:21,613][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 10:07:21,616][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 10:07:21,618][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 10:07:21,619][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 10:07:21,619][__main__][INFO] - Instantiating loggers...
[2024-01-16 10:07:21,620][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 10:07:33,235][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 10:07:33,296][__main__][INFO] - Logging hyperparameters!
[2024-01-16 10:07:33,307][__main__][INFO] - Starting training!
[2024-01-16 10:08:13,294][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 148, in forward
    Convlstm_output = self.convlstm(ctx_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 214, in forward
    output = self.encoder(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 194, in forward
    inputs, state_stage = self.forward_by_stage(
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 182, in forward_by_stage
    inputs = subnet(inputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [16, 64, 3, 3], expected input[192, 16, 64, 64] to have 64 channels, but got 16 channels instead
[2024-01-16 10:08:13,327][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:08:13,327][utiles.utils][INFO] - Closing wandb!
[2024-01-16 10:16:51,506][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:16:51,506][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:16:51,509][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:16:51,509][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:16:51,576][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:16:51,768][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:16:51,783][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 639, in _locate
    obj = getattr(obj, part)
AttributeError: module 'models.my_model' has no attribute 'FusionFormer'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 645, in _locate
    obj = import_module(mod)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\importlib\__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 12, in <module>
    from models.my_model.ConvLSTM import ConvLSTM
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 146
    def convlstm_encoder_params(in_chan=7, image_size=128, seq_len):
                                                                  ^
SyntaxError: non-default argument follows default argument

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'models.my_model.FusionFormer.FusionFormer':
SyntaxError('non-default argument follows default argument', ('E:\\research\\my_code\\solar_forecasting\\EMD\\models\\my_model\\ConvLSTM.py', 146, 63, 'def convlstm_encoder_params(in_chan=7, image_size=128, seq_len):\n'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 325, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'models.my_model.FusionFormer.FusionFormer', see chained exception above.
full_key: pl_module.model
[2024-01-16 10:16:51,790][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:17:32,752][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:17:32,752][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:17:32,756][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:17:32,756][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:17:32,822][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:17:33,007][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:17:33,107][__main__][INFO] - Instantiating callbacks...
[2024-01-16 10:17:33,107][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 10:17:33,109][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 10:17:33,110][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 10:17:33,110][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 10:17:33,110][__main__][INFO] - Instantiating loggers...
[2024-01-16 10:17:33,111][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 10:17:43,769][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 10:17:43,838][__main__][INFO] - Logging hyperparameters!
[2024-01-16 10:17:43,854][__main__][INFO] - Starting training!
[2024-01-16 10:18:13,472][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 148, in forward
    Convlstm_output = self.convlstm(ctx_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 214, in forward
    output = self.encoder(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 194, in forward
    inputs, state_stage = self.forward_by_stage(
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 182, in forward_by_stage
    inputs = subnet(inputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [16, 64, 3, 3], expected input[192, 16, 64, 64] to have 64 channels, but got 16 channels instead
[2024-01-16 10:18:13,481][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:18:13,481][utiles.utils][INFO] - Closing wandb!
[2024-01-16 10:26:04,654][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:26:04,655][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:26:04,658][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:26:04,658][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:26:04,728][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:26:04,931][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:26:04,975][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 74, in __init__
    self.convlstm = ConvLSTM(in_chan=self.dim, image_size=64, seq_len=self.output_length)
TypeError: __init__() got an unexpected keyword argument 'in_chan'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 47, in train
    pl_module: LightningModule = hydra.utils.instantiate(cfg.pl_module)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 334, in instantiate_node
    value = instantiate_node(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\hydra\_internal\instantiate\_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'models.my_model.FusionFormer.FusionFormer':
TypeError("__init__() got an unexpected keyword argument 'in_chan'")
full_key: pl_module.model
[2024-01-16 10:26:04,976][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:27:06,821][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:27:06,821][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:27:06,825][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:27:06,825][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:27:06,890][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:27:07,080][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:27:07,182][__main__][INFO] - Instantiating callbacks...
[2024-01-16 10:27:07,182][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 10:27:07,184][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 10:27:07,185][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 10:27:07,185][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 10:27:07,185][__main__][INFO] - Instantiating loggers...
[2024-01-16 10:27:07,185][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 10:27:15,984][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 10:27:16,029][__main__][INFO] - Logging hyperparameters!
[2024-01-16 10:27:16,037][__main__][INFO] - Starting training!
[2024-01-16 10:27:42,531][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 148, in forward
    Convlstm_output = self.convlstm(ctx_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 214, in forward
    output = self.encoder(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 194, in forward
    inputs, state_stage = self.forward_by_stage(
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 182, in forward_by_stage
    inputs = subnet(inputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [16, 16, 3, 3], expected input[192, 64, 16, 64] to have 16 channels, but got 64 channels instead
[2024-01-16 10:27:42,539][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:27:42,539][utiles.utils][INFO] - Closing wandb!
[2024-01-16 10:29:26,694][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:29:26,694][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:29:26,698][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:29:26,698][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:29:26,765][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:29:26,958][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:29:27,057][__main__][INFO] - Instantiating callbacks...
[2024-01-16 10:29:27,057][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 10:29:27,059][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 10:29:27,061][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 10:29:27,061][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 10:29:27,061][__main__][INFO] - Instantiating loggers...
[2024-01-16 10:29:27,061][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 10:29:35,892][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 10:29:35,935][__main__][INFO] - Logging hyperparameters!
[2024-01-16 10:29:35,943][__main__][INFO] - Starting training!
[2024-01-16 10:30:06,674][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 155, in forward
    q_1_output = self.LRU_1(Convlstm_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (196608x16 and 32768x64)
[2024-01-16 10:30:06,683][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:30:06,684][utiles.utils][INFO] - Closing wandb!
[2024-01-16 10:39:49,115][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:39:49,115][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:39:49,119][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:39:49,119][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:39:49,186][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:39:49,382][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:39:49,480][__main__][INFO] - Instantiating callbacks...
[2024-01-16 10:39:49,480][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 10:39:49,482][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 10:39:49,483][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 10:39:49,484][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 10:39:49,484][__main__][INFO] - Instantiating loggers...
[2024-01-16 10:39:49,484][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 10:39:58,254][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 10:39:58,296][__main__][INFO] - Logging hyperparameters!
[2024-01-16 10:39:58,304][__main__][INFO] - Starting training!
[2024-01-16 10:40:24,542][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 145, in forward
    q_1_output = self.LRU_1(Convlstm_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 235, in forward
    x = self.fc1(x)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (196608x16 and 16384x64)
[2024-01-16 10:40:24,548][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:40:24,548][utiles.utils][INFO] - Closing wandb!
[2024-01-16 10:43:27,530][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:43:27,530][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:43:27,534][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:43:27,534][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:43:27,606][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:43:27,815][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:43:27,910][__main__][INFO] - Instantiating callbacks...
[2024-01-16 10:43:27,910][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 10:43:27,911][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 10:43:27,913][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 10:43:27,913][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 10:43:27,913][__main__][INFO] - Instantiating loggers...
[2024-01-16 10:43:27,913][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 10:43:36,595][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 10:43:36,642][__main__][INFO] - Logging hyperparameters!
[2024-01-16 10:43:36,651][__main__][INFO] - Starting training!
[2024-01-16 10:44:06,512][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 147, in forward
    print("q_1_output", q_1_output.shape)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 241, in forward
    x = self.gate_norm(x, residual)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 172, in forward
    output = self.add_norm(output, skip)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 147, in forward
    output = self.norm(x + skip)
RuntimeError: The size of tensor a (64) must match the size of tensor b (16384) at non-singleton dimension 2
[2024-01-16 10:44:06,517][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:44:06,518][utiles.utils][INFO] - Closing wandb!
[2024-01-16 10:47:24,134][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:47:24,134][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:47:24,137][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:47:24,137][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:47:24,201][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:47:24,383][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:47:24,480][__main__][INFO] - Instantiating callbacks...
[2024-01-16 10:47:24,480][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 10:47:24,482][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 10:47:24,483][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 10:47:24,483][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 10:47:24,483][__main__][INFO] - Instantiating loggers...
[2024-01-16 10:47:24,483][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 10:47:33,261][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 10:47:33,308][__main__][INFO] - Logging hyperparameters!
[2024-01-16 10:47:33,316][__main__][INFO] - Starting training!
[2024-01-16 10:48:06,209][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 146, in forward
    q_1_output = self.LRU_1(flattened_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 243, in forward
    x = self.gate_norm(x, residual)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 172, in forward
    output = self.add_norm(output, skip)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\TSselection_network.py", line 147, in forward
    output = self.norm(x + skip)
RuntimeError: The size of tensor a (64) must match the size of tensor b (16384) at non-singleton dimension 2
[2024-01-16 10:48:06,219][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:48:06,219][utiles.utils][INFO] - Closing wandb!
[2024-01-16 10:51:56,374][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:51:56,374][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:51:56,378][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:51:56,378][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:51:56,441][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:51:56,970][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:51:57,402][__main__][INFO] - Instantiating callbacks...
[2024-01-16 10:51:57,402][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 10:51:57,406][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 10:51:57,407][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 10:51:57,408][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 10:51:57,408][__main__][INFO] - Instantiating loggers...
[2024-01-16 10:51:57,408][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 10:52:06,377][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 10:52:06,416][__main__][INFO] - Logging hyperparameters!
[2024-01-16 10:52:06,425][__main__][INFO] - Starting training!
[2024-01-16 10:52:35,910][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 157, in forward
    tgt_pos_emb = self.timeseries_pos_embedding(ts_coords)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1269, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'FusionFormer' object has no attribute 'timeseries_pos_embedding'
[2024-01-16 10:52:35,917][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:52:35,918][utiles.utils][INFO] - Closing wandb!
[2024-01-16 10:55:32,356][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 10:55:32,356][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 10:55:32,360][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 10:55:32,360][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 10:55:32,427][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 10:55:32,627][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 10:55:32,720][__main__][INFO] - Instantiating callbacks...
[2024-01-16 10:55:32,720][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 10:55:32,722][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 10:55:32,723][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 10:55:32,723][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 10:55:32,723][__main__][INFO] - Instantiating loggers...
[2024-01-16 10:55:32,724][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 10:55:42,181][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 10:55:42,232][__main__][INFO] - Logging hyperparameters!
[2024-01-16 10:55:42,242][__main__][INFO] - Starting training!
[2024-01-16 10:56:15,332][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
ValueError: not enough values to unpack (expected 6, got 4)
[2024-01-16 10:56:15,335][utiles.utils][INFO] - Closing loggers...
[2024-01-16 10:56:15,335][utiles.utils][INFO] - Closing wandb!
[2024-01-16 11:05:32,458][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 11:05:32,458][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 11:05:32,461][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 11:05:32,462][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 11:05:32,530][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 11:05:32,735][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 11:05:32,822][__main__][INFO] - Instantiating callbacks...
[2024-01-16 11:05:32,822][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 11:05:32,824][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 11:05:32,825][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 11:05:32,825][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 11:05:32,825][__main__][INFO] - Instantiating loggers...
[2024-01-16 11:05:32,826][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 11:05:42,733][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 11:05:42,794][__main__][INFO] - Logging hyperparameters!
[2024-01-16 11:05:42,804][__main__][INFO] - Starting training!
[2024-01-16 11:06:15,135][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
ValueError: not enough values to unpack (expected 6, got 4)
[2024-01-16 11:06:15,138][utiles.utils][INFO] - Closing loggers...
[2024-01-16 11:06:15,138][utiles.utils][INFO] - Closing wandb!
[2024-01-16 11:08:56,063][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 11:08:56,063][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 11:08:56,067][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 11:08:56,067][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 11:08:56,140][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 11:08:56,350][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 11:08:56,443][__main__][INFO] - Instantiating callbacks...
[2024-01-16 11:08:56,443][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 11:08:56,445][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 11:08:56,446][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 11:08:56,446][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 11:08:56,446][__main__][INFO] - Instantiating loggers...
[2024-01-16 11:08:56,447][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 11:09:08,099][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 11:09:08,148][__main__][INFO] - Logging hyperparameters!
[2024-01-16 11:09:08,156][__main__][INFO] - Starting training!
[2024-01-16 11:09:35,563][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, attn, bands_weights, satellite_weights, feature_weights, attn_output_weights = self.model(
ValueError: not enough values to unpack (expected 6, got 4)
[2024-01-16 11:09:35,567][utiles.utils][INFO] - Closing loggers...
[2024-01-16 11:09:35,567][utiles.utils][INFO] - Closing wandb!
[2024-01-16 11:12:27,676][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 11:12:27,677][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 11:12:27,680][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 11:12:27,680][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 11:12:27,751][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 11:12:27,944][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 11:12:28,029][__main__][INFO] - Instantiating callbacks...
[2024-01-16 11:12:28,030][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 11:12:28,032][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 11:12:28,032][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 11:12:28,033][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 11:12:28,033][__main__][INFO] - Instantiating loggers...
[2024-01-16 11:12:28,033][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 11:12:37,502][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 11:12:37,572][__main__][INFO] - Logging hyperparameters!
[2024-01-16 11:12:37,587][__main__][INFO] - Starting training!
[2024-01-16 11:13:24,862][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 11:13:24,862][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 11:13:24,867][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 11:13:24,867][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 11:13:24,942][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 11:13:25,173][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 11:13:25,261][__main__][INFO] - Instantiating callbacks...
[2024-01-16 11:13:25,261][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 11:13:25,263][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 11:13:25,264][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 11:13:25,265][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 11:13:25,265][__main__][INFO] - Instantiating loggers...
[2024-01-16 11:13:25,265][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 11:13:35,819][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 11:13:35,926][__main__][INFO] - Logging hyperparameters!
[2024-01-16 11:13:35,943][__main__][INFO] - Starting training!
[2024-01-16 12:11:07,485][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=001-v5.ckpt
[2024-01-16 12:11:07,486][__main__][INFO] - Starting testing!
[2024-01-16 12:14:30,158][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 12:14:30,159][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 12:14:30,162][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 12:14:30,162][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 12:14:30,237][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 12:14:30,522][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 12:14:30,631][__main__][INFO] - Instantiating callbacks...
[2024-01-16 12:14:30,632][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 12:14:30,633][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 12:14:30,635][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 12:14:30,635][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 12:14:30,636][__main__][INFO] - Instantiating loggers...
[2024-01-16 12:14:30,636][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 12:14:42,995][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 12:14:43,062][__main__][INFO] - Logging hyperparameters!
[2024-01-16 12:14:43,074][__main__][INFO] - Starting training!
[2024-01-16 12:16:47,236][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 12:16:47,236][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 12:16:47,240][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 12:16:47,240][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 12:16:47,322][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 12:16:47,695][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 12:16:47,867][__main__][INFO] - Instantiating callbacks...
[2024-01-16 12:16:47,867][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 12:16:47,871][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 12:16:47,873][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 12:16:47,873][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 12:16:47,873][__main__][INFO] - Instantiating loggers...
[2024-01-16 12:16:47,875][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 12:16:52,189][utiles.utils][INFO] - Closing loggers...
[2024-01-16 12:29:38,420][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 12:29:38,421][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 12:29:38,426][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 12:29:38,426][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 12:29:38,507][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 12:29:38,781][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 12:29:38,890][__main__][INFO] - Instantiating callbacks...
[2024-01-16 12:29:38,890][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 12:29:38,892][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 12:29:38,893][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 12:29:38,893][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 12:29:38,893][__main__][INFO] - Instantiating loggers...
[2024-01-16 12:29:38,895][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 12:29:49,496][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 12:29:49,541][__main__][INFO] - Logging hyperparameters!
[2024-01-16 12:29:49,550][__main__][INFO] - Starting training!
[2024-01-16 12:31:09,929][__main__][INFO] - Best model ckpt at 
[2024-01-16 12:31:09,930][__main__][INFO] - Starting testing!
[2024-01-16 12:31:09,930][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-16 12:35:58,487][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 12:35:58,487][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 12:35:58,491][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 12:35:58,492][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 12:35:58,561][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 12:35:58,857][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 12:35:58,956][__main__][INFO] - Instantiating callbacks...
[2024-01-16 12:35:58,956][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 12:35:58,958][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 12:35:58,959][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 12:35:58,959][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 12:35:58,960][__main__][INFO] - Instantiating loggers...
[2024-01-16 12:35:58,960][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 12:36:09,493][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 12:36:09,554][__main__][INFO] - Logging hyperparameters!
[2024-01-16 12:36:09,562][__main__][INFO] - Starting training!
[2024-01-16 12:37:48,993][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 12:37:48,993][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 12:37:48,997][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 12:37:48,997][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 12:37:49,073][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 12:37:49,427][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 12:37:49,542][__main__][INFO] - Instantiating callbacks...
[2024-01-16 12:37:49,543][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 12:37:49,545][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 12:37:49,546][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 12:37:49,546][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 12:37:49,546][__main__][INFO] - Instantiating loggers...
[2024-01-16 12:37:49,546][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 12:37:59,356][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 12:37:59,404][__main__][INFO] - Logging hyperparameters!
[2024-01-16 12:37:59,413][__main__][INFO] - Starting training!
[2024-01-16 12:40:06,992][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 12:40:06,992][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 12:40:06,995][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 12:40:06,996][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 12:40:07,069][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 12:40:07,307][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 12:40:07,413][__main__][INFO] - Instantiating callbacks...
[2024-01-16 12:40:07,414][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 12:40:07,415][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 12:40:07,417][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 12:40:07,417][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 12:40:07,418][__main__][INFO] - Instantiating loggers...
[2024-01-16 12:40:07,418][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 12:40:18,043][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 12:40:18,095][__main__][INFO] - Logging hyperparameters!
[2024-01-16 12:40:18,105][__main__][INFO] - Starting training!
[2024-01-16 12:41:54,320][__main__][INFO] - Best model ckpt at 
[2024-01-16 12:41:54,321][__main__][INFO] - Starting testing!
[2024-01-16 12:41:54,322][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-16 12:42:13,364][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 12:42:13,364][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 12:42:13,368][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 12:42:13,368][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 12:42:13,447][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 12:42:13,789][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 12:42:13,891][__main__][INFO] - Instantiating callbacks...
[2024-01-16 12:42:13,891][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 12:42:13,893][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 12:42:13,894][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 12:42:13,894][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 12:42:13,895][__main__][INFO] - Instantiating loggers...
[2024-01-16 12:42:13,895][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 12:42:24,739][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 12:42:24,796][__main__][INFO] - Logging hyperparameters!
[2024-01-16 12:42:24,808][__main__][INFO] - Starting training!
[2024-01-16 12:43:01,659][utiles.utils][ERROR] - 
Traceback (most recent call last):
  File "E:\research\my_code\solar_forecasting\EMD\utiles\utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "E:\research\my_code\solar_forecasting\EMD\main.py", line 82, in train
    trainer.fit(model=pl_module, datamodule=datamodule, ckpt_path=ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 603, in fit
    call._call_and_handle_interrupt(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 645, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1098, in _run
    results = self._run_stage()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1177, in _run_stage
    self._run_train()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1190, in _run_train
    self._run_sanity_check()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1262, in _run_sanity_check
    val_loop.run()
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\dataloader\evaluation_loop.py", line 152, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\loop.py", line 199, in run
    self.advance(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 137, in advance
    output = self._evaluation_step(**kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\loops\epoch\evaluation_epoch_loop.py", line 234, in _evaluation_step
    output = self.trainer._call_strategy_hook(hook_name, *kwargs.values())
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\trainer\trainer.py", line 1480, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\pytorch_lightning\strategies\strategy.py", line 390, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 76, in validation_step
    y_hat, bands_weights, feature_weights, attn_output_weights = self(x_ctx, ctx_coords, x_ts, ts_coords, time_coords, mask=False)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\pl_models\FusionFormer.py", line 25, in forward
    out, bands_weights, feature_weights, attn_output_weights = self.model(
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\FusionFormer.py", line 124, in forward
    Convlstm_output = self.convlstm(ctx_output)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 154, in forward
    output = self.encoder(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 142, in forward
    inputs, state_stage = self.forward_by_stage(
  File "E:\research\my_code\solar_forecasting\EMD\models\my_model\ConvLSTM.py", line 131, in forward_by_stage
    inputs = subnet(inputs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\container.py", line 204, in forward
    input = module(input)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "E:\application\anaconda\envs\pytorch_lightning\lib\site-packages\torch\nn\modules\conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [16, 19, 3, 3], expected input[192, 16, 64, 64] to have 19 channels, but got 16 channels instead
[2024-01-16 12:43:01,666][utiles.utils][INFO] - Closing loggers...
[2024-01-16 12:43:01,667][utiles.utils][INFO] - Closing wandb!
[2024-01-16 12:43:38,508][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 12:43:38,509][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 12:43:38,513][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 12:43:38,513][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 12:43:38,591][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 12:43:38,929][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 12:43:39,038][__main__][INFO] - Instantiating callbacks...
[2024-01-16 12:43:39,039][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 12:43:39,041][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 12:43:39,042][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 12:43:39,043][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 12:43:39,043][__main__][INFO] - Instantiating loggers...
[2024-01-16 12:43:39,043][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 12:43:49,478][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 12:43:49,533][__main__][INFO] - Logging hyperparameters!
[2024-01-16 12:43:49,545][__main__][INFO] - Starting training!
[2024-01-16 13:29:46,242][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 13:29:46,242][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 13:29:46,246][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 13:29:46,246][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 13:29:46,361][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 13:29:46,574][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 13:29:46,685][__main__][INFO] - Instantiating callbacks...
[2024-01-16 13:29:46,685][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 13:29:46,686][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 13:29:46,687][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 13:29:46,688][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 13:29:46,688][__main__][INFO] - Instantiating loggers...
[2024-01-16 13:29:46,689][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 13:30:05,220][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 13:30:05,279][__main__][INFO] - Logging hyperparameters!
[2024-01-16 13:30:05,289][__main__][INFO] - Starting training!
[2024-01-16 13:31:33,995][__main__][INFO] - Best model ckpt at 
[2024-01-16 13:31:33,996][__main__][INFO] - Starting testing!
[2024-01-16 13:31:33,997][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2024-01-16 13:31:50,836][utiles.utils][INFO] - Disabling python warnings! <cfg.extras.ignore_warnings=True>
[2024-01-16 13:31:50,836][utiles.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-01-16 13:31:50,839][utiles.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-01-16 13:31:50,839][utiles.rich_utils][WARNING] - Field 'model' not found in config. Skipping 'model' config printing...
[2024-01-16 13:31:50,904][__main__][INFO] - Instantiating datamodule <data_provider.satellite_ts_module.TSContextDataModule>
[2024-01-16 13:31:51,097][__main__][INFO] - Instantiating model <pl_models.FusionFormer.FusionFormer>
[2024-01-16 13:31:51,196][__main__][INFO] - Instantiating callbacks...
[2024-01-16 13:31:51,197][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2024-01-16 13:31:51,199][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2024-01-16 13:31:51,200][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2024-01-16 13:31:51,200][utiles.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2024-01-16 13:31:51,200][__main__][INFO] - Instantiating loggers...
[2024-01-16 13:31:51,200][utiles.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2024-01-16 13:32:01,787][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2024-01-16 13:32:01,835][__main__][INFO] - Logging hyperparameters!
[2024-01-16 13:32:01,845][__main__][INFO] - Starting training!
[2024-01-16 14:48:50,480][__main__][INFO] - Best model ckpt at E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=002-v3.ckpt
[2024-01-16 14:48:50,481][__main__][INFO] - Starting testing!
[2024-01-16 15:51:09,582][__main__][INFO] - Best ckpt path: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty/checkpoints\epoch_epoch=002-v3.ckpt
[2024-01-16 15:51:09,608][utiles.utils][INFO] - Closing loggers...
[2024-01-16 15:51:09,608][utiles.utils][INFO] - Closing wandb!
[2024-01-16 15:51:16,698][utiles.utils][INFO] - Output dir: E:\research\my_code\solar_forecasting\EMD\LOGS\train\runs\joty
[2024-01-16 15:51:16,702][utiles.utils][INFO] - Metric name is None! Skipping metric value retrieval...
